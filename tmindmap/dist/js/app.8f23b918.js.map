{"version":3,"file":"js/app.8f23b918.js","mappings":"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","sources":["webpack://tmindmap/./src/App.vue","webpack://tmindmap/./src/components/Header.vue","webpack://tmindmap/./src/authState.js","webpack://tmindmap/./src/firebase.js","webpack://tmindmap/./src/components/Header.vue?801b","webpack://tmindmap/./src/components/Footer.vue","webpack://tmindmap/./src/components/Footer.vue?7cca","webpack://tmindmap/./src/App.vue?7ccd","webpack://tmindmap/./src/views/Home.vue","webpack://tmindmap/./src/views/Home.vue?9051","webpack://tmindmap/./src/views/listmm.vue","webpack://tmindmap/./src/views/listmm.vue?2822","webpack://tmindmap/./src/views/createmm.vue","webpack://tmindmap/./src/views/createmm.vue?9c2f","webpack://tmindmap/./src/views/createmmAI.vue","webpack://tmindmap/./src/views/createmmAI.vue?1ef4","webpack://tmindmap/./src/views/signin.vue","webpack://tmindmap/./src/views/signin.vue?c5ba","webpack://tmindmap/./src/views/signup.vue","webpack://tmindmap/./src/views/signup.vue?688f","webpack://tmindmap/./router.js","webpack://tmindmap/./src/main.js","webpack://tmindmap/webpack/bootstrap","webpack://tmindmap/webpack/runtime/chunk loaded","webpack://tmindmap/webpack/runtime/compat get default export","webpack://tmindmap/webpack/runtime/define property getters","webpack://tmindmap/webpack/runtime/global","webpack://tmindmap/webpack/runtime/hasOwnProperty shorthand","webpack://tmindmap/webpack/runtime/publicPath","webpack://tmindmap/webpack/runtime/jsonp chunk loading","webpack://tmindmap/webpack/startup"],"sourcesContent":["\r\n<template>\r\n  <div id=\"app\">\r\n    <AppHeader />\r\n    <main>\r\n      <router-view />\r\n    </main>\r\n    <AppFooter />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport AppHeader from './components/Header.vue';\r\nimport AppFooter from './components/Footer.vue';\r\nexport default{\r\n  name:\"App\",\r\n  components: {\r\n    AppHeader,\r\n    AppFooter\r\n  }\r\n}\r\n</script>\r\n","<template>\r\n  <header>\r\n    <div class=\"nav\">\r\n      <div class=\"logo\">\r\n        <router-link to=\"/\"><img src=\"../assets/img/TMIND.png\" alt=\"logo\" /></router-link>\r\n      </div>\r\n      <div class=\"list\" id=\"navList\">\r\n        <div class=\"list_mm\">\r\n          <a href=\"#\" @click.prevent=\"goToListMindMap\">LIST MINDMAP</a>\r\n        </div>\r\n        <div class=\"about\">\r\n          <router-link to=\"/#about\">ABOUT</router-link>\r\n        </div>\r\n        <div class=\"feedback\">\r\n          <a href=\"#\" @click.prevent=\"openModal\">FEEDBACK</a>\r\n        </div>\r\n        <!-- Nếu chưa đăng nhập -->\r\n        <div class=\"signin\" v-if=\"!isLoggedIn\">\r\n          <router-link to=\"/signin\">SIGN IN</router-link>\r\n        </div>\r\n        <div class=\"signup\" v-if=\"!isLoggedIn\">\r\n          <router-link to=\"/signup\">SIGN UP</router-link>\r\n        </div>\r\n        <!-- Nếu đã đăng nhập: hiển thị thông tin user -->\r\n        <div class=\"user-info\" v-if=\"isLoggedIn\" @click=\"toggleUserMenu\">\r\n          <img :src=\"userIcon\" alt=\"User Icon\" class=\"user-icon\" />\r\n          <span class=\"user-name\">{{ userName }}</span>\r\n        </div>\r\n        <!-- Dropdown menu hiển thị khi bấm vào user-info -->\r\n        <div class=\"user-menu\" v-if=\"showUserMenu\">\r\n          <button @click=\"openAccountModal\">Thông tin tài khoản</button>\r\n          <button @click=\"logout\">Đăng xuất</button>\r\n        </div>\r\n      </div>\r\n      <button class=\"menu\" @click=\"openMenu\">\r\n        <i class=\"fa-solid fa-bars\"></i>\r\n      </button>\r\n      <button class=\"close_menu\" @click=\"closeMenu\">\r\n        <i class=\"fa-solid fa-xmark\"></i>\r\n      </button>\r\n    </div>\r\n  </header>\r\n\r\n  <!-- Các modal nếu có (Feedback, Account) -->\r\n  <div class=\"modal-overlay\" id=\"feedbackModal\">\r\n    <!-- Nội dung modal Feedback -->\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2>Gửi Phản Hồi</h2>\r\n        <span class=\"close-button\" @click=\"closeModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <form @submit.prevent=\"Feedback\">\r\n          <div class=\"form-group\">\r\n            <label for=\"description\">Mô Tả</label>\r\n            <textarea id=\"description\" v-model=\"feedbackDescription\" name=\"description\" placeholder=\"Mô tả chi tiết vấn đề ở đây\"></textarea>\r\n          </div>\r\n          <div class=\"form-group checkbox-group\">\r\n            <input type=\"checkbox\" id=\"include-ai-session\" v-model=\"includeAiSession\" name=\"include-ai-session\" checked />\r\n            <label for=\"include-ai-session\">Bao gồm phiên làm việc ứng dụng cuối cùng trong phản hồi.</label>\r\n          </div>\r\n          <button type=\"submit\" class=\"submit-button\" @click=\"sendFeedback\">Gửi đi</button>\r\n        </form>\r\n        <p class=\"footer-text\">\r\n          Để có câu trả lời nhanh chóng, hãy liên hệ với chúng tôi qua\r\n          <a href=\"mailto:dtc21h4802010284@ictu.edu.vn\">dtc21h4802010284@ictu.edu.vn</a>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"modal-overlay\" v-if=\"isAccountModalOpen\" style=\"display: flex !important; z-index: 9999;\">\r\n    <!-- Nội dung modal Account Info -->\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2>THÔNG TIN TÀI KHOẢN</h2>\r\n        <span class=\"close-button\" @click=\"closeAccountModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <form @submit.prevent=\"saveAccountInfo\">\r\n          <div class=\"form-group infor\">\r\n            <label for=\"accountName\">Tên:</label>\r\n            <input type=\"text\" id=\"accountName\" v-model=\"account.name\" placeholder=\"Nhập tên\" />\r\n          </div>\r\n          <div class=\"form-group infor\">\r\n            <label for=\"accountEmail\">Email:</label>\r\n            <input type=\"email\" id=\"accountEmail\" v-model=\"account.email\" placeholder=\"Nhập email\" disabled />\r\n          </div>\r\n          <div class=\"form-group infor\">\r\n            <label for=\"accountPhone\">Số điện thoại:</label>\r\n            <input type=\"text\" id=\"accountPhone\" v-model=\"account.phone\" placeholder=\"Nhập số điện thoại\" />\r\n          </div>\r\n          <button type=\"submit\" class=\"submit-button\">Lưu thông tin</button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { authState } from '@/authState';\r\nimport { signOut } from 'firebase/auth';\r\nimport { auth } from '@/firebase' ;\r\nexport default {\r\n  name: \"AppHeader\",\r\n  computed: {\r\n    isLoggedIn() {\r\n      return !!authState.token;\r\n    },\r\n    userName() {\r\n      return authState.userName || \"User\";\r\n    },\r\n    userIcon() {\r\n      return authState.userIcon || require('../assets/img/user-login.jpg');\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      showUserMenu: false,\r\n      isAccountModalOpen: false,\r\n      account: {\r\n        name: '',\r\n        email: '',\r\n        phone: ''\r\n      },\r\n      feedbackDescription: '',\r\n      includeAiSession: true\r\n    }\r\n  },\r\n  methods: {\r\n    goToListMindMap() {\r\n      if (!this.isLoggedIn) {\r\n        this.$router.push('/signin');\r\n      } else {\r\n        this.$router.push('/listmm');\r\n      }\r\n    },\r\n    openModal() {\r\n      if (!this.isLoggedIn) {\r\n        this.$router.push('/signin');\r\n      } else {\r\n        document.getElementById('feedbackModal').style.display = 'flex';\r\n      }\r\n    },\r\n    closeModal() {\r\n      document.getElementById('feedbackModal').style.display = 'none';\r\n    },\r\n    Feedback() {\r\n      if (!this.isLoggedIn) {\r\n        this.$router.push('/signin');\r\n      } else {\r\n        console.log(\"Feedback gửi:\", this.feedbackDescription, this.includeAiSession);\r\n        this.closeModal();\r\n      }\r\n    },\r\n    toggleUserMenu() {\r\n      this.showUserMenu = !this.showUserMenu;\r\n    },\r\n    async openAccountModal() {\r\n  try {\r\n    // 1) Lấy token từ localStorage\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      throw new Error('Chưa có token, vui lòng đăng nhập lại');\r\n    }\r\n    console.log('Using token:', token);\r\n\r\n    // 2) Gọi API /profile với header Bearer\r\n    const res = await fetch('/profile', {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`,\r\n        'Accept': 'application/json'\r\n      }\r\n      // → bỏ credentials hoàn toàn\r\n    });\r\n\r\n    // 3) Check status\r\n    if (res.status === 401) {\r\n      // nếu token hết hạn hoặc invalid\r\n      this.$router.push('/signin');\r\n      return;\r\n    }\r\n    if (!res.ok) {\r\n      throw new Error(`Unexpected status ${res.status}`);\r\n    }\r\n\r\n    // 4) Parse và set data\r\n    const data = await res.json();\r\n    const user = data.user ?? data;\r\n    this.account = {\r\n      name: user.name,\r\n      email: user.email,\r\n      phone: user.phone\r\n    };\r\n    this.isAccountModalOpen = true;\r\n\r\n  } catch (err) {\r\n    console.error('Failed to open account modal:', err);\r\n  }\r\n},\r\n    closeAccountModal() {\r\n      this.isAccountModalOpen = false;\r\n    },\r\n    async saveAccountInfo() {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const res = await fetch('/profile', {\r\n          method: 'PUT',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Bearer ${token}`\r\n          },\r\n          body: JSON.stringify({\r\n            name: this.account.name,\r\n            phone: this.account.phone\r\n          })\r\n        });\r\n\r\n        if (!res.ok) {\r\n          const err = await res.json();\r\n          throw new Error(err.message || `Error ${res.status}`);\r\n        }\r\n\r\n        const { user } = await res.json();\r\n        // Đồng bộ lại dữ liệu hiển thị nếu cần\r\n        this.account.name = user.name;\r\n        this.account.phone = user.phone;\r\n\r\n        this.isAccountModalOpen = false;\r\n        alert('Cập nhật thành công!')\r\n\r\n      } catch (err) {\r\n        console.error('Save profile failed:', err);\r\n      }\r\n    },\r\n    async logout() {\r\n    try {\r\n      // 1. Sign out khỏi Firebase\r\n      await signOut(auth);\r\n      authState.token = null;\r\n      authState.userName = \"\";\r\n      authState.userIcon = \"\";\r\n      localStorage.removeItem(\"token\");\r\n      localStorage.removeItem(\"userName\");\r\n      localStorage.removeItem(\"userIcon\");\r\n      // 4. Redirect\r\n      this.$router.push('/signin');\r\n      this.showUserMenu = false;\r\n    } catch (err) {\r\n      console.error('Logout lỗi:', err);\r\n    }\r\n  },\r\n    openMenu() {\r\n      if (window.innerWidth <= 768) {\r\n        document.querySelector('.list').style.display = 'block';\r\n        document.querySelector('.close_menu').style.display = 'block';\r\n        document.querySelector('.menu').style.display = 'none';\r\n      }\r\n    },\r\n    closeMenu() {\r\n      if (window.innerWidth <= 768) {\r\n        document.querySelector('.list').style.display = 'none';\r\n        document.querySelector('.close_menu').style.display = 'none';\r\n        document.querySelector('.menu').style.display = 'block';\r\n      }\r\n    },\r\n    sendFeedback() {\r\n  const payload = {\r\n    name: localStorage.getItem('userName') || \"Anonymous\",\r\n    email: localStorage.getItem('userEmail') || \"unknown@example.com\",\r\n    content: this.feedbackDescription\r\n  };\r\n\r\n  fetch('/feedback', {\r\n    method: 'POST',\r\n    headers: { // <-- sửa ở đây: 'headers' thay vì 'header'\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify(payload)\r\n  })\r\n    .then(res => {\r\n      if (!res.ok) {\r\n        throw new Error(\"Server response was not OK\");\r\n      }\r\n      alert('Đã gửi phản hồi thành công')\r\n      return res.json();\r\n    })\r\n    .then(data => {\r\n      console.log(\"Feedback gửi:\", data);\r\n      this.successMessage = data.message;\r\n      setTimeout(() => this.closeModal(), 2000);\r\n    })\r\n    .catch(err => {\r\n      console.error(\"Lỗi khi gửi feedback:\", err);\r\n      this.errorMessage = \"Lỗi khi gửi phản hồi!\";\r\n    });\r\n}\r\n  },\r\n  mounted() {\r\n    window.addEventListener('resize', () => {\r\n      const navList = document.querySelector('.list');\r\n      if (window.innerWidth > 768) {\r\n        navList.style.display = 'flex';\r\n        document.querySelector('.menu').style.display = 'none';\r\n      } else {\r\n        navList.style.display = 'none';\r\n        document.querySelector('.menu').style.display = 'block';\r\n      }\r\n    });\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n\r\n\r\n<style scoped>\r\n* {\r\n  box-sizing: border-box;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\nheader {\r\n  height: 90px;\r\n  width: 100%;\r\n  background: radial-gradient(rgb(173, 252, 252),white);\r\n}\r\n.nav {\r\n  margin-left: 30px;\r\n  border-radius: 10px;\r\n  display: flex;\r\n  padding: 20px;\r\n  width: 100%;\r\n  background-color: rgba(255,255,255,0.05);\r\n  height: 100px;\r\n  z-index: 1;\r\n}\r\n.list {\r\n  display: flex;\r\n  width: 60%;\r\n}\r\n.list a {\r\n  text-decoration: none;\r\n  display: block;\r\n  margin-right: 40px;\r\n  color: black;\r\n  margin-top: 10px;\r\n  font-weight: bolder;\r\n  padding: 10px;\r\n}\r\n.list a:hover {\r\n  background-color: #000;\r\n  color: #fff;\r\n  border-radius: 10px;\r\n}\r\n.signup a {\r\n  background-color: #000;\r\n  color: #fff;\r\n  border-radius: 10px;\r\n}\r\n.logo {\r\n  width: 45%;\r\n  margin-left: 40px;\r\n}\r\n.logo img {\r\n  height: 50px;\r\n}\r\n.menu, .close_menu {\r\n  display: none;\r\n  padding: 5px;\r\n  background-color: #fff;\r\n  border: none;\r\n  font-size: 25px;\r\n  margin-left: 50%;\r\n}\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.4);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  display: none; /* Ẩn modal mặc định */\r\n  z-index: 1;\r\n}\r\n.modal-content {\r\n  background: #fff;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  width: 400px;\r\n  position: relative;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\r\n  display: block;\r\n}\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n  padding-left: 60px;\r\n}\r\n.modal-header h2 {\r\n  font-size: 18px;\r\n  font-weight: bolder;\r\n}\r\n.close-button {\r\n  cursor: pointer;\r\n  font-size: 20px;\r\n  font-weight: bolder;\r\n}\r\n.form-group {\r\n  margin-bottom: 16px;\r\n}\r\n.infor{\r\n  display:flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n.infor input{\r\n  width: 250px;\r\n}\r\n.form-group label {\r\n  display: block;\r\n  font-weight: 600;\r\n  margin-bottom: 6px;\r\n}\r\n.form-group select,\r\n.form-group textarea {\r\n  width: 100%;\r\n  border: 1px solid #ccc;\r\n  border-radius: 6px;\r\n  padding: 8px;\r\n  font-size: 14px;\r\n}\r\n.form-group textarea {\r\n  height: 80px;\r\n  resize: vertical;\r\n}\r\n.checkbox-group {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.checkbox-group input[type=\"checkbox\"] {\r\n  margin-right: 6px;\r\n  transform: scale(1.2);\r\n}\r\n.submit-button {\r\n  width: 100%;\r\n  background: linear-gradient(to right, #6366F1, #7C3AED);\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 6px;\r\n  padding: 12px 16px;\r\n  cursor: pointer;\r\n  font-size: 16px;\r\n  margin-bottom: 10px;\r\n}\r\n.submit-button:hover {\r\n  opacity: 0.9;\r\n}\r\n.footer-text {\r\n  font-size: 14px;\r\n  color: #666;\r\n  line-height: 1.4;\r\n}\r\n.footer-text a {\r\n  color: #6366F1;\r\n  text-decoration: none;\r\n}\r\n.footer-text a:hover {\r\n  text-decoration: underline;\r\n}\r\n.user-info {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 5px;\r\n  cursor: pointer;\r\n}\r\n.user-info .user-icon {\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  margin-right: 8px;\r\n}\r\n.user-info .user-name {\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n.user-menu {\r\n  position: absolute;\r\n  top: 80px;\r\n  right: 100px;\r\n  background: #fff;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);\r\n  z-index: 2;\r\n}\r\n.user-menu button {\r\n  display: block;\r\n  width: 100%;\r\n  border: none;\r\n  border-bottom: 1px solid #666;\r\n  background: none;\r\n  padding: 10px;\r\n  text-align: left;\r\n  cursor: pointer;\r\n}\r\n.user-menu button:hover {\r\n  background-color: #f0f0f0;\r\n}\r\n@media screen and (max-width: 768px) {\r\n  .signin_form {\r\n    width: 90%;\r\n    margin: 0 auto;\r\n  }\r\n  .list {\r\n    display: none;\r\n    flex-direction: column;\r\n    position: absolute;\r\n    top: 100px;\r\n    left: 0;\r\n    right: 0;\r\n    width: 100%;\r\n    margin-left: 0;\r\n    background-color: white;\r\n    border: 1px solid #000;\r\n    border-bottom-left-radius: 10px;\r\n    border-bottom-right-radius: 10px;\r\n    border-top: 1px solid #fff;\r\n    box-shadow: 10px 10px #ddd;\r\n  }\r\n  .list a {\r\n    display: block;\r\n    margin-left: 50px;\r\n    margin-bottom: 20px;\r\n    text-align: center;\r\n  }\r\n  .nav .logo {\r\n    margin: 0;\r\n  }\r\n  .nav {\r\n    max-width: 95%;\r\n    margin-top: 5px;\r\n    margin-left: 5px;\r\n  }\r\n  .menu {\r\n    display: block;\r\n    padding: 5px;\r\n    background-color: #fff;\r\n    border: none;\r\n    margin-left: 50%;\r\n    font-size: 25px;\r\n  }\r\n  .close_menu {\r\n    display: none;\r\n    padding: 5px;\r\n    background-color: #fff;\r\n    border: none;\r\n    font-size: 25px;\r\n    margin-left: 50%;\r\n  }\r\n  .modal-overlay {\r\n    width: 100%;\r\n  }\r\n  .modal-content {\r\n    width: 90%;\r\n  }\r\n}\r\n</style>\r\n","// src/composables/authState.js\r\nimport { reactive } from 'vue';\r\n\r\nexport const authState = reactive({\r\n    token: localStorage.getItem('token') || '',\r\n    userName: localStorage.getItem('userName') || '',\r\n    userIcon: localStorage.getItem('userIcon') || ''\r\n});\r\n","// src/firebase.js\r\nimport { initializeApp } from \"firebase/app\";\r\nimport { getAuth, GoogleAuthProvider, FacebookAuthProvider, signInWithPopup } from \"firebase/auth\";\r\n\r\nconst firebaseConfig = {\r\n    apiKey: \"AIzaSyCATjuZ6o54hp-P84lnS6n_o9dGyFH1_8g\",\r\n    authDomain: \"mindmap-ad6dd.firebaseapp.com\",\r\n    projectId: \"mindmap-ad6dd\",\r\n    storageBucket: \"mindmap-ad6dd.firebasestorage.app\",\r\n    messagingSenderId: \"882676772255\",\r\n    appId: \"1:882676772255:web:dcb692696274d65ab261aa\",\r\n    measurementId: \"G-N7T0R2DJ2S\"\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nconst auth = getAuth(app);\r\nconst googleProvider = new GoogleAuthProvider();\r\nconst facebookProvider = new FacebookAuthProvider();\r\n\r\nexport { auth, googleProvider, facebookProvider, signInWithPopup };\r\n","import { render } from \"./Header.vue?vue&type=template&id=f727c448&scoped=true\"\nimport script from \"./Header.vue?vue&type=script&lang=js\"\nexport * from \"./Header.vue?vue&type=script&lang=js\"\n\nimport \"./Header.vue?vue&type=style&index=0&id=f727c448&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-f727c448\"]])\n\nexport default __exports__","<template>\r\n    <footer>\r\n        <div class=\"footer_bottom\">© 2025 Copyright of TMIND MAP</div>\r\n    </footer>\r\n</template>\r\n<script>\r\n    export default {\r\n        name: \"AppFooter\"\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n.footer_bottom {\r\n    width: 100%;\r\n    text-align: center;\r\n    background-color: #ddd;\r\n}\r\n@media screen and (max-width:768px){\r\n    footer {\r\n        width: 100%;\r\n    }\r\n}\r\n</style>","import { render } from \"./Footer.vue?vue&type=template&id=3dcc20c8&scoped=true\"\nimport script from \"./Footer.vue?vue&type=script&lang=js\"\nexport * from \"./Footer.vue?vue&type=script&lang=js\"\n\nimport \"./Footer.vue?vue&type=style&index=0&id=3dcc20c8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3dcc20c8\"]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=35d9ca4e\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n    <div class=\"container\">\r\n        <div class=\"body\">\r\n        <p>\r\n            Tạo và xuất\r\n            <span id=\"word1\" class=\"word\">hình ảnh</span>\r\n            <span id=\"word2\" class=\"word\" style=\"display: none;\">PowerPoint</span>\r\n            sơ đồ tư duy chỉ với một cú nhấp bằng AI <br>\r\n            Thể hiện trí thông minh và khả năng sáng tạo với cách tự tạo sơ đồ tư duy\r\n        </p>\r\n        <button class=\"btn_design_mm\">\r\n            <router-link to=\"/createMM\">Tạo sơ đồ tư duy</router-link>\r\n        </button>\r\n        <button class=\"btn_design_mm_ai\">\r\n            <router-link to=\"/createMMAI\">Tạo sơ đồ tư duy AI</router-link>\r\n        </button>\r\n    </div>\r\n\r\n    <div id=\"about\">\r\n        <img src=\"../assets/img/tmind.gif\" alt=\"mindmap\">\r\n        <p>\r\n            - Với <b>TMINDMAP</b>, nơi biến những ý tưởng, chủ đề của bạn thành sơ đồ tư duy nhanh chóng với AI.\r\n            Nếu AI tạo mà còn thiếu sót hoặc chưa hoàn chỉnh lắm, người dùng có thể chỉnh sửa để hoàn chỉnh nhất. <br>\r\n            - <b>TMINDMAP</b> còn giúp bạn thể hiện sự sáng tạo đỉnh cao của mình với một cái đầu thông minh để tạo\r\n            nên những sơ đồ tư duy hoàn hảo. <br>\r\n            - Hỗ trợ xuất ra hình ảnh hoặc PowerPoint để giúp việc thuyết trình dễ dàng hơn. <br>\r\n            - Hy vọng <b>TMINDMAP</b> sẽ là người bạn đồng hành cho bài thuyết trình, báo cáo, bài giảng,... <br>\r\n            - Đối tượng chính của <b>TMINDMAP</b> là giáo viên, học sinh và sinh viên. <br>\r\n            - Nếu có bất kỳ góp ý, đánh giá nào, hãy gửi phản hồi cho chúng tôi qua trang feedback. <br>\r\n            - Cảm ơn mọi người đã tin tưởng và sử dụng!\r\n        </p>\r\n    </div>\r\n\r\n    <footer>\r\n        <div class=\"footer_top\">\r\n            <div class=\"footer_top-left\">\r\n                <img src=\"../assets/img/TMIND.png\" alt=\"TMINDMAP\">\r\n                <p>\r\n                    Tự thiết kế với sáng tạo của chính mình hoặc <br> nhờ AI biến thành sơ đồ tư duy chỉ trong vài phút.\r\n                </p>\r\n            </div>\r\n            <div class=\"footer_top-right\">\r\n                <h1>TÍNH NĂNG</h1>\r\n                <ul>\r\n                    <li>Quản lý và tìm kiếm sơ đồ tư duy đã tạo</li>\r\n                    <li>Tự thiết kế sơ đồ tư duy</li>\r\n                    <li>Thiết kế sơ đồ tư duy bằng AI</li>\r\n                    <li>Xuất sơ đồ tư duy bằng hình ảnh hoặc PowerPoint</li>\r\n                    <li>Chọn template cho sơ đồ tư duy</li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </footer>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: \"HomeMindMap\",\r\n    mounted() {\r\n        this.startWordAnimation();\r\n    },\r\n    methods: {\r\n        startWordAnimation() {\r\n            let isFirst = true;\r\n            setInterval(() => {\r\n                const word1 = document.getElementById(\"word1\");\r\n                const word2 = document.getElementById(\"word2\");\r\n\r\n                if (word1 && word2) {\r\n                    if (isFirst) {\r\n                        word1.style.display = \"none\";\r\n                        word2.style.display = \"inline-block\";\r\n                        word2.classList.remove(\"word\");\r\n                        void word2.offsetWidth; // trigger reflow\r\n                        word2.classList.add(\"word\");\r\n                    } else {\r\n                        word2.style.display = \"none\";\r\n                        word1.style.display = \"inline-block\";\r\n                        word1.classList.remove(\"word\");\r\n                        void word1.offsetWidth;\r\n                        word1.classList.add(\"word\");\r\n                    }\r\n                    isFirst = !isFirst;\r\n                }\r\n            }, 3000);\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&display=swap');\r\n/* body */\r\n.body p {\r\n    font-family: \"Dancing Script\", cursive;\r\n    font-size: 30px;\r\n    margin-bottom: 50px;\r\n    text-align: center;\r\n    width: 100%;\r\n}\r\n\r\n.word {\r\n    display: inline-block;\r\n    position: relative;\r\n    animation: slideDown 0.8s ease-in-out;\r\n}\r\n\r\n#word1 {\r\n    color: red;\r\n    font-weight: bolder;\r\n}\r\n\r\n#word2 {\r\n    color: blue;\r\n    font-weight: bolder;\r\n}\r\n\r\n@keyframes slideDown {\r\n    from {\r\n        transform: translateY(-100%);\r\n        opacity: 0;\r\n    }\r\n    to {\r\n        transform: translateY(0);\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n.btn_design_mm {\r\n    margin-left: 35%;\r\n    font-size: 20px;\r\n    padding: 20px;\r\n    font-family: \"Dancing Script\", cursive;\r\n    border-radius: 20px;\r\n    border-right: 1px solid blue;\r\n    margin-right: 20px;\r\n    border-left: 1px solid red;\r\n    border-top: 1px solid blueviolet;\r\n    border-bottom: 1px solid orange;\r\n    background-color: rgb(200, 245, 245);\r\n    font-weight: bolder;\r\n}\r\n\r\n.btn_design_mm a {\r\n    text-decoration: none;\r\n    color: #000;\r\n}\r\n\r\n.btn_design_mm:hover {\r\n    border-right: 1px solid red;\r\n    border-left: 1px solid blue;\r\n    border-top: 1px solid orange;\r\n    border-bottom: 1px solid blueviolet;\r\n    background-color: aqua;\r\n}\r\n\r\n.btn_design_mm_ai:hover {\r\n    border-right: 1px solid red;\r\n    border-left: 1px solid blue;\r\n    border-top: 1px solid orange;\r\n    border-bottom: 1px solid blueviolet;\r\n    background-color: aqua;\r\n}\r\n\r\n.btn_design_mm_ai {\r\n    font-size: 20px;\r\n    padding: 20px;\r\n    font-weight: bolder;\r\n    font-family: \"Dancing Script\", cursive;\r\n    border-radius: 20px;\r\n    border-right: 1px solid blue;\r\n    border-left: 1px solid red;\r\n    border-top: 1px solid blueviolet;\r\n    border-bottom: 1px solid orange;\r\n    background-color: rgb(200, 245, 245);\r\n}\r\n\r\n.btn_design_mm_ai a {\r\n    text-decoration: none;\r\n    color: #000;\r\n}\r\n\r\n/* ABOUT */\r\n#about {\r\n    margin: 20px;\r\n    width: 100%;\r\n}\r\n\r\n#about img {\r\n    width: 100%;\r\n    max-width: 1300px;\r\n    margin-bottom: 50px;\r\n}\r\n\r\n#about p {\r\n    padding: 0 100px;\r\n    font-size: 20px;\r\n}\r\n.footer_top {\r\n    width: 100%;\r\n    display: flex;\r\n    margin: 100px;\r\n}\r\n\r\n.footer_top img {\r\n    height: 300px;\r\n}\r\n\r\n.footer_top-left {\r\n    width: 50%;\r\n}\r\n\r\n.footer_top-right {\r\n    width: 50%;\r\n    margin-right: 100px;\r\n}\r\n\r\n.footer_top-right h1 {\r\n    font-size: 40px;\r\n    text-align: center;\r\n}\r\n\r\n.footer_top-right li {\r\n    font-size: 30px;\r\n    margin-top: 20px;\r\n    text-align: center;\r\n    list-style-type: none;\r\n}\r\n@media screen and (max-width:786px) {\r\n    /* About */\r\n    #about img {\r\n        width: 100%;\r\n    }\r\n\r\n    .btn_design_mm_ai {\r\n        margin-left: 32%;\r\n        margin-top: 10px;\r\n    }\r\n\r\n    #about {\r\n        margin: 0;\r\n        width: 100%;\r\n    }\r\n\r\n    #about p {\r\n        padding: 15px;\r\n    }\r\n\r\n    /* Footer */\r\n    footer {\r\n        width: 100%;\r\n    }\r\n\r\n    .footer_top {\r\n        width: 100%;\r\n        display: block;\r\n        margin: 0;\r\n    }\r\n\r\n    .footer_top-left {\r\n        width: 100%;\r\n        align-items: center;\r\n        justify-content: center;\r\n        text-align: center;\r\n    }\r\n\r\n    .footer_top-right {\r\n        width: 100%;\r\n        margin: 15px;\r\n    }\r\n\r\n    .footer_top-right h1 {\r\n        font-size: 30px;\r\n    }\r\n\r\n    .footer_top-right ul>li {\r\n        font-size: 20px;\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./Home.vue?vue&type=template&id=e79fe2c4&scoped=true\"\nimport script from \"./Home.vue?vue&type=script&lang=js\"\nexport * from \"./Home.vue?vue&type=script&lang=js\"\n\nimport \"./Home.vue?vue&type=style&index=0&id=e79fe2c4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-e79fe2c4\"]])\n\nexport default __exports__","<template>\r\n  <div>\r\n    <!-- Toolbar -->\r\n    <div class=\"toollist\">\r\n      <div class=\"toolbar_list-left\">\r\n        <router-link to=\"/createMM\">\r\n          <button class=\"btn-primary\">\r\n            <span>&#171;</span> Tự tạo sơ đồ tư duy\r\n          </button>\r\n        </router-link>\r\n      </div>\r\n      <div class=\"search_list\">\r\n        <input v-model=\"searchTerm\" @input=\"filterList\" type=\"text\" placeholder=\"Nhập tên sơ đồ tư duy cần tìm...\" />\r\n        <button class=\"btn-search\" @click=\"filterList\">\r\n          <i class=\"fa-solid fa-magnifying-glass\"></i>\r\n        </button>\r\n      </div>\r\n      <div class=\"toolbar_list-right\">\r\n        <router-link to=\"/createMMAI\">\r\n          <button class=\"btn-secondary\">\r\n            Tạo sơ đồ tư duy AI <span>&#187;</span>\r\n          </button>\r\n        </router-link>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Danh sách mindmap -->\r\n    <div v-if=\"loading\" class=\"loading\">Đang tải...</div>\r\n    <div v-else>\r\n      <div v-for=\"item in filteredList\" :key=\"item._id\" class=\"listmm\">\r\n        <router-link :to=\"`/createmm/edit/${item._id}`\" class=\"itemmm\">\r\n          <img :src=\"item.imageUrl\" alt=\"Mindmap\" />\r\n          <div class=\"listmm-content\">\r\n            <h3 class=\"title\">{{ item.title }}</h3>\r\n            <small>Ngày tạo: {{ formatDate(item.createdAt) }}</small>\r\n          </div>\r\n        </router-link>\r\n        <div class=\"list_delete\" @click=\"deleteItem(item._id)\">\r\n          <i class=\"fa-solid fa-trash\"></i>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"!filteredList.length\" class=\"no-data\">\r\n        Không tìm thấy sơ đồ tư duy.\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getAuth } from 'firebase/auth';\r\n\r\nexport default {\r\n  name: \"MindMapList\",\r\n  data() {\r\n    return {\r\n      list: [],         // toàn bộ mindmaps\r\n      filteredList: [], // đã filter\r\n      searchTerm: \"\",\r\n      loading: false\r\n    };\r\n  },\r\n  mounted() {\r\n    this.fetchList();\r\n  },\r\n  methods: {\r\n    // 1) Lấy danh sách mindmap\r\n    async fetchList() {\r\n      this.loading = true;\r\n      try {\r\n        let token;\r\n\r\n        // 1. Kiểm tra loại provider đã lưu\r\n        const provider = localStorage.getItem('provider'); // 'google' hay 'custom'\r\n        console.log(provider)\r\n        if (provider === 'google') {\r\n          // Firebase-authenticated user\r\n          const auth = getAuth();\r\n          const user = auth.currentUser;\r\n          if (!user) throw new Error('Chưa đăng nhập Firebase');\r\n          token = await user.getIdToken(/* forceRefresh= */ true);\r\n        } else {\r\n          // Custom-authenticated user\r\n          token = localStorage.getItem('token');\r\n          if (!token) throw new Error('Chưa đăng nhập hệ thống');\r\n        }\r\n\r\n        // 2. Gọi API chung\r\n        const res = await fetch(\"/api/listMindmap/Listmm\", {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n        if (res.status === 401) {\r\n          throw new Error('Không có quyền hoặc token hết hạn');\r\n        }\r\n        if (!res.ok) {\r\n          throw new Error(await res.text());\r\n        }\r\n\r\n        // 3. Nhận và gán dữ liệu\r\n        const { list } = await res.json();\r\n        this.list = list;\r\n        this.filteredList = list;\r\n\r\n      } catch (e) {\r\n        alert(\"Lỗi khi tải danh sách: \" + e.message);\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    // 2) Filter theo searchTerm\r\n    filterList() {\r\n      const term = this.searchTerm.trim().toLowerCase();\r\n      if (!term) {\r\n        this.filteredList = this.list;\r\n      } else {\r\n        this.filteredList = this.list.filter(item =>\r\n          item.title.toLowerCase().includes(term)\r\n        );\r\n      }\r\n    },\r\n\r\n    // 3) Xóa mindmap\r\n    async deleteItem(id) {\r\n      if (!confirm(\"Bạn có chắc muốn xóa sơ đồ này?\")) return;\r\n      try {\r\n        let token;\r\n\r\n        // 1. Kiểm tra loại provider đã lưu\r\n        const provider = localStorage.getItem('provider'); // 'google' hay 'custom'\r\n        console.log(provider)\r\n        if (provider === 'google') {\r\n          // Firebase-authenticated user\r\n          const auth = getAuth();\r\n          const user = auth.currentUser;\r\n          if (!user) throw new Error('Chưa đăng nhập Firebase');\r\n          token = await user.getIdToken(/* forceRefresh= */ true);\r\n        } else {\r\n          // Custom-authenticated user\r\n          token = localStorage.getItem('token');\r\n          if (!token) throw new Error('Chưa đăng nhập hệ thống');\r\n        }\r\n        const res = await fetch(\r\n          `/api/listMindmap/${id}`,\r\n          {\r\n            method: \"DELETE\",\r\n            headers: { Authorization: `Bearer ${token}` }\r\n          }\r\n        );\r\n        if (!res.ok) throw new Error(await res.text());\r\n        // Cập nhật lại danh sách sau khi xóa\r\n        this.list = this.list.filter(i => i._id !== id);\r\n        this.filterList();\r\n      } catch (e) {\r\n        alert(\"Lỗi khi xóa: \" + e.message);\r\n      }\r\n    },\r\n\r\n    // 4) Định dạng ngày tháng\r\n    formatDate(iso) {\r\n      const d = new Date(iso);\r\n      return d.toLocaleDateString() + \" \" + d.toLocaleTimeString();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n<style scoped>\r\n/* Tổng thể */\r\nbody {\r\n  font-family: 'Roboto', sans-serif;\r\n}\r\n\r\n/* Thanh công cụ */\r\n.toollist {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  background: linear-gradient(135deg, rgb(77, 70, 70), aqua);\r\n  padding: 15px 20px;\r\n  border-radius: 10px;\r\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.toolbar_list-left,\r\n.toolbar_list-right {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n/* Nút bấm */\r\n.btn-primary,\r\n.btn-secondary {\r\n  padding: 8px 16px;\r\n  border: 1px solid #007bff;\r\n  border-radius: 8px;\r\n  background-color: #007bff;\r\n  color: #fff;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease, transform 0.2s ease;\r\n}\r\n\r\n.btn-secondary {\r\n  background-color: #28a745;\r\n  border-color: #28a745;\r\n}\r\n\r\n.btn-primary:hover,\r\n.btn-secondary:hover {\r\n  background-color: #28a745;\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.btn-search {\r\n  padding: 8px 12px;\r\n  background-color: aqua;\r\n  color: #fff;\r\n  border: 2px solid #ccc;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n}\r\n\r\n.btn-search i {\r\n  font-size: 20px;\r\n}\r\n\r\n.btn-search:hover {\r\n  background-color: rgb(6, 141, 146);\r\n}\r\n\r\n/* Thanh tìm kiếm */\r\n.search_list {\r\n  display: flex;\r\n  align-items: center;\r\n  flex: 1;\r\n  margin: 0 20px;\r\n}\r\n\r\n.search_list input {\r\n  flex: 1;\r\n  padding: 10px 12px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 8px 0 0 8px;\r\n  outline: none;\r\n  transition: border 0.3s ease;\r\n}\r\n\r\n.search_list input:focus {\r\n  border-color: #007bff;\r\n}\r\n\r\n.search_list .btn-search {\r\n  border-radius: 0 8px 8px 0;\r\n}\r\n\r\n/* Danh sách sơ đồ tư duy */\r\n.listmm {\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: #ddd;\r\n  border: 1px solid #010;\r\n  border-radius: 10px;\r\n  padding: 15px;\r\n  margin-bottom: 5px;\r\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);\r\n  transition: box-shadow 0.3s ease;\r\n}\r\n\r\n.itemmm {\r\n  width: 95%;\r\n  display: flex;\r\n  text-decoration: none;\r\n}\r\n\r\n.listmm:hover {\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n  background-color: #fff;\r\n}\r\n\r\n.listmm img {\r\n  width: 20%;\r\n  min-width: 120px;\r\n  border-radius: 8px;\r\n  margin-right: 15px;\r\n}\r\n\r\n.listmm-content {\r\n  flex: 1;\r\n}\r\n\r\n.listmm .title {\r\n  font-size: 18px;\r\n  margin: 0;\r\n  color: #333;\r\n}\r\n\r\n.list_delete {\r\n  padding-left: 20px;\r\n  cursor: pointer;\r\n  transition: color 0.3s ease, transform 0.2s ease;\r\n}\r\n\r\n.list_delete i {\r\n  font-size: 26px;\r\n  color: #888;\r\n}\r\n\r\n.list_delete i:hover {\r\n  color: #d9534f;\r\n  transform: scale(1.1);\r\n}\r\n\r\n.loading {\r\n  text-align: center;\r\n  margin: 20px 0;\r\n  color: #555;\r\n}\r\n\r\n.no-data {\r\n  text-align: center;\r\n  margin: 20px 0;\r\n  color: #999;\r\n}\r\n\r\n/* Responsive */\r\n@media screen and (max-width: 768px) {\r\n  .toollist {\r\n    flex-direction: column;\r\n    align-items: stretch;\r\n  }\r\n\r\n  .toolbar_list-left,\r\n  .toolbar_list-right {\r\n    justify-content: center;\r\n    margin-bottom: 10px;\r\n    width: 100%;\r\n  }\r\n\r\n  .toolbar_list-left .btn-primary {\r\n    align-items: start;\r\n    justify-content: center;\r\n    margin-right: 350px;\r\n  }\r\n\r\n  .toolbar_list-right .btn-secondary {\r\n    align-items: end;\r\n    justify-content: center;\r\n    margin-left: 350px;\r\n  }\r\n\r\n  .search_list {\r\n    margin: 10px 0;\r\n  }\r\n\r\n  .listmm {\r\n    min-width: 280px;\r\n  }\r\n\r\n  .listmm img {\r\n    width: 30%;\r\n    min-width: 80px;\r\n    margin-right: 10px;\r\n  }\r\n\r\n  .list_delete {\r\n    align-self: flex-end;\r\n    padding: 10px 0 0 0;\r\n  }\r\n}\r\n</style>","import { render } from \"./listmm.vue?vue&type=template&id=b7ebff58&scoped=true\"\nimport script from \"./listmm.vue?vue&type=script&lang=js\"\nexport * from \"./listmm.vue?vue&type=script&lang=js\"\n\nimport \"./listmm.vue?vue&type=style&index=0&id=b7ebff58&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-b7ebff58\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"mindmap-container\">\r\n    <!-- Toolbar -->\r\n    <div class=\"toolbar\">\r\n      <div class=\"toolbar-left\">\r\n        <button class=\"toolbar-btn\" @click=\"zoomIn()\">\r\n          <i class=\"fa-solid fa-search-plus\"></i>\r\n        </button>\r\n        <button class=\"toolbar-btn\" @click=\"zoomOut()\">\r\n          <i class=\"fa-solid fa-search-minus\"></i>\r\n        </button>\r\n        <button class=\"toolbar-btn\" @click=\"undo()\">\r\n          <i class=\"fa-solid fa-rotate-left\"></i>\r\n        </button>\r\n        <button class=\"toolbar-btn\" @click=\"redo()\">\r\n          <i class=\"fa-solid fa-rotate-right\"></i>\r\n        </button>\r\n        <button class=\"toolbar-btn\" @click=\"removeNode()\">\r\n          <i class=\"fa-solid fa-trash\"></i>\r\n        </button>\r\n        <button class=\"toolbar-btn\" @click=\"uploadImage()\">\r\n          <i class=\"fa-solid fa-upload\"></i>\r\n        </button>\r\n      </div>\r\n      <div class=\"toolbar-right\">\r\n        <button class=\"toolbar-btn\" @click=\"exportImage\">\r\n          <i class=\"fa-solid fa-image\"></i>\r\n          <span>Xuất hình ảnh</span>\r\n        </button>\r\n        <button class=\"toolbar-btn\" @click=\"exportPPT\">\r\n          <i class=\"fa-solid fa-file-powerpoint\"></i>\r\n          <span>Xuất PPT</span>\r\n        </button>\r\n        <button @click=\"openModal\" class=\"toolbar-btn\">\r\n          <i class=\"fa-solid fa-floppy-disk\"></i>\r\n          <span>{{ isEditing ? 'Cập nhật' : 'Lưu sơ đồ' }}</span>\r\n        </button>\r\n        <button class=\"toolbar-btn ai-button\">\r\n          <a href=\"/createMMAI\">\r\n            <i class=\"fa-solid fa-robot\"></i>\r\n            <span>TẠO VỚI AI</span>\r\n          </a>\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <div class=\"modal-backdrop\" v-if=\"showModal\">\r\n      <div class=\"modal\">\r\n        <h3>Đặt tên sơ đồ tư duy</h3>\r\n        <input v-model=\"form.mapTitle\" placeholder=\"Tên sơ đồ tư duy\" />\r\n        <div class=\"modal-actions\">\r\n          <button @click=\"_postSaveManual\">Lưu</button>\r\n          <button @click=\"closeModal\">Huỷ</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- Input ẩn để tải ảnh lên -->\r\n    <input type=\"file\" id=\"imageUploader\" accept=\"image/*\" style=\"display: none;\" @change=\"handleFileSelect\" />\r\n\r\n    <div class=\"content\">\r\n      <!-- Left Panel: Các công cụ & cài đặt -->\r\n      <div class=\"left-panel\">\r\n        <!-- Chọn hình dạng node -->\r\n        <div class=\"node-shapes\">\r\n          <h3><i class=\"fa-solid fa-shapes\"></i> Hình dạng</h3>\r\n          <div class=\"shape\">\r\n            <div class=\"shape-option\" draggable=\"true\" @dragstart=\"dragStart('rectangle')\">\r\n              <i class=\"fa-solid fa-square\"></i>\r\n            </div>\r\n            <div class=\"shape-option\" draggable=\"true\" @dragstart=\"dragStart('circle')\">\r\n              <i class=\"fa-solid fa-circle\"></i>\r\n            </div>\r\n            <div class=\"shape-option\" draggable=\"true\" @dragstart=\"dragStart('label')\">\r\n              <i class=\"fa-solid fa-tag\"></i>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Định dạng chữ -->\r\n        <div class=\"text-formatting\">\r\n          <h3><i class=\"fa-solid fa-text-height\"></i> Kiểu chữ</h3>\r\n          <div class=\"fomat\">\r\n            <button class=\"format-btn\"\r\n              :class=\"{ active: (selectedNode && selectedNode.isBold) || (selectedLink && selectedLink.isBold) }\"\r\n              @click=\"toggleBold\">\r\n              <i class=\"fa-solid fa-bold\"></i>\r\n            </button>\r\n            <button class=\"format-btn\"\r\n              :class=\"{ active: (selectedNode && selectedNode.isItalic) || (selectedLink && selectedLink.isItalic) }\"\r\n              @click=\"toggleItalic\">\r\n              <i class=\"fa-solid fa-italic\"></i>\r\n            </button>\r\n            <button class=\"format-btn\"\r\n              :class=\"{ active: (selectedNode && selectedNode.align === 'left') || (selectedLink && selectedLink.align === 'start') }\"\r\n              @click=\"setAlign('left')\">\r\n              <i class=\"fa-solid fa-align-left\"></i>\r\n            </button>\r\n            <button class=\"format-btn\"\r\n              :class=\"{ active: (selectedNode && selectedNode.align === 'center') || (selectedLink && selectedLink.align === 'middle') }\"\r\n              @click=\"setAlign('center')\">\r\n              <i class=\"fa-solid fa-align-center\"></i>\r\n            </button>\r\n            <button class=\"format-btn\"\r\n              :class=\"{ active: (selectedNode && selectedNode.align === 'right') || (selectedLink && selectedLink.align === 'end') }\"\r\n              @click=\"setAlign('right')\">\r\n              <i class=\"fa-solid fa-align-right\"></i>\r\n            </button>\r\n            <input type=\"color\" v-model=\"selectedColor\" @change=\"applyTextColor\" class=\"color-picker\" title=\"Màu chữ\">\r\n            <input type=\"number\" v-model.number=\"selectedFontSize\" @change=\"applyFontSize\" class=\"font-size-input\"\r\n              min=\"6\" max=\"72\" style=\"width:40px; margin-left:8px; border:2px solid #ccc; border-radius: 10px;\"\r\n              title=\"Kích thước chữ (px)\" />\r\n          </div>\r\n          <select v-model=\"selectedFont\" @change=\"applyFontFamily\" class=\"style-select\">\r\n            <option value=\"\">Font</option>\r\n            <option value=\"Arial\">Arial</option>\r\n            <option value=\"Times New Roman\">Times New Roman</option>\r\n            <option value=\"Courier New\">Courier New</option>\r\n          </select>\r\n        </div>\r\n\r\n        <!-- Cài đặt Node Style -->\r\n        <h3><i class=\"fa-solid fa-paintbrush\"></i> Style Node</h3>\r\n        <div class=\"node-style\">\r\n          <div class=\"style-group-node\">\r\n            <input type=\"color\" v-model=\"nodeBorderColor\" @change=\"updateNode(selectedNode)\" class=\"color-picker\"\r\n              title=\"Màu viền\">\r\n            <input type=\"color\" v-model=\"nodeBackgroundColor\" @change=\"updateNode(selectedNode)\" class=\"color-picker\"\r\n              title=\"Màu nền\">\r\n            <input type=\"number\" v-model.number=\"nodeBorderThickness\" min=\"1\" @input=\"updateNode(selectedNode)\"\r\n              class=\"number-input\">\r\n            <select v-model=\"nodeBorderStyle\" @change=\"updateNode(selectedNode)\" class=\"style-select\">\r\n              <option value=\"solid\">Solid</option>\r\n              <option value=\"dashed\">Dashed</option>\r\n              <option value=\"dotted\">Dotted</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Cài đặt Link Style -->\r\n        <div class=\"link-style\">\r\n          <h3><i class=\"fa-solid fa-sitemap\"></i> Style Link</h3>\r\n          <div class=\"style-group\">\r\n            <input type=\"color\" v-model=\"linkColor\" @change=\"updateLink(selectedLink)\" class=\"color-picker\"\r\n              title=\"Màu liên kết\" />\r\n            <input type=\"number\" min=\"1\" v-model.number=\"linkThickness\" @change=\"updateLink(selectedLink)\"\r\n              class=\"number-input\" />\r\n          </div>\r\n\r\n          <div class=\"style-group\">\r\n            <select v-model=\"linkDash\" class=\"style-select\" @change=\"updateLink(selectedLink)\">\r\n              <option value=\"solid\">Solid</option>\r\n              <option value=\"dashed\">Dashed</option>\r\n              <option value=\"dotted\">Dotted</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div class=\"style-group\">\r\n            <label>Độ cong:</label>\r\n            <input type=\"range\" min=\"-1\" max=\"1\" step=\"0.05\" v-model.number=\"linkCurvature\"\r\n              @change=\"updateLink(selectedLink)\" />\r\n            <span>{{ linkCurvature }}</span>\r\n          </div>\r\n\r\n          <div class=\"style-group\">\r\n            <select v-model=\"linkMarker\" @change=\"updateLink(selectedLink)\" class=\"style-select\">\r\n              <option value=\"none\">Không</option>\r\n              <option value=\"arrow\">Mũi tên</option>\r\n              <option value=\"tree\">Cành cây</option>\r\n              <option value=\"radial\">Radial</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Canvas -->\r\n      <div class=\"canvas\" ref=\"canvas\" @click.self=\"clearSelection\" @dragover.prevent @drop=\"drop($event)\"\r\n        @wheel.prevent=\"onWheel\" :style=\"{\r\n          transform: `scale(${scale})`,\r\n          transformOrigin: '0 0'\r\n        }\" tabindex=\"0\" @keydown.ctrl.c.prevent=\"copyNode\" @keydown.ctrl.v.prevent=\"pasteNode\">\r\n\r\n        <svg class=\"link-canvas\" ref=\"canva\" xmlns=\"http://www.w3.org/2000/svg\"\r\n          xmlns:xlink=\"http://www.w3.org/1999/xlink\">\r\n          <defs>\r\n            <!-- Marker mũi tên (arrow) -->\r\n            <marker id=\"arrow\" markerUnits=\"strokeWidth\" markerWidth=\"6\" markerHeight=\"6\" refX=\"6\" refY=\"3\"\r\n              orient=\"auto\">\r\n              <path d=\"M0,0 L6,3 L0,6 Z\" fill=\"currentColor\" />\r\n            </marker>\r\n          </defs>\r\n\r\n          <!-- 1 vòng lặp duy nhất qua tất cả links -->\r\n          <g v-for=\"(link, i) in links\" :key=\"i\" @click.stop=\"handleLinkClick(link)\">\r\n\r\n            <!-- A) Tree mode: vẽ gốc circle to + thân mảnh -->\r\n            <path v-if=\"link.marker === 'tree'\" @click.stop=\"selectLink(link)\" :d=\"computeTaperedBranch(link)\"\r\n              :fill=\"link.color\" :class=\"{ 'link--selected': link === selectedLink }\" />\r\n            <path v-else-if=\"link.marker === 'radial'\" @click.stop=\"selectLink(link)\" :id=\"`linkPath-${i}`\"\r\n              :d=\"computeRadialLinkPath(link) || link.path\" :stroke=\"link.color\" :stroke-width=\"link.thickness\"\r\n              fill=\"none\" :class=\"{ 'link--selected': link === selectedLink }\" />\r\n            <!-- C) Node→free-pos -->\r\n            <path @click.stop=\"selectLink(link)\"\r\n              v-else-if=\"getLinkPath(link.from, link.toPos || link.to, !!link.toPos, link.curvature)\"\r\n              :d=\"getLinkPath(link.from, link.toPos || link.to, !!link.toPos, link.curvature)\" :stroke=\"link.color\"\r\n              :stroke-width=\"link.thickness\" :stroke-dasharray=\"dashArray(link.dash)\"\r\n              :marker-end=\"link.marker === 'none' ? null : `url(#${link.marker})`\" fill=\"none\" />\r\n            <circle v-if=\"link === selectedLink && link.toPos\" :cx=\"link.toPos.x\" :cy=\"link.toPos.y\" r=\"6\"\r\n              style=\"cursor:move; pointer-events:all;\" @mousedown.stop.prevent=\"startDragEnd(link, $event)\" />\r\n            <!-- B) Regular mode: node→node straight or curved, arrow/none -->\r\n            <path v-else-if=\"!link.toPos && link.curvature === 0\" :x1=\"getNodeCenter(link.from).x\"\r\n              :y1=\"getNodeCenter(link.from).y\" :x2=\"getNodeCenter(link.to).x\" :y2=\"getNodeCenter(link.to).y\"\r\n              :stroke=\"link.color\" :stroke-width=\"link.thickness\" :stroke-dasharray=\"dashArray(link.dash)\"\r\n              :marker-end=\"link.marker === 'none' ? null : `url(#${link.marker})`\" fill=\"none\"\r\n              @click.stop=\"selectLink(link)\" />\r\n            <path v-else-if=\"!link.toPos\" :d=\"getLinkPath(link.from, link.to, false, link.curvature)\"\r\n              :stroke=\"link.color\" :stroke-width=\"link.thickness\" :stroke-dasharray=\"dashArray(link.dash)\"\r\n              :marker-end=\"link.marker === 'none' ? null : `url(#${link.marker})`\" fill=\"none\"\r\n              @click.stop=\"selectLink(link)\" />\r\n            <!-- D) Handle chỉnh độ cong -->\r\n            <circle v-if=\"link === selectedLink\" :cx=\"midPoint(link).x\" :cy=\"midPoint(link).y\" r=\"6\" fill=\"white\"\r\n              stroke=\"gray\" stroke-width=\"1\" style=\"pointer-events: all; cursor: move;\"\r\n              @mousedown.prevent=\"startAdjustCurvature(link, $event)\" />\r\n            <text v-if=\"link.marker === 'radial'\" font-size=\"12\" fill=\"#333\" @dblclick.stop.prevent=\"startEditing(i)\"\r\n              style=\"pointer-events: all; cursor: text;\">\r\n              <textPath :xlink:href=\"`#linkPath-${i}`\" startOffset=\"65%\" :text-anchor=\"link.align\"\r\n                :font-weight=\"link.isBold ? 'bold' : 'normal'\" :font-style=\"link.isItalic ? 'italic' : 'normal'\"\r\n                :fill=\"link.textColor\" :font-family=\"link.fontFamily\" :font-size=\"`${link.fontSize}px`\">\r\n                {{ link.text || 'Nhập nhãn...' }}\r\n              </textPath>\r\n            </text>\r\n            <foreignObject v-if=\"editingIndex === i\" :x=\"inputX\" :y=\"inputY\" width=\"120\" height=\"24\">\r\n              <input xmlns=\"http://www.w3.org/1999/xhtml\" type=\"text\" v-model=\"tempText\"\r\n                @keydown.enter.prevent=\"finishEditing(i)\" @blur=\"finishEditing(i)\" ref=\"editableInput\" style=\"\r\n                  font-size:12px;\r\n                  padding:4px;\r\n                  border:1px solid #2196f3;\r\n                  background:#fff;\r\n                  border-radius:4px;\r\n                  width:100%;\r\n                  height:100%;\r\n                  box-sizing:border-box;\r\n                \" />\r\n            </foreignObject>\r\n\r\n          </g>\r\n          <line v-if=\"linking.active && linking.fromNode\" :x1=\"getNodeCenter(linking.fromNode.id).x\"\r\n            :y1=\"getNodeCenter(linking.fromNode.id).y\" :x2=\"linking.tempPos.x\" :y2=\"linking.tempPos.y\" stroke=\"#999\"\r\n            stroke-dasharray=\"4,4\" />\r\n        </svg>\r\n        <!-- Phần render nodes (không thay đổi) -->\r\n        <div v-for=\"node in nodes\" :key=\"node.id\" :data-id=\"node.id\" :class=\"{ 'node--disabled': linkMode }\"\r\n          class=\"node\" :style=\"{\r\n            top: node.top + 'px',\r\n            left: node.left + 'px',\r\n            width: node.width + 'px',\r\n            height: node.height + 'px',\r\n            overflow: 'visible',\r\n            transform: `rotate(${node.rotation}deg)`,\r\n            transformOrigin: 'center center'\r\n          }\" @mousedown=\"startDragNode(node, $event)\" @click.stop=\"handleNodeClick(node)\">\r\n          <div v-if=\"selectedNode && selectedNode.id === node.id\" class=\"rotate-handle\"\r\n            @mousedown.stop.prevent=\"startRotate(node, $event)\">\r\n            <i class=\"fa-solid fa-arrows-spin\"></i>\r\n          </div>\r\n          <!-- dấu + chỉ hiển thị khi node được chọn -->\r\n          <div v-if=\"selectedNode && selectedNode.id === node.id\" class=\"link-handle\"\r\n            @mousedown.stop.prevent=\"beginLink(node, $event)\">+</div>\r\n\r\n          <div class=\"shape-inner\" :class=\"node.type\" :style=\"shapeInnerStyle(node)\" :contenteditable=\"!linking.active\"\r\n            @blur=\"updateNodeText($event, node)\">\r\n            <template v-if=\"node.type === 'image'\">\r\n              <img :src=\"node.image\" alt=\"node image\" style=\"width:100%; height:100%; object-fit: contain;\" />\r\n            </template>\r\n            <template v-else>\r\n              <span v-html=\"node.text || node.type\"></span>\r\n            </template>\r\n          </div>\r\n\r\n          <!-- resize handles -->\r\n          <template v-if=\"selectedNode && selectedNode.id === node.id\">\r\n            <div class=\"resize-handle top-left\" @mousedown.stop=\"startResize(node, $event, 'top-left')\"></div>\r\n            <div class=\"resize-handle top-center\" @mousedown.stop=\"startResize(node, $event, 'top-center')\"></div>\r\n            <div class=\"resize-handle top-right\" @mousedown.stop=\"startResize(node, $event, 'top-right')\"></div>\r\n            <div class=\"resize-handle mid-left\" @mousedown.stop=\"startResize(node, $event, 'mid-left')\"></div>\r\n            <div class=\"resize-handle mid-right\" @mousedown.stop=\"startResize(node, $event, 'mid-right')\"></div>\r\n            <div class=\"resize-handle bottom-left\" @mousedown.stop=\"startResize(node, $event, 'bottom-left')\"></div>\r\n            <div class=\"resize-handle bottom-center\" @mousedown.stop=\"startResize(node, $event, 'bottom-center')\"></div>\r\n            <div class=\"resize-handle bottom-right\" @mousedown.stop=\"startResize(node, $event, 'bottom-right')\"></div>\r\n          </template>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as d3 from 'd3';\r\nimport * as htmlToImage from 'html-to-image';\r\nlet idCounter = 1;\r\nexport default {\r\n  name: \"CreateMindMap\",\r\n  props: {\r\n    id: { type: String, default: null }\r\n  },\r\n  data() {\r\n    return {\r\n      scale: 1,\r\n      minScale: 0.2,\r\n      maxScale: 3,\r\n      scaleStep: 0.1,\r\n      translate: { x: 0, y: 0 },\r\n      history: [],\r\n      nodes: [],        // luôn là mảng, không bao giờ undefined\r\n      links: [],\r\n      rawData: [],\r\n      historyIndex: -1,\r\n      linking: {\r\n        active: false,\r\n        fromNode: null,\r\n        tempPos: { x: 0, y: 0 }\r\n      },\r\n      linkMode: false,\r\n      currentDrag: null,\r\n      selectedNode: null,\r\n      draggingNode: null,\r\n      selectedLink: null,\r\n      offsetX: 0,\r\n      offsetY: 0,\r\n      resizingNode: null,\r\n      resizeDir: null,\r\n      startX: 0,\r\n      startY: 0,\r\n      startW: 0,\r\n      startH: 0,\r\n      startL: 0,\r\n      startT: 0,\r\n      customColor: false,\r\n      customColor1: false,\r\n      selectedFont: '',\r\n      selectedColor: '#000000',\r\n      selectedFontSize: 12,\r\n      selectedAlign: 'center',\r\n      defaultNodeBorderColor: '#333333',\r\n      defaultNodeBackgroundColor: '#ffffff',\r\n      defaultNodeBorderThickness: 2,\r\n      defaultNodeBorderStyle: 'solid',\r\n      dragStartSave: { x: 0, y: 0 },\r\n      defaultLinkColor: '#000000',\r\n      defaultLinkThickness: 2,\r\n      defaultLinkDash: 'solid',\r\n      defaultLinkCurvature: 0,        // 0 = thẳng, >0 = cong\r\n      defaultLinkMarker: 'none',\r\n      draggingLinkEnd: null,\r\n      mindmapData: null,\r\n      selectedTemplate: null,\r\n      loading: false,\r\n      error: null,\r\n      selectedMapType: 'free',\r\n      mindmapObject: null,\r\n      showModal: false,\r\n      form: {\r\n        mapTitle: ''\r\n      },\r\n      rotatingNode: null,\r\n      rotateStartAngle: 0,\r\n      rotateCenter: { x: 0, y: 0 },\r\n      svg: null,\r\n      inputX: 0,\r\n      inputY: 0,\r\n      editingIndex: null,       // index (i) của link đang edit\r\n      tempText: '',\r\n    }\r\n  },\r\n  async mounted() {\r\n    // 1) khởi tạo SVG reference\r\n    this.svg = d3.select(this.$refs.canvas);\r\n\r\n    // 2) fetch data\r\n    const { id } = this.$route.params;\r\n    if (!id) return;\r\n    this.loading = true;\r\n    try {\r\n      const resp = await fetch(\r\n        `/api/listMindmap/${id}`,\r\n        { headers: { Authorization: `Bearer ${localStorage.getItem('token')}` } }\r\n      );\r\n      const result = await resp.json();\r\n      const item = result.item ?? result.data ?? result.payload ?? result;\r\n      this.form.mapTitle = item.title;\r\n      const mapType = item.mapType ?? item.type;\r\n      let rawData = (mapType === 'manual' || mapType === 'free')\r\n        ? item.manualData\r\n        : item.mindmapData;\r\n      if (typeof rawData === 'string') rawData = JSON.parse(rawData);\r\n\r\n      // 3) map lại nodes để thêm left/top, gán vào state\r\n      this.nodes = (rawData.nodes || []).map(n => ({\r\n        ...n,\r\n        left: n.x,   // CSS của Vue template dùng left/top\r\n        top: n.y,\r\n      }));\r\n      this.links = rawData.links || [];\r\n\r\n      // 4) nếu manual, sanitize text\r\n      if (mapType === 'manual') {\r\n        this.nodes.forEach(n => {\r\n          n.text = String(n.text).replace(/<[^>]+>/g, '');\r\n        });\r\n      }\r\n\r\n      this.selectedMapType = mapType;\r\n      this.mindmapObject = rawData;\r\n\r\n      // 5) chờ Vue render rồi vẽ D3 cho links\r\n      this.$nextTick(() => {\r\n        this.drawMindMap(this.svg);\r\n        this.initSelection && this.initSelection();\r\n      });\r\n\r\n    } catch (e) {\r\n      console.error(e);\r\n      this.error = e.message;\r\n    } finally {\r\n      this.loading = false;\r\n    }\r\n  },\r\n\r\n\r\n  computed: {\r\n    nodeBorderColor: {\r\n      get() {\r\n        return this.selectedNode?.borderColor ?? this.defaultNodeBorderColor;\r\n      },\r\n      set(val) {\r\n        if (this.selectedNode) {\r\n          this.selectedNode.borderColor = val;\r\n        } else {\r\n          this.defaultNodeBorderColor = val;\r\n        }\r\n      }\r\n    },\r\n    nodeBackgroundColor: {\r\n      get() {\r\n        return this.selectedNode?.backgroundColor ?? this.defaultNodeBackgroundColor;\r\n      },\r\n      set(val) {\r\n        if (this.selectedNode) {\r\n          this.selectedNode.backgroundColor = val;\r\n        } else {\r\n          this.defaultNodeBackgroundColor = val;\r\n        }\r\n      }\r\n    },\r\n    nodeBorderThickness: {\r\n      get() {\r\n        return this.selectedNode?.borderThickness ?? this.defaultNodeBorderThickness;\r\n      },\r\n      set(val) {\r\n        if (this.selectedNode) {\r\n          this.selectedNode.borderThickness = val;\r\n        } else {\r\n          this.defaultNodeBorderThickness = val;\r\n        }\r\n      }\r\n    },\r\n    nodeBorderStyle: {\r\n      get() {\r\n        return this.selectedNode?.borderStyle ?? this.defaultNodeBorderStyle;\r\n      },\r\n      set(val) {\r\n        if (this.selectedNode) {\r\n          this.selectedNode.borderStyle = val;\r\n        } else {\r\n          this.defaultNodeBorderStyle = val;\r\n        }\r\n      }\r\n    },\r\n    straightLinks() {\r\n      return this.links.filter(l => (l.curvature || 0) === 0 && l.to !== undefined);\r\n    },\r\n    // Các link cong (curvature > 0)\r\n    curvedLinks() {\r\n      return this.links.filter(l => (l.curvature || 0) > 0 && l.to !== undefined);\r\n    },\r\n    // chỉ những link có .toPos (node → vị trí free)\r\n    posLinks() {\r\n      return this.links.filter(l => l.toPos !== undefined);\r\n    },\r\n    linkColor: {\r\n      get() {\r\n        return this.selectedLink?.color ?? this.defaultLinkColor;\r\n      },\r\n      set(val) {\r\n        if (this.selectedLink) {\r\n          this.selectedLink.color = val;\r\n        } else {\r\n          this.defaultLinkColor = val;\r\n        }\r\n      }\r\n    },\r\n\r\n    // Độ dày\r\n    linkThickness: {\r\n      get() {\r\n        return this.selectedLink?.thickness ?? this.defaultLinkThickness;\r\n      },\r\n      set(val) {\r\n        if (this.selectedLink) {\r\n          this.selectedLink.thickness = val;\r\n        } else {\r\n          this.defaultLinkThickness = val;\r\n        }\r\n      }\r\n    },\r\n\r\n    // Kiểu nét (dash)\r\n    linkDash: {\r\n      get() {\r\n        return this.selectedLink?.dash ?? this.defaultLinkDash;\r\n      },\r\n      set(val) {\r\n        if (this.selectedLink) {\r\n          this.selectedLink.dash = val;\r\n        } else {\r\n          this.defaultLinkDash = val;\r\n        }\r\n      }\r\n    },\r\n\r\n    // Độ cong\r\n    linkCurvature: {\r\n      get() {\r\n        return this.selectedLink?.curvature ?? this.defaultLinkCurvature;\r\n      },\r\n      set(val) {\r\n        if (this.selectedLink) {\r\n          this.selectedLink.curvature = val;\r\n        } else {\r\n          this.defaultLinkCurvature = val;\r\n        }\r\n      }\r\n    },\r\n\r\n    // Marker\r\n    linkMarker: {\r\n      get() {\r\n        return this.selectedLink?.marker ?? this.defaultLinkMarker;\r\n      },\r\n      set(val) {\r\n        if (this.selectedLink) {\r\n          this.selectedLink.marker = val;\r\n        } else {\r\n          this.defaultLinkMarker = val;\r\n        }\r\n      }\r\n    },\r\n    canSave() {\r\n      return !!(this.selectedImageUrl || this.mindmapObject)\r\n    },\r\n    isEditing() {\r\n      return !!this.$route.params.id;\r\n    }\r\n  },\r\n  methods: {\r\n    copyNode() {\r\n      if (!this.selectedNode) return;\r\n      // deep clone: loại bỏ reactivity, nếu node có nested object\r\n      this.clipboardNode = JSON.parse(JSON.stringify(this.selectedNode));\r\n      // xóa id cũ để tạo id mới lúc paste\r\n      delete this.clipboardNode.id;\r\n      console.log('Copied', this.clipboardNode);\r\n    },\r\n    // 3. Paste node vào canvas\r\n    pasteNode() {\r\n      if (!this.clipboardNode) return;\r\n      // clone lại lần nữa để tránh sửa chính clipboard\r\n      const newNode = JSON.parse(JSON.stringify(this.clipboardNode));\r\n      // gán id mới (ví dụ timestamp hoặc uuid)\r\n      newNode.id = Date.now();\r\n      // offset vị trí để không đè lên node cũ\r\n      newNode.left += 20;\r\n      newNode.top += 20;\r\n      // thêm vào mảng nodes\r\n      this.nodes.push(newNode);\r\n      // chọn luôn node vừa paste\r\n      this.selectedNode = newNode;\r\n      console.log('Pasted', newNode);\r\n    },\r\n    startEditing(i) {\r\n      console.log(\"👉 startEditing với index =\", i);\r\n      // Đợi Vue render <text> + <path> xong\r\n      this.$nextTick(() => {\r\n        // Tìm path đã vẽ có id=\"linkPath-i\"\r\n        const pathEl = document.getElementById(`linkPath-${i}`);\r\n        if (!pathEl) {\r\n          console.warn(\"Không tìm thấy path với id linkPath-\" + i);\r\n          return;\r\n        }\r\n        // Tính điểm midpoint trên path\r\n        const totalLen = pathEl.getTotalLength();\r\n        const midPt = pathEl.getPointAtLength(totalLen * 0.5);\r\n\r\n        // Căn giữa khung <input> (width=120, height=24)\r\n        this.inputX = midPt.x - 60;  // 120/2 = 60\r\n        this.inputY = midPt.y - 12;  // 24/2 = 12\r\n\r\n        // Gán biến để hiển <foreignObject>\r\n        this.editingIndex = i;\r\n\r\n        // Copy text cũ (nếu có) vào tempText để input hiển sẵn\r\n        this.tempText = this.links[i].text || '';\r\n\r\n        // Sau khi <foreignObject> xuất hiện, focus vào <input>\r\n        this.$nextTick(() => {\r\n          const allInputs = this.$refs.editableInput;\r\n          const target = Array.isArray(allInputs) ? allInputs[0] : allInputs;\r\n          if (target) {\r\n            target.focus();\r\n            // Đặt caret (con trỏ) về cuối chuỗi\r\n            const len = target.value.length;\r\n            target.setSelectionRange(len, len);\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    // Khi user nhấn Enter hoặc blur khỏi <input>\r\n    finishEditing(i) {\r\n      console.log(\"✍️ finishEditing với index =\", i, \"giá trị mới:\", this.tempText);\r\n      // Gán giá trị mới vào mảng links\r\n      this.links[i].text = this.tempText.trim();\r\n      // Ẩn <foreignObject>\r\n      this.editingIndex = null;\r\n      // Reset tempText để lần sau không bị vướng\r\n      this.tempText = '';\r\n    },\r\n\r\n    startRotate(node, event) {\r\n      this.selectedNode = node;\r\n      this.rotatingNode = node;\r\n\r\n      // Lấy wrapper .node\r\n      const wrapper = event.currentTarget.parentNode;\r\n      const rect = wrapper.getBoundingClientRect();\r\n\r\n      // Tọa độ tâm\r\n      const cx = rect.left + rect.width / 2;\r\n      const cy = rect.top + rect.height / 2;\r\n      this.rotateCenter = { x: cx, y: cy };\r\n\r\n      // Tính góc ban đầu giữa tâm → chuột\r\n      const mx = event.clientX;\r\n      const my = event.clientY;\r\n      const startAngle = Math.atan2(my - cy, mx - cx) * 180 / Math.PI;\r\n\r\n      console.log(\r\n        'startRotate:',\r\n        { cx, cy, mx, my, nodeRotation: node.rotation, startAngle }\r\n      );\r\n\r\n      // offset = startAngle – hiện tại\r\n      this.rotateStartAngle = startAngle - node.rotation;\r\n      console.log('rotateStartAngle:', this.rotateStartAngle);\r\n\r\n      // Gắn listener\r\n      window.addEventListener('mousemove', this.onRotate);\r\n      window.addEventListener('mouseup', this.stopRotate);\r\n    },\r\n\r\n    // Trong khi di chuột:\r\n    onRotate(event) {\r\n      if (!this.rotatingNode) return;\r\n      const { x: cx, y: cy } = this.rotateCenter;\r\n      const mx = event.clientX;\r\n      const my = event.clientY;\r\n      let angle = Math.atan2(my - cy, mx - cx) * 180 / Math.PI;\r\n      console.log('onRotate:', { cx, cy, mx, my, rawAngle: angle });\r\n      angle = angle - this.rotateStartAngle;\r\n      console.log('computed rotation:', angle);\r\n      this.rotatingNode.rotation = angle;\r\n    },\r\n\r\n    // Khi thả chuột:\r\n    stopRotate() {\r\n      window.removeEventListener('mousemove', this.onRotate);\r\n      window.removeEventListener('mouseup', this.stopRotate);\r\n      this.rotatingNode = null;\r\n    },\r\n    openModal() {\r\n      this.showModal = true;\r\n    },\r\n    closeModal() {\r\n      this.showModal = false;\r\n    },\r\n    async exportPPT() {\r\n      try {\r\n        const pptx = new window.PptxGenJS();\r\n\r\n        // 1) Build map id→node và lấy plain-text\r\n        const map = {};\r\n        this.nodes.forEach(n => {\r\n          const el = document.querySelector(`.node[data-id=\"${n.id}\"] .shape-inner`);\r\n          const txt = el ? el.innerText.trim() : (n.text || '').trim();\r\n          map[n.id] = { id: n.id, text: txt, children: [] };\r\n        });\r\n\r\n        // 2) Gán children đúng theo cấu trúc link của bạn\r\n        this.links.forEach(l => {\r\n          const parentId = l.from;\r\n          const childId = l.to ?? l.attachedTo;\r\n          if (map[parentId] && map[childId]) {\r\n            map[parentId].children.push(map[childId]);\r\n          }\r\n        });\r\n\r\n        // 3) Tập hợp tất cả ID con để tìm root\r\n        const allChild = new Set(\r\n          this.links.map(l => l.to ?? l.attachedTo)\r\n        );\r\n        const root = Object.values(map).find(n => !allChild.has(n.id));\r\n        if (!root) return alert('Không tìm thấy root!');\r\n\r\n        // 4) Flatten & tạo slide cho mỗi node\r\n        const flat = [];\r\n        const dfs = node => {\r\n          flat.push(node);\r\n          node.children.forEach(dfs);\r\n        };\r\n        dfs(root);\r\n\r\n        flat.forEach(node => {\r\n          const slide = pptx.addSlide();\r\n          slide.addText(node.text, {\r\n            x: 0.5, y: 0.5, fontSize: 28, bold: true\r\n          });\r\n          if (node.children.length) {\r\n            let y0 = 1.2;\r\n            node.children.forEach((c, i) => {\r\n              slide.addText(c.text, {\r\n                x: 0.7, y: y0 + i * 0.5, fontSize: 18, bullet: true, margin: 0.05\r\n              });\r\n            });\r\n          }\r\n        });\r\n\r\n        console.log('Số slide tạo được:', pptx.slides.length);\r\n        await pptx.writeFile({ fileName: 'MindMap_AllSlides.pptx' });\r\n        alert('Đã xuất ' + pptx.slides.length + ' slide!');\r\n      } catch (err) {\r\n        console.error(err);\r\n        alert('Lỗi khi xuất PPT: ' + err.message);\r\n      }\r\n    },\r\n    _exportSvgMarkup() {\r\n      const svgEl = this.$refs.canva;\r\n      if (!svgEl) throw new Error('SVG not found');\r\n      const clone = svgEl.cloneNode(true);\r\n      clone.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\r\n      clone.setAttribute('width', svgEl.clientWidth);\r\n      clone.setAttribute('height', svgEl.clientHeight);\r\n      const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n      bg.setAttribute('x', 0);\r\n      bg.setAttribute('y', 0);\r\n      bg.setAttribute('width', svgEl.clientWidth);\r\n      bg.setAttribute('height', svgEl.clientHeight);\r\n      bg.setAttribute('fill', '#fff');\r\n      clone.insertBefore(bg, clone.firstChild);\r\n      return new XMLSerializer().serializeToString(clone);\r\n    },\r\n\r\n    // Giữ nguyên tên hàm bạn đã có\r\n    async _generateImageFromSvg(maxWidth = 900) {\r\n      // 1) Lấy node SVG (hoặc wrapper chứa SVG)\r\n      //    Nếu bạn không muốn dùng exportSvgMarkup, có thể trực tiếp ref tới <svg>\r\n      const svgEl = this.$refs.canvas;\r\n      if (!svgEl) {\r\n        throw new Error('SVG element not found');\r\n      }\r\n\r\n      // 2) Đảm bảo inline style nếu cần\r\n      this.inlineAllStyles(svgEl);\r\n\r\n      // 3) Tính scale để resize xuống maxWidth\r\n      const origWidth = svgEl.clientWidth;\r\n      const origHeight = svgEl.clientHeight;\r\n      const ratio = maxWidth / origWidth;\r\n      const width = maxWidth;\r\n      const height = Math.round(origHeight * ratio);\r\n\r\n      // 4) Gọi html-to-image.toJpeg\r\n      try {\r\n        const dataUrl = await htmlToImage.toJpeg(svgEl, {\r\n          backgroundColor: 'white',  // hoặc transparent nếu muốn\r\n          width,\r\n          height,\r\n          quality: 0.7                // 0.0–1.0\r\n        });\r\n        // dataUrl là \"data:image/jpeg;base64,....\", bạn có thể lưu vào CSDL\r\n        return dataUrl;\r\n      } catch (err) {\r\n        console.error('Lỗi khi tạo JPEG:', err);\r\n        throw err;\r\n      }\r\n    },\r\n\r\n    // Hàm gọi fetch\r\n    async _postSaveManual() {\r\n      const title = this.form.mapTitle.trim();\r\n      if (!title) return alert('Nhập tên sơ đồ tư duy');\r\n\r\n      // 1) Phân biệt POST / PUT\r\n      const id = this.$route.params.id;\r\n      console.log('id', id)\r\n      const isUpdate = Boolean(id);\r\n      const url = isUpdate\r\n        ? `/api/listMindmap/${id}`\r\n        : '/api/listMindmap';\r\n      const method = isUpdate ? 'PUT' : 'POST';\r\n\r\n      this.loading = true;\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) throw new Error('Chưa có token');\r\n\r\n        // 2) Xuất SVG + thumbnail\r\n        const svgMarkup = this._exportSvgMarkup();\r\n        const imageUrl = await this._generateImageFromSvg(900);\r\n\r\n        // 3) Chuẩn hóa manualData.nodes\r\n        const manualNodes = this.nodes.map(node => ({\r\n          id: node.id,\r\n          type: node.type,\r\n          x: node.left,\r\n          y: node.top,\r\n          width: node.width,\r\n          height: node.height,\r\n          text: node.text,\r\n          fontFamily: node.fontFamily,\r\n          fontSize: node.fontSize,\r\n          isBold: node.isBold,\r\n          isItalic: node.isItalic,\r\n          textColor: node.textColor,\r\n          align: node.align,\r\n          borderColor: node.borderColor,\r\n          borderWidth: node.borderWidth,\r\n          borderStyle: node.borderStyle,\r\n          backgroundColor: node.backgroundColor,\r\n          imageUrl: node.imageUrl,\r\n          rotation: node.rotation\r\n        }));\r\n\r\n        // 4) Chuẩn hóa manualData.links\r\n        const manualLinks = this.links.map(link => {\r\n          // Nếu link đã nối vào node khác (link.attachedTo != null), thì xóa toPos\r\n          if (link.attachedTo != null) {\r\n            return {\r\n              id: link.id || `${link.from}-${link.attachedTo}`,\r\n              from: link.from,\r\n              to: link.attachedTo || link.to,  // dùng `attachedTo` làm `to`\r\n              toPos: null,             // reset free‐pos\r\n              color: link.color,\r\n              thickness: link.thickness,\r\n              dash: link.dash,\r\n              curvature: link.curvature,\r\n              marker: link.marker,\r\n              custom: link.custom,\r\n              path: link.path || this.computeLinkPath(link),\r\n              text: link.text,\r\n              fontFamily: link.fontFamily,\r\n              fontSize: link.fontSize,\r\n              isBold: link.isBold,\r\n              isItalic: link.isItalic,\r\n              textColor: link.textColor,\r\n              align: link.align\r\n            };\r\n          }\r\n\r\n          // Còn nếu là free‐link (không gắn tới node), giữ nguyên toPos\r\n          return {\r\n            id: link.id || `${link.from}-free`,\r\n            from: link.from,\r\n            to: null,\r\n            toPos: link.toPos ? { x: link.toPos.x, y: link.toPos.y } : undefined,\r\n            color: link.color,\r\n            thickness: link.thickness,\r\n            dash: link.dash,\r\n            curvature: link.curvature,\r\n            marker: link.marker,\r\n            custom: link.custom,\r\n            path: link.path || this.computeLinkPath(link),\r\n            text: link.text,\r\n            fontFamily: link.fontFamily,\r\n            fontSize: link.fontSize,\r\n            isBold: link.isBold,\r\n            isItalic: link.isItalic,\r\n            textColor: link.textColor,\r\n            align: link.align\r\n          };\r\n        });\r\n\r\n        // 5) Build payload (có thêm title, type, mapType)\r\n        const payload = {\r\n          title,\r\n          type: 'manual',\r\n          mapType: 'free',\r\n          svgMarkup,\r\n          imageUrl,\r\n          manualData: {\r\n            nodes: manualNodes,\r\n            links: manualLinks\r\n          }\r\n        };\r\n\r\n        console.log('PAYLOAD:', payload);\r\n\r\n        // 6) Gọi API\r\n        const resp = await fetch(url, {\r\n          method,\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${token}`\r\n          },\r\n          body: JSON.stringify(payload)\r\n        });\r\n\r\n        const data = await resp.json();\r\n        if (!resp.ok) {\r\n          throw new Error(data.message || 'Lưu thất bại');\r\n        }\r\n\r\n        alert(isUpdate ? 'Cập nhật thành công!' : 'Lưu thành công!');\r\n\r\n        // 7) Nếu là cập nhật, đè lại nodes/links từ server (tuỳ bạn có cần)\r\n        if (isUpdate && data.manualData) {\r\n          this.nodes = data.manualData.nodes.map(n => ({\r\n            ...n,\r\n            left: n.x,\r\n            top: n.y\r\n          }));\r\n          this.links = data.manualData.links;\r\n        }\r\n\r\n        this.closeModal();\r\n      }\r\n      catch (e) {\r\n        console.error(e);\r\n        alert('Lỗi khi lưu: ' + e.message);\r\n      }\r\n      finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    drawMindMap() {\r\n      const svg = d3.select(this.$refs.canva);\r\n      svg.selectAll('path.link').remove();\r\n      svg.selectAll('g.node').remove();\r\n\r\n      if (this.selectedMapType === 'manual') {\r\n        this.drawFreeMap(svg, this.mindmapObject);\r\n      } else {\r\n        // gọi đúng hàm AI-layout\r\n        const fn = {\r\n          bubble: this.drawBubbleMap,\r\n          tree: this.drawTreeMap,\r\n          flow: this.drawFlowMap,\r\n          multiFlow: this.drawMultiFlowMap,\r\n          brace: this.drawBraceMap\r\n        }[this.selectedMapType];\r\n        fn.call(this, svg, this.mindmapObject);\r\n      }\r\n    },\r\n    findNode(id, nodes) {\r\n      return nodes.find(n => n.id === id) || { x: 0, y: 0 };\r\n    },\r\n    drawTreeMap(svg, treeData) {\r\n      if (!treeData) return;\r\n\r\n      // 1) Normalize dữ liệu\r\n      let hierarchicalData;\r\n      if (treeData.root !== undefined && Array.isArray(treeData.branches)) {\r\n        hierarchicalData = {\r\n          id: 'root',\r\n          name: typeof treeData.root === 'string' ? treeData.root : '',\r\n          children: treeData.branches.map(br => ({\r\n            id: `b:${br.title}`,\r\n            name: typeof br.title === 'string' ? br.title : '',\r\n            children: Array.isArray(br.subBranches)\r\n              ? br.subBranches.map(sb => ({\r\n                id: `b:${br.title}|s:${sb}`,\r\n                name: typeof sb === 'string' ? sb : '',\r\n                children: []\r\n              }))\r\n              : []\r\n          }))\r\n        };\r\n      } else {\r\n        hierarchicalData = treeData;\r\n      }\r\n\r\n      // 2) Lấy kích thước SVG & tâm\r\n      const w = svg.node().clientWidth;\r\n      const h = svg.node().clientHeight;\r\n      const cx = w / 2;\r\n      const cy = h / 4;\r\n      // bán kính tối đa mà cluster sẽ vẽ (phần yOffset tối đa)\r\n      const radius = Math.min(w, h) / 2 - 80;\r\n      const padH = 12;\r\n\r\n      // 3) D3‐hierarchy + cluster\r\n      const root = d3.hierarchy(hierarchicalData, d => d.children || []);\r\n      d3.cluster().size([2 * Math.PI, radius])(root);\r\n\r\n      // 4) Tính yOffset theo depth\r\n      //    → Thêm extraLength cho tất cả node depth >= 1\r\n      const extraLength = 80; // số pixel muốn kéo dài thêm cho mọi link\r\n      root.descendants()\r\n        .sort((a, b) => a.depth - b.depth)\r\n        .forEach(d => {\r\n          if (d.depth === 0) {\r\n            d.yOffset = 0;\r\n          } else {\r\n            const parentOffset = typeof d.parent.yOffset === 'number'\r\n              ? d.parent.yOffset\r\n              : 0;\r\n            // yOffset căn bản = offset của parent + width(text) + padH\r\n            let baseOffset = parentOffset + this.textWidth(d.data.name || '') + padH;\r\n\r\n            // Nếu node depth >= 1, cộng thêm extraLength\r\n            baseOffset += extraLength;\r\n\r\n            d.yOffset = baseOffset;\r\n          }\r\n        });\r\n\r\n      // 5) Build newNodes và gán this.nodes\r\n      //    → Chỉ vẽ circle cho node depth === 0 (root), bỏ qua node depth > 0\r\n      const newNodes = [];\r\n      root.descendants().forEach(d3node => {\r\n        if (d3node.depth !== 0) {\r\n          return; // bỏ qua tất cả node con\r\n        }\r\n\r\n        // Với d3node.depth === 0 (root), tính rDyn và tọa độ giống cũ\r\n        const name = d3node.data.name || '';\r\n        const words = name.split(/\\s+/);\r\n        const lines = [];\r\n        for (let i = 0; i < words.length; i += 3) {\r\n          lines.push(words.slice(i, i + 3).join(' '));\r\n        }\r\n        const fontSize = 16; // font size cho root cố định\r\n        const maxW = lines.length\r\n          ? Math.max(...lines.map(l => this.textWidth(l, `${fontSize}px Arial`)))\r\n          : 0;\r\n        const rMin = 50;      // bán kính tối thiểu cho root\r\n        const rDyn = Math.max(rMin, maxW / 2 + padH);\r\n\r\n        // Tính tọa độ của root\r\n        const theta = (typeof d3node.x === 'number' ? d3node.x : 0) - Math.PI / 2;\r\n        const r = typeof d3node.yOffset === 'number' ? d3node.yOffset : 0;\r\n        const xCenter = cx + r * Math.cos(theta);\r\n        const yCenter = cy + r * Math.sin(theta);\r\n\r\n        const data = d3node.data;\r\n        const bg = data.backgroundColor || '#ffffff';\r\n        const bc = data.borderColor || '#333333';\r\n        const bw = data.borderWidth != null ? data.borderWidth : 2;\r\n        const bs = data.borderStyle || 'solid';\r\n        const tc = data.textColor || '#000000';\r\n        const ff = data.fontFamily || 'Arial';\r\n        const ib = true;                     // root luôn in đậm\r\n        const ii = !!data.isItalic;\r\n        const iu = data.imageUrl || null;\r\n\r\n        newNodes.push({\r\n          id: data.id,\r\n          type: 'circle',\r\n          top: isNaN(yCenter - rDyn + 30) ? cy - rDyn + 30 : yCenter - rDyn + 30,\r\n          left: isNaN(xCenter - rDyn + 5) ? cx - rDyn + 5 : xCenter - rDyn + 5,\r\n          width: isNaN(rDyn * 1.5) ? 0 : rDyn * 1.5,\r\n          height: isNaN(rDyn) ? 0 : rDyn,\r\n          rotation: 0,\r\n          text: name,     // bạn có thể để trống ('') nếu không muốn hiển thị text cho root\r\n          fontFamily: ff,\r\n          fontSize: fontSize,\r\n          isBold: ib,\r\n          isItalic: ii,\r\n          textColor: tc,\r\n          align: 'center',\r\n          borderColor: bc,\r\n          backgroundColor: bg,\r\n          borderWidth: bw,\r\n          borderStyle: bs,\r\n          imageUrl: iu\r\n        });\r\n      });\r\n      this.nodes = newNodes;\r\n\r\n      // 6) Build newLinks và gán this.links\r\n      //    → Độ dày (thickness) giữ nguyên: 8px cho link cấp 1, 2px cho link cấp >1\r\n      //    → text: tên của node đích\r\n      const linkGen = d3.linkRadial()\r\n        .angle(d => (typeof d.x === 'number' ? d.x : 0))\r\n        .radius(d => (typeof d.yOffset === 'number' ? d.yOffset : 0));\r\n\r\n      const newLinks = root.links().map((d3link, idx) => {\r\n        // 6a) Tạo path radial gốc (d3-format)\r\n        let basePath = '';\r\n        try {\r\n          basePath = linkGen(d3link) || '';\r\n        } catch {\r\n          basePath = '';\r\n        }\r\n\r\n        // 6b) Chuyển sang toạ độ tuyệt đối (cộng cx, cy)\r\n        let absolutePath = '';\r\n        if (basePath) {\r\n          absolutePath = basePath.replace(\r\n            /(-?\\d+(\\.\\d+)?),(-?\\d+(\\.\\d+)?)/g,\r\n            (_, x, __, y) => {\r\n              const xi = parseFloat(x);\r\n              const yi = parseFloat(y);\r\n              if (isNaN(xi) || isNaN(yi)) {\r\n                return `${cx},${cy}`;\r\n              }\r\n              return `${xi + cx},${yi + cy}`;\r\n            }\r\n          );\r\n        }\r\n\r\n        // 6c) Xác định độ dày\r\n        const isLevel1 = (d3link.source.depth === 0 && d3link.target.depth === 1);\r\n        const thicknessValue = isLevel1\r\n          ? 8   // giữ 8px cho level 1\r\n          : (d3link.source.depth === 0 ? 8 : 2);\r\n\r\n        return {\r\n          id: `link-${idx}`,\r\n          from: d3link.source.data.id,\r\n          to: d3link.target.data.id,\r\n          color: 'aqua',\r\n          thickness: thicknessValue,\r\n          dash: this.linkDash || [],\r\n          marker: 'radial',\r\n          path: absolutePath,\r\n          text: d3link.target.data.name || '', // Nội dung chữ dọc theo link\r\n          fontSize: isLevel1 ? 14 : 12,\r\n          textColor: '#333',\r\n          fontFamily: 'Arial',\r\n          isBold: isLevel1,\r\n          isItalic: false,\r\n          align: 'middle'\r\n        };\r\n      });\r\n      this.links = newLinks;\r\n\r\n      // 7) Reset selection\r\n      this.selectedNode = null;\r\n      this.selectedLink = null;\r\n\r\n      // 8) Xóa SVG cũ để Vue re‐render lại\r\n      svg.selectAll('*').remove();\r\n    },\r\n\r\n    wrapText(textSel, maxWidth, lineHeight = 1.2) {\r\n      textSel.each(function () {\r\n        const text = d3.select(this);\r\n        const words = text.text().split(/\\s+/);\r\n        text.text(null);\r\n\r\n        let line = [];\r\n        const x = text.attr('x');\r\n        const y = text.attr('y');\r\n        const dy = parseFloat(text.attr('dy')) || 0;\r\n\r\n        // tspan đầu\r\n        let tspan = text.append('tspan')\r\n          .attr('x', x)\r\n          .attr('y', y)\r\n          .attr('dy', `${dy}em`);\r\n\r\n        for (let i = 0; i < words.length; i++) {\r\n          line.push(words[i]);\r\n          tspan.text(line.join(' '));\r\n          if (tspan.node().getComputedTextLength() > maxWidth && line.length > 1) {\r\n            // bỏ từ cuối ra dòng kế\r\n            line.pop();\r\n            tspan.text(line.join(' '));\r\n            line = [words[i]];\r\n            tspan = text.append('tspan')\r\n              .attr('x', x)\r\n              .attr('y', y)\r\n              .attr('dy', `${lineHeight}em`)\r\n              .text(words[i]);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    chunkText(text, wordsPerLine = 3) {\r\n      const words = text.split(/\\s+/);\r\n      const lines = [];\r\n      for (let i = 0; i < words.length; i += wordsPerLine) {\r\n        lines.push(words.slice(i, i + wordsPerLine).join(' '));\r\n      }\r\n      return lines;\r\n    },\r\n    drawBubbleMap(svg, treeData) {\r\n      if (!treeData || !treeData.root) {\r\n        console.error('Invalid treeData!', treeData);\r\n        return;\r\n      }\r\n      const vm = this;\r\n\r\n      // --- Build plain JS tree với .name, .id, .children ---\r\n      const rootObj = {\r\n        id: 'root',\r\n        name: treeData.root,\r\n        children: treeData.branches.map(br => ({\r\n          id: `b:${br.title}`,\r\n          name: br.title,\r\n          children: br.subBranches.map(sb => ({\r\n            id: `b:${br.title}|s:${sb}`,\r\n            name: sb\r\n          }))\r\n        }))\r\n      };\r\n      const root = d3.hierarchy(rootObj, d => d.children || []);\r\n\r\n      // --- Layout đệ quy tính x,y,rDyn,fontSize, style defaults ---\r\n      const w = svg.node().clientWidth, h = svg.node().clientHeight;\r\n      const cx = w / 2, cy = h / 4;\r\n      const padH = 8, linkLen1 = 120, linkLen2Base = 60, extraLeaf = 60;\r\n      function layout(node, x, y, depth, baseAngle) {\r\n        // tách chữ, tính rDyn, fontSize...\r\n        const words = node.data.name.split(/\\s+/);\r\n        const lines = [];\r\n        for (let i = 0; i < words.length; i += 3)\r\n          lines.push(words.slice(i, i + 3).join(' '));\r\n        const fontSize = depth === 0 ? 14 : depth === 1 ? 12 : 10;\r\n        const font = `${fontSize}px sans-serif`;\r\n        const maxW = Math.max(...lines.map(l => vm.textWidth(l, font)));\r\n        const rDyn = Math.max(depth === 0 ? 80 : 40, maxW / 2 + padH);\r\n\r\n        // gán tọa độ + style mặc định\r\n        node.data.x = x;\r\n        node.data.y = y;\r\n        node.data.rDyn = rDyn;\r\n        node.data.fontSize = fontSize;\r\n        node.data.fill ||= depth === 0 ? 'aqua' : '#fff';\r\n        node.data.stroke ||= depth === 0 ? '#333' : '#007bff';\r\n        node.data.strokeWidth ||= depth === 0 ? 2 : 1.5;\r\n        node.data.textColor ||= '#000';\r\n        node.data.fontFamily ||= 'sans-serif';\r\n        node.data.isBold = !!node.data.isBold;\r\n        node.data.isItalic = !!node.data.isItalic;\r\n        node.data.borderColor ||= node.data.stroke;\r\n        node.data.borderWidth ||= node.data.strokeWidth;\r\n        node.data.borderStyle ||= 'solid';\r\n        node.data.backgroundColor ||= node.data.fill;\r\n\r\n        // layout con\r\n        const kids = node.children || [];\r\n        if (!kids.length) return;\r\n        const Nroot = root.children.length;\r\n        const radSector = 2 * Math.PI / Nroot;\r\n\r\n        if (depth === 0) {\r\n          kids.forEach((kid, i) => {\r\n            const θ = -Math.PI / 2 + radSector / 2 + i * radSector;\r\n            const len = linkLen1;\r\n            layout(kid, x + Math.cos(θ) * (rDyn + len), y + Math.sin(θ) * (rDyn + len), 1, θ);\r\n          });\r\n        } else {\r\n          const startAng = baseAngle - radSector / 2;\r\n          kids.forEach((kid, i) => {\r\n            const θ = startAng + radSector * (i / ((kids.length - 1) || 1));\r\n            let len = linkLen2Base + (kids.length - 1) * 20;\r\n            if (!kid.children?.length) len += extraLeaf;\r\n            layout(kid, x + Math.cos(θ) * (rDyn + len), y + Math.sin(θ) * (rDyn + len), depth + 1, θ);\r\n          });\r\n        }\r\n      }\r\n      layout(root, cx, cy, 0, 0);\r\n\r\n      // --- Build Vue arrays ---\r\n      // 1) Nodes\r\n      const nodes = root.descendants().map(d3n => ({\r\n        id: d3n.data.id,\r\n        type: d3n.data.type || 'circle',\r\n        text: d3n.data.name,\r\n        left: d3n.data.x - d3n.data.rDyn,\r\n        top: d3n.data.y - d3n.data.rDyn,\r\n        width: d3n.data.rDyn * 2,\r\n        height: d3n.data.rDyn * 2,\r\n        rotation: 0,\r\n        backgroundColor: d3n.data.backgroundColor,\r\n        borderColor: d3n.data.borderColor,\r\n        borderWidth: d3n.data.borderWidth,\r\n        borderStyle: d3n.data.borderStyle,\r\n        textColor: d3n.data.textColor,\r\n        fontSize: d3n.data.fontSize,\r\n        fontFamily: d3n.data.fontFamily,\r\n        isBold: d3n.data.isBold,\r\n        isItalic: d3n.data.isItalic\r\n      }));\r\n\r\n      // 2) Links: parent → each child\r\n      const links = [];\r\n      root.descendants().forEach(d3n => {\r\n        if (d3n.parent) {\r\n          links.push({\r\n            from: d3n.parent.data.id,\r\n            to: d3n.data.id,\r\n            marker: 'none',\r\n            color: '#333',\r\n            thickness: 1.5,\r\n            curvature: 0,\r\n            dash: 'solid'\r\n          });\r\n        }\r\n      });\r\n\r\n      // 3) Gán state\r\n      vm.nodes = nodes;\r\n      vm.links = links;\r\n    },\r\n    drawFreeMap(svg) {\r\n      console.count('drawFreeMap called');\r\n      const vm = this;\r\n      // 0) Lấy rawData (đã đổ từ mounted):\r\n      const rawData = vm.mindmapObject || { nodes: [], links: [] };\r\n\r\n      // 1) Map rawData.nodes → this.nodes (để Vue template tự render <div class=\"node\">)\r\n      vm.nodes = (rawData.nodes || []).map(n => ({\r\n        id: String(n.id),                // QUAN TRỌNG: ép thành string\r\n        type: n.type || 'rectangle', // ví dụ\r\n        left: Number(n.x) || 0,          // CSS left\r\n        top: Number(n.y) || 0,          // CSS top\r\n        width: Number(n.width) || 120,\r\n        height: Number(n.height) || 80,\r\n        rotation: Number(n.rotation) || 0,\r\n        text: String(n.text || '').replace(/<[^>]+>/g, ''),\r\n        fontFamily: n.fontFamily || 'Arial',\r\n        fontSize: Number(n.fontSize) || 14,\r\n        isBold: !!n.isBold,\r\n        isItalic: !!n.isItalic,\r\n        textColor: n.textColor || '#000000',\r\n        align: n.align || 'center',\r\n        borderColor: n.borderColor || '#000000',\r\n        backgroundColor: n.backgroundColor || '#ffffff',\r\n        borderWidth: Number(n.borderWidth) || 1,\r\n        borderStyle: n.borderStyle || 'solid',\r\n        imageUrl: n.imageUrl || null,\r\n        custom: n.custom || null\r\n        // … nếu còn trường khác, hãy bổ sung tương tự …\r\n      }));\r\n      console.log('this.nodes = ', this.nodes.map(n => n.id));\r\n      // 2) Map rawData.links → this.links (normalize to/toPos)\r\n      const links = (rawData.links || []).map(l => {\r\n        // QUAN TRỌNG: Ép from, to thành string để match với node.id\r\n        const fromId = String(l.from);\r\n        const toId = (l.to != null && String(l.to) !== '')\r\n          ? String(l.to)\r\n          : null;\r\n\r\n        if (toId) {\r\n          // Link node→node: ép toPos = null\r\n          return {\r\n            id: String(l.id || `${fromId}-${toId}-${Date.now()}`),\r\n            from: fromId,\r\n            to: toId,\r\n            toPos: null,\r\n            attachedTo: toId || null,\r\n            color: l.color || '#000000',\r\n            thickness: Number(l.thickness) || 2,\r\n            dash: l.dash || 'solid',\r\n            curvature: Number(l.curvature) || 0,\r\n            marker: l.marker || 'none',\r\n            custom: l.custom || null,\r\n            path: l.path || '',\r\n            text: l.text || '',\r\n            fontFamily: l.fontFamily || 'Arial',\r\n            fontSize: Number(l.fontSize) || 14,\r\n            isBold: !!l.isBold,\r\n            isItalic: !!l.isItalic,\r\n            textColor: l.textColor || '#000',\r\n            align: l.align || 'middle'\r\n          };\r\n        } else {\r\n          // Free‐link: giữ nguyên toPos\r\n          const x = l.toPos && Number(l.toPos.x) != null ? Number(l.toPos.x) : 0;\r\n          const y = l.toPos && Number(l.toPos.y) != null ? Number(l.toPos.y) : 0;\r\n          return {\r\n            id: String(l.id || `${fromId}-free-${Math.round(x)}_${Math.round(y)}`),\r\n            from: fromId,\r\n            to: null,\r\n            toPos: { x, y },\r\n            attachedTo: null,\r\n            color: l.color || '#000000',\r\n            thickness: Number(l.thickness) || 2,\r\n            dash: l.dash || 'solid',\r\n            curvature: Number(l.curvature) || 0,\r\n            marker: l.marker || 'none',\r\n            custom: l.custom || null,\r\n            path: l.path || '',\r\n            text: l.text || '',\r\n            fontFamily: l.fontFamily || 'Arial',\r\n            fontSize: Number(l.fontSize) || 14,\r\n            isBold: !!l.isBold,\r\n            isItalic: !!l.isItalic,\r\n            textColor: l.textColor || '#000',\r\n            align: l.align || 'middle'\r\n          };\r\n        }\r\n      });\r\n      vm.links = links;\r\n      console.log(vm.links)\r\n      // 3) Đợi Vue build xong DOM <div class=\"node\"> với left/top/…,\r\n      //    đồng thời Vue template cũng build các <g v-for=\"link in links\">…\r\n      vm.$nextTick(() => {\r\n        svg.selectAll('g.link-group').remove();\r\n        // 4) Xóa tạm bất kỳ phần tử link do D3 cũ (nếu bạn từng append vào SVG)\r\n        svg.selectAll('path.link').remove();\r\n        svg.selectAll('circle.link-handle').remove();\r\n\r\n        // *** Không vẽ gì thêm ở đây, vì Vue template đã chịu trách nhiệm render link ***\r\n      });\r\n    },\r\n    // Hàm phụ để tính lại path khi drag node\r\n    computeLinkPath(link) {\r\n      // 1) Build map id→node ngay trong hàm\r\n      const nodesById = Object.fromEntries(\r\n        this.nodes.map(n => [n.id, n])\r\n      );\r\n\r\n      // 2) Lấy node nguồn\r\n      const s = nodesById[link.from];\r\n      // 3) Lấy node đích: nếu link.to tồn tại thì dùng node, còn không tạo object tạm từ toPos\r\n      const t = link.to != null && nodesById[link.to]\r\n        ? nodesById[link.to]\r\n        : { left: link.toPos?.x, top: link.toPos?.y, width: 0, height: 0 };\r\n\r\n      // 4) Nếu bất kỳ giá trị left/top không phải số thì thôi\r\n      if (!s || !t || isNaN(s.left) || isNaN(s.top) || isNaN(t.left) || isNaN(t.top)) {\r\n        console.warn('computeLinkPath: missing data for', link, s, t);\r\n        return '';\r\n      }\r\n\r\n      // 5) Tính tâm 2 node\r\n      const x1 = s.left + s.width / 2;\r\n      const y1 = s.top + s.height / 2;\r\n      const x2 = t.left + t.width / 2;\r\n      const y2 = t.top + t.height / 2;\r\n\r\n      // 6) Tạo control point cho curve\r\n      const dx = x2 - x1, dy = y2 - y1;\r\n      const cpx = x1 + dx / 2 - dy * (link.curvature || 0);\r\n      const cpy = y1 + dy / 2 + dx * (link.curvature || 0);\r\n\r\n      // 7) Trả về path SVG (quadratic Bézier)\r\n      return `M${x1},${y1} Q${cpx},${cpy} ${x2},${y2}`;\r\n    },\r\n    _findNode(id, nodes) {\r\n      const n = nodes.find(n => n.id === id);\r\n      if (!n) {\r\n        console.error(`_findNode: cannot find node with id=\"${id}\"`, nodes);\r\n        return { x: 0, y: 0 };\r\n      }\r\n      return n;\r\n    },\r\n    buildHierarchy(treeData) {\r\n      const raw = {\r\n        name: treeData.root,\r\n        fill: treeData.fill,       // root cũng có thể có màu\r\n        stroke: treeData.stroke,\r\n        children: (treeData.branches || []).map(b => ({\r\n          name: b.title,\r\n          fill: b.fill,            // lấy màu gốc\r\n          stroke: b.stroke,\r\n          children: (b.subBranches || []).map(sb => ({\r\n            name: sb.name || sb,\r\n            fill: sb.fill,\r\n            stroke: sb.stroke\r\n          }))\r\n        }))\r\n      };\r\n      const root = d3.hierarchy(raw, d => d.children);\r\n      let id = 0;\r\n      root.each(d => {\r\n        d.data.id = id++;\r\n        // khởi màu từ JSON, nếu không có mới fallback\r\n        d.data.backgroundColor = d.data.fill != null\r\n          ? d.data.fill\r\n          : this.defaultNodeBackgroundColor;\r\n        d.data.borderColor = d.data.stroke != null\r\n          ? d.data.stroke\r\n          : this.defaultNodeBorderColor;\r\n        d.data.borderWidth = this.defaultNodeBorderThickness;\r\n        d.data.borderStyle = this.defaultNodeBorderStyle;\r\n        d.data.textColor = d.data.textColor ?? '#333';\r\n        d.data.borderWidth = d.data.borderWidth ?? (d.depth === 0 ? 2 : 1.5);\r\n      });\r\n      return root;\r\n    },\r\n    textWidth(text) {\r\n      const ctx = document.createElement('canvas').getContext('2d');\r\n      ctx.font = '12px sans-serif';\r\n      return ctx.measureText(text).width;\r\n    },\r\n    drawFlowMap(svg, treeData) {\r\n      const vm = this;\r\n\r\n      // 1) Đo SVG và tính tâm\r\n      const svgNode = svg.node();\r\n      if (!svgNode) {\r\n        console.error('SVG chưa sẵn sàng!');\r\n        return;\r\n      }\r\n      const width = svgNode.clientWidth;\r\n      const height = svgNode.clientHeight;\r\n      const cx = width / 4;\r\n      const cy = height / 2;\r\n\r\n      // 2) Build cây JS thô\r\n      console.log('treeData:', treeData);\r\n      const rootObj = {\r\n        id: 'root',\r\n        name: treeData.root || '',\r\n        children: (treeData.branches || []).map(br => ({\r\n          id: `b:${br.title}`,\r\n          name: br.title,\r\n          children: (br.subBranches || []).map(sb => ({\r\n            id: `b:${br.title}|s:${sb}`,\r\n            name: sb\r\n          }))\r\n        }))\r\n      };\r\n      console.log('rootObj:', rootObj);\r\n\r\n      // 3) D3 hierarchy + tree layout\r\n      const root = d3.hierarchy(rootObj, d => d.children || []);\r\n      d3.tree()\r\n        .nodeSize([70, 300])\r\n        .separation((a, b) => a.parent === b.parent ? 1 : 2)(root);\r\n\r\n      // 4) Tính offset để root về giữa\r\n      const rootX = Number(root.x) || 0;\r\n      const rootY = Number(root.y) || 0;\r\n      const offsetX = cx - rootY;\r\n      const offsetY = cy - rootX;\r\n      console.log({ rootX, rootY, offsetX, offsetY });\r\n\r\n      // 5) Khởi tạo link generator\r\n      const linkGen = d3.linkHorizontal()\r\n        .x(d => ((Number(d.y) || 0)) + offsetX)\r\n        .y(d => (Number(d.x) || 0) + offsetY);\r\n      // 6) Helper đo text width\r\n      const ctx = vm._canvasCtx || (vm._canvasCtx = document.createElement('canvas').getContext('2d'));\r\n      function textWidth(text, size, bold = false) {\r\n        ctx.font = (bold ? 'bold ' : '') + size + 'px Arial';\r\n        return ctx.measureText(text).width;\r\n      }\r\n\r\n      // 7) Build vm.nodes (thêm left/top cho DIV, x/y cho SVG)\r\n      vm.nodes = root.descendants().map(d => {\r\n        const depth = d.depth;\r\n        const isRoot = depth === 0;\r\n        const text = d.data.name;\r\n        const fontSize = Math.max(14 - depth * 2, 10);\r\n        const wText = textWidth(text, fontSize, isRoot);\r\n\r\n        const widthNode = isRoot ? wText + 40 : wText + 20;\r\n        const heightNode = isRoot ? wText + 40 : fontSize * 1.5;\r\n\r\n        const rawX = Number(d.y);\r\n        const rawY = Number(d.x);\r\n        const x = (isNaN(rawX) ? 0 : rawX) + offsetX;\r\n        const y = (isNaN(rawY) ? 0 : rawY) + offsetY;\r\n\r\n        return {\r\n          id: d.data.id,\r\n          type: isRoot ? 'circle' : 'rectangle',\r\n          x,                // dùng cho <circle cx,cy> hoặc draw SVG\r\n          y,\r\n          left: x, // dùng cho <div style=\"left:…, top:…\">\r\n          top: y,\r\n          width: widthNode * 1.5,\r\n          height: heightNode * 1.5,\r\n          rotation: 0,\r\n          text,\r\n          fontFamily: 'Arial',\r\n          fontSize: isRoot ? 20 : 14,\r\n          isBold: isRoot,\r\n          isItalic: false,\r\n          textColor: '#000000',\r\n          align: 'center',\r\n          borderColor: '#000',\r\n          backgroundColor: 'aqua',\r\n          borderWidth: 1,\r\n          borderStyle: 'solid',\r\n          imageUrl: null\r\n        };\r\n      });\r\n      console.log('nodes:', vm.nodes);\r\n\r\n      // 8) Build vm.links\r\n      vm.links = root.links().map((link, i) => ({\r\n        id: `l${i}`,\r\n        from: link.source.data.id,\r\n        to: link.target.data.id,\r\n        toPos: null,\r\n        color: '#0bf',\r\n        thickness: 2,\r\n        dash: 'solid',\r\n        curvature: (link.source.depth - link.target.depth) * 0.01,\r\n        marker: 'arrow',\r\n        custom: null,\r\n        path: linkGen(link),\r\n        text: '',\r\n        fontFamily: 'Arial',\r\n        fontSize: 12,\r\n        isBold: false,\r\n        isItalic: false,\r\n        textColor: '#000000',\r\n        align: 'middle'\r\n      }));\r\n      console.log('links:', vm.links);\r\n    },\r\n    drawMultiFlowMap(svg, treeData) {\r\n      const vm = this;\r\n      const svgEl = svg.node();\r\n      if (!svgEl) return;\r\n      const W = svgEl.clientWidth, H = svgEl.clientHeight;\r\n      const cx = W / 1.8, cy = H / 4;\r\n\r\n      // 1) build rootObj\r\n      const rootObj = {\r\n        id: 'root',\r\n        name: treeData.root || '',\r\n        children: (treeData.branches || []).map(br => ({\r\n          id: `b:${br.title}`,\r\n          name: br.title,\r\n          children: (br.subBranches || []).map(sb => ({\r\n            id: `b:${br.title}|s:${sb}`,\r\n            name: sb\r\n          }))\r\n        }))\r\n      };\r\n\r\n      // 2) full-tree layout\r\n      const root = d3.hierarchy(rootObj, d => d.children);\r\n      d3.tree().nodeSize([80, 100]).separation((a, b) => a.parent === b.parent ? 1 : 2)(root);\r\n\r\n      // 3) offset to center\r\n      const oX = cx - root.y, oY = cy - root.x;\r\n\r\n      // 4) textWidth helper\r\n      const ctx = vm._txtCtx ||= document.createElement('canvas').getContext('2d');\r\n      function textWidth(txt, size, bold = false) {\r\n        ctx.font = `${bold ? 'bold ' : ''}${size}px Arial`;\r\n        return ctx.measureText(txt).width;\r\n      }\r\n\r\n      // 5) linkGen\r\n      const linkGen = d3.linkHorizontal()\r\n        .x(d => d.y + oX)\r\n        .y(d => d.x + oY);\r\n\r\n      // 6) reset arrays\r\n      vm.nodes = [];\r\n      vm.links = [];\r\n\r\n      // 7) add root node\r\n      const baseSize = 20;\r\n      const w0 = Math.min(200, textWidth(rootObj.name, baseSize, true));\r\n      const r0 = w0 / 2 + 20;\r\n      vm.nodes.push({\r\n        id: rootObj.id,\r\n        type: 'circle',\r\n        x: oX,\r\n        y: oY,\r\n        left: oX,\r\n        top: oY,\r\n        width: r0 * 2,\r\n        height: r0 * 2,\r\n        text: rootObj.name,\r\n        fontFamily: 'Arial',\r\n        fontSize: baseSize,\r\n        isBold: true,\r\n        isItalic: false,\r\n        textColor: '#000',\r\n        align: 'center',\r\n        borderColor: '#000',\r\n        backgroundColor: 'aqua',\r\n        borderWidth: 1,\r\n        borderStyle: 'solid',\r\n        imageUrl: null\r\n      });\r\n\r\n      // 8) split children into left/right\r\n      const kids = rootObj.children;\r\n      const midIdx = Math.ceil(kids.length / 2);\r\n      const leftKids = kids.slice(0, midIdx);\r\n      const rightKids = kids.slice(midIdx);\r\n\r\n      // 9) makeSub đưa vào cả id và name\r\n      const makeSub = arr => d3.hierarchy(\r\n        { id: rootObj.id, name: rootObj.name, children: arr },\r\n        d => d.children\r\n      );\r\n\r\n      const leftRoot = makeSub(leftKids);\r\n      const rightRoot = makeSub(rightKids);\r\n      d3.tree().nodeSize([80, 300]).separation((a, b) => a.parent === b.parent ? 1 : 2)(leftRoot);\r\n      d3.tree().nodeSize([80, 330]).separation((a, b) => a.parent === b.parent ? 1 : 2)(rightRoot);\r\n\r\n      // 10) compute mid-Y for centering each half\r\n      const Ys = R => R.descendants().map(d => d.x);\r\n      const midY = arr => (Math.min(...arr) + Math.max(...arr)) / 2;\r\n      const lMid = midY(Ys(leftRoot));\r\n      const rMid = midY(Ys(rightRoot));\r\n\r\n      // 11) collect links & nodes for each half\r\n      function collect(subRoot, mid, flip) {\r\n        // links\r\n        subRoot.links().forEach((l, i) => {\r\n          const sx = l.source.x - mid;\r\n          const sy = l.source.y + (l.source.depth === 0 ? (flip ? -r0 : r0) : 0);\r\n          const tx = l.target.x - mid;\r\n          const ty = l.target.y;\r\n          vm.links.push({\r\n            id: `link_${flip ? 'L' : 'R'}_${i}`,\r\n            from: l.source.data.id,  // now always defined\r\n            to: l.target.data.id,\r\n            toPos: null,\r\n            color: 'aqua',\r\n            thickness: 2,\r\n            dash: 'solid',\r\n            curvature: 0,\r\n            marker: 'arrow',\r\n            custom: null,\r\n            path: linkGen({ source: { x: sx, y: sy }, target: { x: tx, y: ty } }),\r\n            text: '',\r\n            fontFamily: 'Arial',\r\n            fontSize: 14,\r\n            isBold: false,\r\n            isItalic: false,\r\n            textColor: '#000',\r\n            align: 'middle'\r\n          });\r\n        });\r\n\r\n        // nodes (excluding root)\r\n        subRoot.descendants().slice(1).forEach(d => {\r\n          let vy = d.x - mid;\r\n          let hx = d.y + (d.depth === 1 ? (flip ? -100 : 100) : 0);\r\n          if (flip) hx = -hx;\r\n          const txt = d.data.name;\r\n          const fs = Math.max(12 - d.depth * 2, 10);\r\n          const w = textWidth(txt, fs);\r\n          const hw = w + 20;\r\n          const hh = fs * 1.2 + 8;\r\n          const x = hx + oX;\r\n          const y = vy + oY + 50;\r\n          vm.nodes.push({\r\n            id: d.data.id,\r\n            type: 'rectangle',\r\n            x, y,\r\n            left: x,\r\n            top: y,\r\n            width: hw * 1.5,\r\n            height: hh * 1.5,\r\n            text: txt,\r\n            fontFamily: 'Arial',\r\n            fontSize: fs,\r\n            isBold: false,\r\n            isItalic: false,\r\n            textColor: '#000',\r\n            align: 'center',\r\n            borderColor: '#000',\r\n            backgroundColor: 'aqua',\r\n            borderWidth: 1,\r\n            borderStyle: 'solid',\r\n            imageUrl: null\r\n          });\r\n        });\r\n      }\r\n\r\n      collect(leftRoot, lMid, true);\r\n      collect(rightRoot, rMid, false);\r\n    },\r\n    drawBraceMap(svgSel, treeData) {\r\n      const vm = this;\r\n      const svgEl = svgSel.node();\r\n      if (!svgEl) return;\r\n      const W = svgEl.clientWidth, H = svgEl.clientHeight;\r\n      const cx = W / 0.45, cy0 = 100; // cy0 = offset-top\r\n      console.log(H)\r\n      // 1) Build rootObj thủ công\r\n      const rootObj = {\r\n        id: 'root',\r\n        name: treeData.root || '',\r\n        children: (treeData.branches || []).map(br => ({\r\n          id: `b:${br.title}`,\r\n          name: br.title,\r\n          children: (br.subBranches || []).map(sb => ({\r\n            id: `b:${br.title}|s:${sb}`,\r\n            name: sb\r\n          }))\r\n        }))\r\n      };\r\n\r\n      // 2) Tạo hierarchy\r\n      const root = d3.hierarchy(rootObj, d => d.children);\r\n\r\n      // 3) Phân cấp cố định:\r\n      const Y1 = 100;    // y của cấp 1 so với cy0\r\n      const Y2 = 150;    // y của cấp 2 so với cấp 1\r\n      const gapX1 = 800; // gap ngang giữa các node cấp 1\r\n      const gapX2 = 180;  // gap ngang giữa các node cấp 2\r\n\r\n      // Root\r\n      root.x = cx;\r\n      root.y = cy0;\r\n\r\n      // Cấp 1\r\n      (root.children || []).forEach((p, i, arr) => {\r\n        p.x = cx + (i - (arr.length - 1) / 2) * gapX1;\r\n        p.y = cy0 + Y1;\r\n      });\r\n\r\n      // Cấp 2\r\n      root.children?.forEach(p => {\r\n        (p.children || []).forEach((leaf, i, arr) => {\r\n          leaf.x = p.x + (i - (arr.length - 1) / 2) * gapX2;\r\n          leaf.y = cy0 + Y1 + Y2;\r\n        });\r\n      });\r\n\r\n      // 4) Build links\r\n      vm.links = root.links().map((d, i) => {\r\n        const sx = d.source.x, sy = d.source.y;\r\n        const tx = d.target.x, ty = d.target.y;\r\n        return {\r\n          id: `link${i}`,\r\n          from: d.source.data.id,\r\n          to: d.target.data.id,\r\n          toPos: null,\r\n          color: '#555',\r\n          thickness: 2,\r\n          dash: 'solid',\r\n          curvature: 0,\r\n          marker: 'arrow',\r\n          custom: null,\r\n          path: `M${sx},${sy}L${tx},${ty}`,\r\n          text: '',\r\n          fontFamily: 'Arial',\r\n          fontSize: 12,\r\n          isBold: false,\r\n          isItalic: false,\r\n          textColor: '#000',\r\n          align: 'middle'\r\n        };\r\n      });\r\n\r\n      // 5) textWidth helper\r\n      const ctx = vm._txtCtx ||= document.createElement('canvas').getContext('2d');\r\n      function textWidth(txt, size, bold = false) {\r\n        ctx.font = `${bold ? 'bold ' : ''}${size}px Arial`;\r\n        return ctx.measureText(txt).width;\r\n      }\r\n\r\n      // 6) Build nodes\r\n      vm.nodes = root.descendants().map(d => {\r\n        const x = d.x, y = d.y;\r\n        let fontSize, pad, strokeW;\r\n        if (d.depth === 0) { fontSize = 18; pad = 15; strokeW = 3; }\r\n        else if (d.depth === 1) { fontSize = 14; pad = 10; strokeW = 2; }\r\n        else { fontSize = 12; pad = 8; strokeW = 1; }\r\n\r\n        const text = d.data.name;\r\n        const wText = Math.min(200, textWidth(text, fontSize, d.depth === 0));\r\n        const width = wText + pad * 2;\r\n        const height = fontSize * 1.2 + pad * 2;\r\n\r\n        return {\r\n          id: d.data.id,\r\n          type: 'rectangle',\r\n          x, y,\r\n          left: x - width / 2,\r\n          top: y - height / 2,\r\n          width, height,\r\n          rotation: 0,\r\n          text,            // 1 line\r\n          fontFamily: 'Arial',\r\n          fontSize,\r\n          isBold: d.depth === 0,\r\n          isItalic: false,\r\n          textColor: '#000',\r\n          align: 'center',\r\n          borderColor: 'purple',\r\n          backgroundColor: '#fff',\r\n          borderWidth: strokeW,\r\n          borderStyle: 'solid',\r\n          imageUrl: null\r\n        };\r\n      });\r\n    },\r\n    selectTemplate(key) {\r\n      const tpl = this.templates.find(t => t.key === key)\r\n      if (!tpl) return\r\n      this.selectedTemplate = tpl\r\n      this.nodes = JSON.parse(JSON.stringify(tpl.nodes)),\r\n        this.links = JSON.parse(JSON.stringify(tpl.links))\r\n    },\r\n    zoomIn() {\r\n      this.scale = Math.min(this.scale + this.scaleStep, this.maxScale);\r\n      this.pushHistory()\r\n    },\r\n    zoomOut() {\r\n      this.scale = Math.max(this.scale - this.scaleStep, this.minScale);\r\n      this.pushHistory()\r\n    },\r\n    onWheel(e) {\r\n      if (e.deltaY > 0) {\r\n        this.zoomOut();\r\n      } else {\r\n        this.zoomIn();\r\n      }\r\n      this.pushHistory()\r\n    },\r\n    // UNDO / REDO\r\n    pushHistory() {\r\n      // đảm bảo nodes/links luôn là mảng\r\n      const nodes = Array.isArray(this.nodes) ? this.nodes : [];\r\n      const links = Array.isArray(this.links) ? this.links : [];\r\n\r\n      // truncate forward\r\n      this.history.splice(this.historyIndex + 1);\r\n\r\n      // deep clone current state\r\n      const snapshot = {\r\n        nodes: JSON.parse(JSON.stringify(nodes)),\r\n        links: JSON.parse(JSON.stringify(links)),\r\n        scale: this.scale\r\n      };\r\n\r\n      this.history.push(snapshot);\r\n      this.historyIndex = this.history.length - 1;\r\n    },\r\n    undo() {\r\n      if (this.historyIndex > 0) {\r\n        this.historyIndex--;\r\n        this.restore(this.history[this.historyIndex]);\r\n      }\r\n    },\r\n    redo() {\r\n      if (this.historyIndex < this.history.length - 1) {\r\n        this.historyIndex++;\r\n        this.restore(this.history[this.historyIndex]);\r\n      }\r\n    },\r\n    restore(snapshot) {\r\n      this.nodes = JSON.parse(JSON.stringify(snapshot.nodes));\r\n      this.links = JSON.parse(JSON.stringify(snapshot.links));\r\n      if (snapshot.scale !== undefined) this.scale = snapshot.scale;\r\n    },\r\n    addNode(node) {\r\n      this.nodes.push(node);\r\n      this.pushHistory();\r\n    },\r\n    mounted() {\r\n      // initialize history with empty state\r\n      this.pushHistory();\r\n    },\r\n    startDragEnd(link) {\r\n      this.draggingLinkEnd = link;\r\n      window.addEventListener('mousemove', this.trackDragEnd);\r\n      window.addEventListener('mouseup', this.stopDragEnd);\r\n    },\r\n\r\n    // **2) Khi di chuột, cập nhật toPos của link**\r\n    trackDragEnd(evt) {\r\n      if (!this.draggingLinkEnd) return;\r\n      const rect = this.$refs.canvas.getBoundingClientRect();\r\n      this.draggingLinkEnd.toPos = {\r\n        x: evt.clientX - rect.left,\r\n        y: evt.clientY - rect.top\r\n      };\r\n      this.draggingLinkEnd.attachedTo = null;\r\n    },\r\n\r\n    // **3) Khi thả chuột, kết thúc drag**\r\n    stopDragEnd() {\r\n      window.removeEventListener('mousemove', this.trackDragEnd);\r\n      window.removeEventListener('mouseup', this.stopDragEnd);\r\n      this.draggingLinkEnd = null;\r\n    },\r\n    getLinkEnd(link) {\r\n      // nếu là free-pos\r\n      if (link.toPos) {\r\n        return { x: link.toPos.x, y: link.toPos.y };\r\n      }\r\n      // còn lại là node → node\r\n      const endNode = this.nodes.find(n => n.id === link.to);\r\n      if (!endNode) return { x: 0, y: 0 };\r\n      return {\r\n        x: endNode.left + endNode.width / 2,\r\n        y: endNode.top + endNode.height / 2\r\n      };\r\n    },\r\n    computeTaperedBranch(link) {\r\n      // 1) Lấy tọa độ start/end\r\n      const start = this.getNodeCenter(link.from);\r\n      const end = link.toPos\r\n        ? { x: link.toPos.x, y: link.toPos.y }\r\n        : this.getNodeCenter(link.to);\r\n      if (!start || !end) return '';\r\n\r\n      // 2) Tính Bézier Q control-point có offset theo curvature\r\n      const dx = end.x - start.x;\r\n      const dy = end.y - start.y;\r\n      const mx = (start.x + end.x) / 2;\r\n      const my = (start.y + end.y) / 2;\r\n      const len = Math.hypot(dx, dy) || 1;\r\n      // Vector pháp tuyến (unit)\r\n      const ux = -dy / len;\r\n      const uy = dx / len;\r\n      // Offset = curvature * len (nhúng curvature vào đây)\r\n      const offset = (link.curvature || 0) * len;\r\n      const cx = mx + ux * offset;\r\n      const cy = my + uy * offset;\r\n\r\n      // 3) Chia thành N segment để tạo taper\r\n      const N = 30;\r\n      const leftPts = [];\r\n      const rightPts = [];\r\n      for (let i = 0; i <= N; i++) {\r\n        const t = i / N;\r\n        // Công thức Q-bezier\r\n        const x = (1 - t) ** 2 * start.x\r\n          + 2 * (1 - t) * t * cx\r\n          + t ** 2 * end.x;\r\n        const y = (1 - t) ** 2 * start.y\r\n          + 2 * (1 - t) * t * cy\r\n          + t ** 2 * end.y;\r\n        // Vector pháp tuyến (không đổi)\r\n        const nx = ux;\r\n        const ny = uy;\r\n        // Độ rộng taper: đầu = thickness, cuối = 0\r\n        const w = (link.thickness || 2) * (1 - t);\r\n        leftPts.push(`${x + nx * w / 2},${y + ny * w / 2}`);\r\n        rightPts.unshift(`${x - nx * w / 2},${y - ny * w / 2}`);\r\n      }\r\n\r\n      // 4) Ghép thành path đóng\r\n      return `M${leftPts.join('L')}L${rightPts.join('L')}Z`;\r\n    },\r\n    computeRadialLinkPath(link) {\r\n      const fromCenter = this.getNodeCenter(link.from);\r\n      if (!fromCenter) return \"\";\r\n\r\n      const toCenter = link.toPos\r\n        ? { x: link.toPos.x, y: link.toPos.y }\r\n        : this.getNodeCenter(link.to);\r\n      if (!toCenter) return \"\";\r\n\r\n      // Lấy tâm chính xác của SVG\r\n      const rectSVG = this.$refs.canva.getBoundingClientRect();\r\n      const cx = rectSVG.width / 2;\r\n      const cy = rectSVG.height / 2;\r\n\r\n      const dx1 = fromCenter.x - cx;\r\n      const dy1 = fromCenter.y - cy;\r\n      const angle1 = Math.atan2(dy1, dx1);\r\n      const r1 = Math.hypot(dx1, dy1);\r\n\r\n      const dx2 = toCenter.x - cx;\r\n      const dy2 = toCenter.y - cy;\r\n      const angle2 = Math.atan2(dy2, dx2);\r\n      const r2 = Math.hypot(dx2, dy2);\r\n\r\n      const x1 = r1 * Math.cos(angle1) + cx;\r\n      const y1 = r1 * Math.sin(angle1) + cy;\r\n      const x2 = r2 * Math.cos(angle2) + cx;\r\n      const y2 = r2 * Math.sin(angle2) + cy;\r\n\r\n      const midR = (r1 + r2) / 2;\r\n      const xi1 = midR * Math.cos(angle1) + cx;\r\n      const yi1 = midR * Math.sin(angle1) + cy;\r\n      const xi2 = midR * Math.cos(angle2) + cx;\r\n      const yi2 = midR * Math.sin(angle2) + cy;\r\n\r\n      return `M ${x1},${y1} C ${xi1},${yi1} ${xi2},${yi2} ${x2},${y2}`;\r\n    },\r\n    midPoint(link) {\r\n      const start = this.getNodeCenter(link.from);\r\n      const end = link.toPos\r\n        ? { x: link.toPos.x, y: link.toPos.y }\r\n        : this.getNodeCenter(link.to);\r\n      if (!start || !end) return { x: 0, y: 0 };\r\n\r\n      // Nếu link.curvature = 0, mid là trung điểm\r\n      if (!link.curvature) {\r\n        return {\r\n          x: (start.x + end.x) / 2,\r\n          y: (start.y + end.y) / 2\r\n        };\r\n      }\r\n\r\n      // Với đường cong Q, mid trượt theo normal\r\n      const dx = end.x - start.x;\r\n      const dy = end.y - start.y;\r\n      const len = Math.hypot(dx, dy) || 1;\r\n      const mx = (start.x + end.x) / 2;\r\n      const my = (start.y + end.y) / 2;\r\n      const ux = -dy / len;\r\n      const uy = dx / len;\r\n      return {\r\n        x: mx + ux * (link.curvature * len),\r\n        y: my + uy * (link.curvature * len)\r\n      };\r\n    },\r\n    startAdjustCurvature(link) {\r\n      this.adjustingLink = link;\r\n      window.addEventListener('mousemove', this.adjustCurvature);\r\n      window.addEventListener('mouseup', this.endAdjustCurvature);\r\n    },\r\n\r\n    adjustCurvature(evt) {\r\n      if (!this.adjustingLink) return;\r\n      const link = this.adjustingLink;\r\n\r\n      // Lấy tọa độ start/end, hỗ trợ cả node→node và node→pos\r\n      const start = this.getNodeCenter(link.from);\r\n      const end = link.toPos\r\n        ? { x: link.toPos.x, y: link.toPos.y }\r\n        : this.getNodeCenter(link.to);\r\n\r\n      if (!start || !end) return;   // guard nếu null\r\n\r\n      // Lấy mouse trong canvas\r\n      const rect = this.$refs.canvas.getBoundingClientRect();\r\n      const mx = evt.clientX - rect.left;\r\n      const my = evt.clientY - rect.top;\r\n\r\n      // Tính normal\r\n      const dx = end.x - start.x;\r\n      const dy = end.y - start.y;\r\n      const len = Math.hypot(dx, dy) || 1;\r\n      const ux = -dy / len;\r\n      const uy = dx / len;\r\n\r\n      // Midpoint không cong (curvature=0)\r\n      const mid0 = {\r\n        x: (start.x + end.x) / 2,\r\n        y: (start.y + end.y) / 2\r\n      };\r\n\r\n      // Vector từ mid0 tới con trỏ\r\n      const vx = mx - mid0.x;\r\n      const vy = my - mid0.y;\r\n\r\n      // Vặn curvature: signed distance trên normal\r\n      link.curvature = (vx * ux + vy * uy) / len;\r\n    },\r\n\r\n    endAdjustCurvature() {\r\n      window.removeEventListener('mousemove', this.adjustCurvature);\r\n      window.removeEventListener('mouseup', this.endAdjustCurvature);\r\n      this.adjustingLink = null;\r\n    },\r\n    selectLink(link) {\r\n      console.log('Chọn link:', link)\r\n      this.selectedLink = link;\r\n      this.selectedNode = null;  // bỏ chọn node khi chọn link\r\n    },\r\n    clearSelection() {\r\n      this.selectedNode = null;\r\n      this.selectedLink = null;\r\n    },\r\n    handleNodeClick(node) {\r\n      if (!this.linking.active) {\r\n        this.selectNode(node);\r\n      }\r\n    },\r\n\r\n    // duy nhất một chỗ set selectedNode và panel\r\n    selectNode(node) {\r\n      this.selectedNode = node;\r\n      this.selectedLink = null;                // clear link selection\r\n      this.selectedColor = node.textColor || '#000000';\r\n      this.selectedFont = node.fontFamily || 'Arial';\r\n      this.selectedAlign = node.align || 'center';\r\n      this.nodeBorderColor = node.borderColor;\r\n      this.nodeBackgroundColor = node.backgroundColor;\r\n      this.nodeBorderThickness = node.borderWidth;\r\n      this.nodeBorderStyle = node.borderStyle;\r\n      this.selectedFontSize = node.fontSize;\r\n\r\n      // nếu bạn có muốn apply style lên chính element ngay\r\n      this.updateNodeStyle(node);\r\n    },\r\n\r\n    // tương tự với link\r\n    handleLinkClick(link) {\r\n      this.selectionLink(link);\r\n    },\r\n\r\n    selectionLink(link) {\r\n      this.selectedLink = link;\r\n      this.selectedNode = null;                  // clear node selection\r\n      this.linkColor = link.color;\r\n      this.linkThickness = link.thickness;\r\n      this.linkDash = link.dash;\r\n      this.linkCurvature = link.curvature;\r\n      this.linkMarker = link.marker;\r\n    },\r\n\r\n    initSelection() {\r\n      if (this.nodes.length) this.selectNode(this.nodes[0]);\r\n      if (this.links.length) this.selectionLink(this.links[0]);\r\n    },\r\n    dragStart(type) {\r\n      this.currentDrag = type;\r\n    },\r\n    drop(event) {\r\n      event.preventDefault();\r\n\r\n      // Lấy loại drag hiện tại\r\n      const type = this.currentDrag;\r\n      if (!type) return;\r\n\r\n      // Tính toạ độ relative so với canvas\r\n      const rect = event.currentTarget.getBoundingClientRect();\r\n      const x = event.clientX - rect.left;\r\n      const y = event.clientY - rect.top;\r\n\r\n      // Nếu là image, để handleFileSelect xử lý\r\n      if (type === 'image') {\r\n        // bạn có thể bật file input ở đây nếu muốn\r\n        this.uploadImage();\r\n      } else {\r\n        // chuẩn bị node mới\r\n        const newNode = {\r\n          id: idCounter++,\r\n          type: type,                   // rectangle, circle, diamond, label\r\n          left: x,\r\n          top: y,\r\n          width: type === 'label' ? 100 : 120,\r\n          height: type === 'label' ? 40 : 80,\r\n          text: type === 'label' ? 'Nhập text...' : '',\r\n          rotation: 0,\r\n\r\n          // Font mặc định\r\n          font: {\r\n            family: 'Arial',\r\n            size: 14,\r\n            bold: false,\r\n            italic: false,\r\n            color: '#000000',\r\n            align: 'center'\r\n          },\r\n\r\n          // Style mặc định\r\n          style: {\r\n            borderColor: '#000000',\r\n            borderWidth: this.defaultNodeBorderThickness,  // hoặc 1\r\n            borderStyle: this.defaultNodeBorderStyle,      // hoặc 'solid'\r\n            backgroundColor: '#ffffff',\r\n            custom: {}\r\n          },\r\n\r\n        };\r\n\r\n        this.nodes.push(newNode);\r\n      }\r\n\r\n      // reset trạng thái drag\r\n      this.currentDrag = null;\r\n    },\r\n    removeNode(nodeToRemove) {\r\n      this.pushHistory();\r\n      // 1) Xác định node mục tiêu (nếu không truyền vào thì lấy selected)\r\n      const target = nodeToRemove || this.selectedNode;\r\n      if (!target) return;\r\n\r\n      // 2) Tập hợp tất cả id cần xoá (target + descendants)\r\n      const toDelete = new Set([target.id]);\r\n      let changed;\r\n      do {\r\n        changed = false;\r\n        this.links.forEach(l => {\r\n          if (toDelete.has(l.from) && !toDelete.has(l.to)) {\r\n            toDelete.add(l.to);\r\n            changed = true;\r\n          }\r\n        });\r\n      } while (changed);\r\n\r\n      // 3) Lọc nodes, links\r\n      this.nodes = this.nodes.filter(n => !toDelete.has(n.id));\r\n      this.links = this.links.filter(\r\n        l => !toDelete.has(l.from) && !toDelete.has(l.to)\r\n      );\r\n\r\n      // 4) Reset selection & linking\r\n      this.selectedNode = null;\r\n      this.selectedLink = null;\r\n      if (this.linking) {\r\n        this.linking.active = false;\r\n        this.linking.fromNode = null;\r\n        this.linking.tempPos = { x: 0, y: 0 };\r\n      }\r\n\r\n      // 5) Đẩy lịch sử nếu cần\r\n      this.pushHistory();\r\n    },\r\n    uploadImage() {\r\n      document.getElementById('imageUploader').click();\r\n    },\r\n    handleFileSelect(event) {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        const reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          const dataUrl = e.target.result;\r\n          this.nodes.push({\r\n            id: idCounter++,\r\n            type: 'image',\r\n            left: 50,\r\n            top: 50,\r\n            width: 150,\r\n            height: 100,\r\n            image: dataUrl,\r\n            borderColor: this.defaultNodeBorderColor,\r\n            backgroundColor: this.defaultNodeBackgroundColor,\r\n            borderThickness: this.defaultNodeBorderThickness,\r\n            borderStyle: this.defaultNodeBorderStyle\r\n          });\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n    },\r\n    updateNodeText(evt, node) {\r\n      node.text = evt.target.innerHTML;\r\n      // đảm bảo style vẫn giữ\r\n      this.updateNodeStyle(node);\r\n    },\r\n    toggleBold() {\r\n      console.log('toggleBold called, selectedNode =', this.selectedNode);\r\n      if (this.selectedNode) {\r\n        this.selectedNode.isBold = !this.selectedNode.isBold;\r\n        document.execCommand('bold');\r\n        this.updateNodeStyle(this.selectedNode);\r\n        this.updateText(this.selectedNode);\r\n      } else if (this.selectedLink) {\r\n        this.selectedLink.isBold = !this.selectedLink.isBold;\r\n      }\r\n    },\r\n\r\n    toggleItalic() {\r\n      if (this.selectedNode) {\r\n        this.selectedNode.isItalic = !this.selectedNode.isItalic;\r\n        document.execCommand('italic');\r\n        this.updateNodeStyle(this.selectedNode);\r\n        this.updateText(this.selectedNode);\r\n      } else if (this.selectedLink) {\r\n        this.selectedLink.isItalic = !this.selectedLink.isItalic;\r\n      }\r\n    },\r\n\r\n    applyFontFamily() {\r\n      if (this.selectedNode) {\r\n        this.selectedNode.fontFamily = this.selectedFont;\r\n        this.updateNodeStyle(this.selectedNode);\r\n        this.updateText(this.selectedNode);\r\n      } else if (this.selectedLink) {\r\n        this.selectedLink.fontFamily = this.selectedFont;\r\n      }\r\n    },\r\n\r\n    applyTextColor() {\r\n      if (this.selectedNode) {\r\n        this.selectedNode.textColor = this.selectedColor;\r\n        this.updateNodeStyle(this.selectedNode);\r\n        this.updateText(this.selectedNode);\r\n      } else if (this.selectedLink) {\r\n        this.selectedLink.textColor = this.selectedColor;\r\n      }\r\n    },\r\n    applyFontSize() {\r\n      if (this.selectedNode) {\r\n        this.selectedNode.fontSize = this.selectedFontSize;\r\n        this.updateNodeStyle(this.selectedNode);\r\n        this.updateText(this.selectedNode);\r\n      } else if (this.selectedLink) {\r\n        this.selectedLink.fontSize = this.selectedFontSize;\r\n      }\r\n    },\r\n    setAlign(dir) {\r\n      if (this.selectedNode) {\r\n        this.selectedNode.align = dir;\r\n        this.selectedAlign = dir;\r\n        document.execCommand(\r\n          dir === 'left' ? 'justifyLeft' :\r\n            dir === 'center' ? 'justifyCenter' :\r\n              'justifyRight'\r\n        );\r\n        this.updateNodeStyle(this.selectedNode);\r\n        this.updateText(this.selectedNode);\r\n      } else if (this.selectedLink) {\r\n        // Map dir thành đúng giá trị cho link\r\n        let linkDir = 'middle';\r\n        if (dir === 'left') linkDir = 'start';\r\n        else if (dir === 'center') linkDir = 'middle';\r\n        else if (dir === 'right') linkDir = 'end';\r\n        this.selectedLink.align = linkDir;\r\n      }\r\n    },\r\n\r\n    // Tái áp dụng style lên nội dung <div contenteditable>\r\n    updateNodeStyle(node) {\r\n      // set inline styles\r\n      this.$nextTick(() => {\r\n        const el = this.$el.querySelector(`.node[data-id=\"${node.id}\"] .shape-inner`);\r\n        if (!el) return;\r\n        el.style.fontWeight = node.isBold ? 'bold' : 'normal';\r\n        el.style.fontStyle = node.isItalic ? 'italic' : 'normal';\r\n        el.style.fontFamily = node.fontFamily || '';\r\n        el.style.color = node.textColor;\r\n        el.style.textAlign = node.align || 'center';\r\n        el.style.fontSize = `${node.fontSize}px` || `12px`;\r\n      });\r\n    },\r\n    updateNode(node) {\r\n      if (!node || node.id == null) {\r\n        console.warn('Không có node để cập nhật', node);\r\n        return;\r\n      }\r\n      node.backgroundColor = this.nodeBackgroundColor;\r\n      node.borderColor = this.nodeBorderColor;\r\n      node.borderWidth = this.nodeBorderThickness;\r\n      node.borderStyle = this.nodeBorderStyle;\r\n      console.log('updateNodeStyle', node.id, node.borderWidth);\r\n      const sel = d3.select(this.$refs.canva)\r\n        .select(`g.node-group[data-id='${node.id}']`);\r\n      console.log(d3.select(this.$refs.canva).selectAll('g.node-group').nodes());\r\n      if (sel.empty()) {\r\n        console.warn('Không tìm thấy node-group với id', node.id);\r\n        return;\r\n      }\r\n      sel.selectAll('circle.node-shape, ellipse.node-shape, rect.node-shape')\r\n        .attr('fill', node.backgroundColor)\r\n        .attr('stroke', node.borderColor)\r\n        .attr('stroke-width', node.borderWidth)\r\n        .attr('stroke-dasharray',\r\n          node.borderStyle === 'dashed' ? '4,2'\r\n            : node.borderStyle === 'dotted' ? '1,2'\r\n              : null\r\n        );\r\n    },\r\n    updateText(node) {\r\n      console.log('updateText', node.id, node.textColor);\r\n      const sel = d3.select(this.$refs.canva)\r\n        .select(`g.node-group[data-id='${node.id}']`);\r\n      sel.select('text')\r\n        // .attr('text-anchor',    node.align)\r\n        .attr('font-size', node.fontSize)\r\n        .attr('font-weight', node.isBold ? 'bold' : 'normal')\r\n        .attr('font-style', node.isItalic ? 'italic' : 'normal')\r\n        .style('fill', node.textColor)\r\n        .attr('font-family', node.fontFamily);\r\n    },\r\n    updateLink(link) {\r\n      if (!link || link.from == null) return;  // << guard ở đây\r\n      const sel = d3.select(this.$refs.canvas)\r\n        // .select(`line[data-from='${link.from}'][data-to='${link.to}']`)\r\n        .select(`path.link[data-id=\"${link.id}\"]`);\r\n      sel\r\n        .attr('stroke', link.color)\r\n        .attr('stroke-width', link.thickness)\r\n        .attr('stroke-dasharray', this.dashArray(link.dash))\r\n        .attr('marker-end', link.marker === 'none' ? null : `url(#${link.marker})`);\r\n    },\r\n    startDragNode(node, event) {\r\n      if (this.linkMode) return;\r\n      this.draggingNode = node;\r\n      this.offsetX = event.clientX - node.left;\r\n      this.offsetY = event.clientY - node.top;\r\n      window.addEventListener('mousemove', this.doDragNode);\r\n      window.addEventListener('mouseup', this.stopDragNode);\r\n    },\r\n    doDragNode(event) {\r\n      if (!this.draggingNode) return;\r\n      // di chuyển node\r\n      this.draggingNode.left = event.clientX - this.offsetX;\r\n      this.draggingNode.top = event.clientY - this.offsetY;\r\n\r\n      // tâm node mới\r\n      const cx = this.draggingNode.left + this.draggingNode.width / 2;\r\n      const cy = this.draggingNode.top + this.draggingNode.height / 2;\r\n\r\n      // cập nhật các link gắn vào node này\r\n      let moved = false;\r\n      this.links.forEach(link => {\r\n        if (link.attachedTo === this.draggingNode.id && link.toPos) {\r\n          link.toPos.x = cx;\r\n          link.toPos.y = cy;\r\n          link.path = this.computeLinkPath(link);\r\n          moved = true;\r\n        }\r\n      });\r\n      if (!moved) {\r\n        console.log('')\r\n      }\r\n    },\r\n    stopDragNode() {\r\n      window.removeEventListener('mousemove', this.doDragNode);\r\n      window.removeEventListener('mouseup', this.stopDragNode);\r\n      this.draggingNode = null;\r\n    },\r\n    startResize(node, event, dir) {\r\n      this.resizingNode = node;\r\n      this.resizeDir = dir;\r\n      this.startX = event.clientX;\r\n      this.startY = event.clientY;\r\n      this.startW = node.width;\r\n      this.startH = node.height;\r\n      this.startL = node.left;\r\n      this.startT = node.top;\r\n      window.addEventListener('mousemove', this.doResize);\r\n      window.addEventListener('mouseup', this.stopResize);\r\n    },\r\n    doResize(event) {\r\n      if (!this.resizingNode) return;\r\n      const dx = event.clientX - this.startX;\r\n      const dy = event.clientY - this.startY;\r\n      let newW = this.startW;\r\n      let newH = this.startH;\r\n      let newL = this.startL;\r\n      let newT = this.startT;\r\n      switch (this.resizeDir) {\r\n        case 'top-left':\r\n          newW = Math.max(30, this.startW - dx);\r\n          newH = Math.max(30, this.startH - dy);\r\n          newL = this.startL + dx;\r\n          newT = this.startT + dy;\r\n          break;\r\n        case 'top-center':\r\n          newH = Math.max(30, this.startH - dy);\r\n          newT = this.startT + dy;\r\n          break;\r\n        case 'top-right':\r\n          newW = Math.max(30, this.startW + dx);\r\n          newH = Math.max(30, this.startH - dy);\r\n          newT = this.startT + dy;\r\n          break;\r\n        case 'mid-left':\r\n          newW = Math.max(30, this.startW - dx);\r\n          newL = this.startL + dx;\r\n          break;\r\n        case 'mid-right':\r\n          newW = Math.max(30, this.startW + dx);\r\n          break;\r\n        case 'bottom-left':\r\n          newW = Math.max(30, this.startW - dx);\r\n          newH = Math.max(30, this.startH + dy);\r\n          newL = this.startL + dx;\r\n          break;\r\n        case 'bottom-center':\r\n          newH = Math.max(30, this.startH + dy);\r\n          break;\r\n        case 'bottom-right':\r\n          newW = Math.max(30, this.startW + dx);\r\n          newH = Math.max(30, this.startH + dy);\r\n          break;\r\n      }\r\n      this.resizingNode.width = newW;\r\n      this.resizingNode.height = newH;\r\n      this.resizingNode.left = newL;\r\n      this.resizingNode.top = newT;\r\n    },\r\n    stopResize() {\r\n      window.removeEventListener('mousemove', this.doResize);\r\n      window.removeEventListener('mouseup', this.stopResize);\r\n      this.resizingNode = null;\r\n      this.resizeDir = null;\r\n    },\r\n    getNodeCenter(nodeOrId) {\r\n      // nếu truyền thẳng node object thì xài luôn\r\n      const node = typeof nodeOrId === 'object'\r\n        ? nodeOrId\r\n        : this.nodes.find(n => n.id === nodeOrId);\r\n\r\n      if (!node) return null;   // không tìm thấy → null\r\n      return {\r\n        x: node.left + node.width / 2,\r\n        y: node.top + node.height / 2\r\n      };\r\n    },\r\n    // Trả về style cho shape-inner, nơi hiển thị hình dạng thực của node\r\n    shapeInnerStyle(node) {\r\n      if (node.type === 'label') {\r\n        return {\r\n          width: '100%',\r\n          height: '100%',\r\n          backgroundColor: 'transparent',\r\n          border: 'none',\r\n          padding: '0 4px',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          cursor: 'pointer',\r\n          userSelect: 'none',\r\n          fontWeight: node.isBold ? 'bold' : 'normal',\r\n          fontStyle: node.isItalic ? 'italic' : 'normal',\r\n          fontFamily: node.fontFamily || '',\r\n          color: node.textColor || '#000',\r\n          textAlign: node.align || 'center',\r\n          fontSize: `${node.fontSize}px`,\r\n        };\r\n      }\r\n      const borderColor = node.borderColor || this.defaultNodeBorderColor;\r\n      const borderThickness = node.borderThickness !== undefined ? node.borderThickness : this.defaultNodeBorderThickness;\r\n      const borderStyle = node.borderStyle || this.defaultNodeBorderStyle;\r\n      const backgroundColor = node.backgroundColor || this.defaultNodeBackgroundColor;\r\n      let style = {\r\n        width: '100%',\r\n        height: '100%',\r\n        backgroundColor: backgroundColor,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        overflow: 'hidden',\r\n        padding: '5px',\r\n        textAlign: 'center',\r\n        whiteSpace: 'normal',\r\n        wordWrap: 'break-word'\r\n      };\r\n      if (node.type === 'circle') {\r\n        style.borderRadius = '50%';\r\n        style.border = borderThickness + 'px ' + borderStyle + ' ' + borderColor;\r\n      } else {\r\n        style.borderRadius = '5px';\r\n        style.border = borderThickness + 'px ' + borderStyle + ' ' + borderColor;\r\n      }\r\n      return style;\r\n    },\r\n    beginLink(node, evt) {\r\n      const canvas = this.$refs.canvas;\r\n      if (!canvas) return;\r\n      const rect = canvas.getBoundingClientRect();\r\n\r\n      this.linking.active = true;\r\n      this.linking.fromNode = node;\r\n      this.linking.tempPos = {\r\n        x: evt.clientX - rect.left,\r\n        y: evt.clientY - rect.top\r\n      };\r\n\r\n      window.addEventListener('mousemove', this.trackLink);\r\n      window.addEventListener('mouseup', this.endLink);\r\n    },\r\n\r\n    trackLink(evt) {\r\n      if (!this.linking.active) return;\r\n      const canvas = this.$refs.canvas;\r\n      if (!canvas) return;\r\n      const rect = canvas.getBoundingClientRect();\r\n\r\n      this.linking.tempPos = {\r\n        x: evt.clientX - rect.left,\r\n        y: evt.clientY - rect.top\r\n      };\r\n    },\r\n\r\n    // Kết thúc vẽ: nếu mouseup trên một node khác thì tạo link\r\n    endLink(evt) {\r\n      if (!this.linking.fromNode) return;\r\n      // … xác định đích …\r\n      const el = document.elementFromPoint(evt.clientX, evt.clientY);\r\n      const nodeEl = el && el.closest('.node');\r\n      const rect = this.$refs.canvas.getBoundingClientRect();\r\n      if (nodeEl) {\r\n        // nối node→node\r\n        const toId = Number(nodeEl.dataset.id);\r\n        const center = this.getNodeCenter(toId);\r\n        if (!center) {\r\n          alert('Không thể nối ngược node với id = ' + toId);\r\n          this.linking = {};\r\n          return;\r\n        }\r\n        this.links.push({\r\n          from: this.linking.fromNode.id,\r\n          toPos: { x: center.x, y: center.y },\r\n          attachedTo: toId,\r\n          color: this.defaultLinkColor,\r\n          thickness: this.defaultLinkThickness,\r\n          dash: this.defaultLinkDash,\r\n          curvature: this.defaultLinkCurvature,\r\n          marker: this.defaultLinkMarker,\r\n          text: '',\r\n          isBold: false,\r\n          isItalic: false,\r\n          align: 'middle',\r\n          textColor: this.selectedColor,\r\n          fontSize: 12,\r\n          fontFamily: 'Arial'\r\n        });\r\n      } else {\r\n        // nối node→free‐pos\r\n        const x = evt.clientX - rect.left;\r\n        const y = evt.clientY - rect.top;\r\n        if (x < 0 || y < 0) {\r\n          alert('Vị trí vẽ link không hợp lệ.');\r\n          this.linking = {};\r\n          return;\r\n        }\r\n        this.links.push({\r\n          from: this.linking.fromNode.id,\r\n          toPos: { x, y },\r\n          attachedTo: null,\r\n          color: this.defaultLinkColor,\r\n          thickness: this.defaultLinkThickness,\r\n          dash: this.defaultLinkDash,\r\n          curvature: this.defaultLinkCurvature,\r\n          marker: this.defaultLinkMarker,\r\n          text: '',\r\n          isBold: false,\r\n          isItalic: false,\r\n          align: 'middle',\r\n          textColor: this.selectedColor,\r\n          fontSize: 12,\r\n          fontFamily: 'Arial'\r\n        });\r\n      }\r\n\r\n      this.linking.active = false;\r\n      this.linking.fromNode = null;\r\n    },\r\n    getLinkPath(fromId, to, isPos = false, curvature = 0) {\r\n      const start = this.getNodeCenter(fromId);\r\n      const end = isPos\r\n        ? to\r\n        : this.getNodeCenter(to);\r\n\r\n      // Nếu thiếu start hoặc end thì không vẽ đường\r\n      if (!start || !end) {\r\n        return '';\r\n      }\r\n\r\n      // Nếu thẳng\r\n      if (curvature === 0) {\r\n        return `M${start.x},${start.y} L${end.x},${end.y}`;\r\n      }\r\n\r\n      // Cong Bézier Q\r\n      const dx = end.x - start.x;\r\n      const dy = end.y - start.y;\r\n      const mx = (start.x + end.x) / 2;\r\n      const my = (start.y + end.y) / 2;\r\n      const len = Math.hypot(dx, dy) || 1;\r\n      const ux = -dy / len, uy = dx / len;\r\n      const cx = mx + ux * curvature * len;\r\n      const cy = my + uy * curvature * len;\r\n\r\n      return `M${start.x},${start.y} Q${cx},${cy} ${end.x},${end.y}`;\r\n    },\r\n    dashArray(dash) {\r\n      return dash === 'dashed' ? '5,5'\r\n        : dash === 'dotted' ? '2,2'\r\n          : '';\r\n    },\r\n    inlineAllStyles(el) {\r\n      const recurse = node => {\r\n        const cs = getComputedStyle(node);\r\n        ['fill', 'stroke', 'font-size', 'font-family', 'font-weight', 'opacity']\r\n          .forEach(prop => node.style.setProperty(prop, cs.getPropertyValue(prop)));\r\n        for (let c of node.children) recurse(c);\r\n      };\r\n      recurse(el);\r\n    },\r\n    async exportImage() {\r\n      const svgEl = this.$refs.canvas;\r\n      if (!svgEl) return;\r\n\r\n      // 1) Gán width/height nếu chưa có (cộng thêm padding nếu cần)\r\n      svgEl.setAttribute('width', svgEl.clientWidth + 1000);\r\n      svgEl.setAttribute('height', svgEl.clientHeight + 400);\r\n\r\n      // 2) Inline tất cả style (giữ nguyên hàm của bạn)\r\n      this.inlineAllStyles(svgEl);\r\n\r\n      // 3) Dùng html-to-image để xuất PNG\r\n      try {\r\n        const dataUrl = await htmlToImage.toPng(svgEl, {\r\n          backgroundColor: 'white',\r\n          width: svgEl.clientWidth + 1000,\r\n          height: svgEl.clientHeight + 400,\r\n          pixelRatio: 2,           // scale = 2×\r\n          // filter: node => …     // nếu muốn loại trừ node nào đó\r\n        });\r\n\r\n        // Tạo link download\r\n        const link = document.createElement('a');\r\n        link.download = `${this.form.mapTitle || 'mindmap'}.png`;\r\n        link.href = dataUrl;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n\r\n      } catch (err) {\r\n        console.error('Lỗi khi xuất ảnh:', err);\r\n      }\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style scoped>\r\ntemplate {\r\n  height: 100%;\r\n  margin: 0;\r\n}\r\n\r\n.mindmap-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n}\r\n\r\n.toolbar {\r\n  width: 100%;\r\n  padding: 12px 20px;\r\n  background: linear-gradient(135deg, rgb(77, 70, 70), aqua);\r\n  display: flex;\r\n  border-radius: 20px;\r\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.toolbar-left {\r\n  display: flex;\r\n  gap: 10px;\r\n  width: 60%;\r\n}\r\n\r\n.toolbar-right {\r\n  width: 40%;\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n\r\n.toolbar-btn {\r\n  border: none;\r\n  padding: 8px 12px;\r\n  border-radius: 10px;\r\n  background: rgba(255, 255, 255, 0.9);\r\n  color: #1f2937;\r\n  font-weight: bolder;\r\n  transition: all 0.3s ease;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n}\r\n\r\n.toolbar-btn:hover {\r\n  background: yellow;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.toolbar-btn i {\r\n  width: 18px;\r\n  height: 18px;\r\n}\r\n\r\n.ai-button a {\r\n  text-decoration: none;\r\n  color: #1f2937;\r\n  font-weight: bolder;\r\n}\r\n\r\n.ai-button a:hover {\r\n  color: #6366f1;\r\n}\r\n\r\n.content {\r\n  display: flex;\r\n  flex: 1;\r\n  gap: 20px;\r\n  width: 1440px;\r\n}\r\n\r\n.left-panel {\r\n  width: 280px;\r\n  padding: 20px;\r\n  height: 100%;\r\n  background: radial-gradient(rgb(173, 252, 252), white);\r\n  border-right: 1px solid #e5e7eb;\r\n  overflow-y: auto;\r\n}\r\n\r\n.left-panel h3 {\r\n  margin: 0 0 5px 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: #1f2937;\r\n}\r\n\r\n.node-shapes {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.node-shapes h3 {\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.node-shapes .shape {\r\n  display: flex;\r\n}\r\n\r\n.fomat {\r\n  display: flex;\r\n}\r\n\r\n.shape-option {\r\n  width: 25px;\r\n  height: 25px;\r\n  border: 2px solid #e5e7eb;\r\n  border-radius: 8px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin: 5px 0;\r\n  cursor: grab;\r\n  transition: all 0.3s ease;\r\n  margin-left: 5px;\r\n}\r\n\r\n.shape-option:hover {\r\n  border-color: #6366f1;\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.text-formatting {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.format-btn {\r\n  width: 30px;\r\n  height: 30px;\r\n  border: 2px solid #e5e7eb;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin: 5px 3px;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.format-btn.active {\r\n  background: #6366f1;\r\n  color: white;\r\n}\r\n\r\n.style-select {\r\n  width: 100%;\r\n  padding: 5px;\r\n  border: 2px solid #e5e7eb;\r\n  border-radius: 6px;\r\n  margin: 5px 0;\r\n}\r\n\r\n.color-picker {\r\n  width: 10%;\r\n  padding: 8px;\r\n  border: 2px solid #e5e7eb;\r\n  border-radius: 50%;\r\n  margin: 5px 3px;\r\n  background: linear-gradient(red, blue, green);\r\n  opacity: 60%;\r\n}\r\n\r\n.node-style {\r\n  display: flex;\r\n}\r\n\r\n.number-input {\r\n  width: 10%;\r\n  padding: 8px;\r\n  border: 2px solid #e5e7eb;\r\n  border-radius: 6px;\r\n  margin: 5px 0;\r\n}\r\n\r\n.canvas {\r\n  flex: 1;\r\n  position: relative;\r\n  background: #f8fafc;\r\n  overflow: auto;\r\n  border-left: 1px solid #e5e7eb;\r\n  padding: 30px auto;\r\n  width: 100%;\r\n  height: 2050px;\r\n}\r\n\r\n.link-canvas {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  pointer-events: none;\r\n  overflow: visible;\r\n  z-index: 1;\r\n  /* thấp hơn các node */\r\n}\r\n\r\n.link-canvas line,\r\n.link-canvas path {\r\n  pointer-events: all;\r\n  cursor: pointer;\r\n}\r\n\r\n.link--selected {\r\n  opacity: 0.7;\r\n}\r\n\r\n.node--disabled {\r\n  pointer-events: none;\r\n}\r\n\r\n.node {\r\n  position: absolute;\r\n  background: transparent;\r\n  border: none;\r\n  user-select: none;\r\n  overflow: visible;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n  z-index: 1;\r\n}\r\n\r\n.shape-inner {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.shape-inner.rectangle {\r\n  border-radius: 8px;\r\n}\r\n\r\n.shape-inner.circle {\r\n  border-radius: 50%;\r\n}\r\n\r\n.resize-handle {\r\n  position: absolute;\r\n  width: 12px;\r\n  height: 12px;\r\n  background: #6366f1;\r\n  border: 2px solid white;\r\n  border-radius: 50%;\r\n  cursor: pointer;\r\n  z-index: 10;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.resize-handle:hover {\r\n  background: #8b5cf6;\r\n}\r\n\r\n.resize-handle.top-left {\r\n  top: -6px;\r\n  left: -6px;\r\n  cursor: nw-resize;\r\n}\r\n\r\n.resize-handle.top-center {\r\n  top: -6px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  cursor: n-resize;\r\n}\r\n\r\n.resize-handle.top-right {\r\n  top: -6px;\r\n  right: -10px;\r\n  cursor: ne-resize;\r\n}\r\n\r\n.resize-handle.mid-left {\r\n  top: 50%;\r\n  left: -6px;\r\n  transform: translateY(-50%);\r\n  cursor: w-resize;\r\n}\r\n\r\n.resize-handle.mid-right {\r\n  top: 50%;\r\n  right: -10px;\r\n  transform: translateY(-50%);\r\n  cursor: e-resize;\r\n}\r\n\r\n.resize-handle.bottom-left {\r\n  bottom: -10px;\r\n  left: -6px;\r\n  cursor: sw-resize;\r\n}\r\n\r\n.resize-handle.bottom-center {\r\n  bottom: -10px;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  cursor: s-resize;\r\n}\r\n\r\n.resize-handle.bottom-right {\r\n  bottom: -10px;\r\n  right: -10px;\r\n  cursor: se-resize;\r\n}\r\n\r\n.link-handle {\r\n  position: absolute;\r\n  top: 30%;\r\n  right: -20px;\r\n  /* kéo ra ngoài viền node một chút */\r\n  transform: translateY(-50%);\r\n  width: 16px;\r\n  height: 16px;\r\n  background: #4CAF50;\r\n  color: white;\r\n  border-radius: 50%;\r\n  text-align: center;\r\n  line-height: 16px;\r\n  cursor: crosshair;\r\n  user-select: none;\r\n  z-index: 10;\r\n  /* đảm bảo nó nằm trên shape-inner */\r\n  font-weight: bold;\r\n}\r\n\r\n.modal-backdrop {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal {\r\n  background: #fff;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  width: 300px;\r\n}\r\n\r\n.modal h3 {\r\n  margin: 0 0 10px;\r\n}\r\n\r\n.modal input {\r\n  width: 100%;\r\n  padding: 8px;\r\n  margin: 10px 0;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.modal-actions {\r\n  text-align: right;\r\n}\r\n\r\n.modal-actions button {\r\n  margin-left: 8px;\r\n  padding: 6px 12px;\r\n}\r\n\r\n.rotate-handle {\r\n  width: 12px;\r\n  height: 12px;\r\n  background-color: #fff;\r\n  border-radius: 50%;\r\n  position: absolute;\r\n  top: -20px;\r\n  left: calc(50% - 6px);\r\n  cursor: grab;\r\n  z-index: 10;\r\n}\r\n\r\n.rotate-handle:active {\r\n  cursor: grabbing;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .content {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .left-panel {\r\n    width: 100%;\r\n    overflow-y: auto;\r\n    border-bottom: 1px solid #e5e7eb;\r\n    padding: 10px;\r\n  }\r\n\r\n  .canvas {\r\n    width: 100%;\r\n    height: calc(100vh - 200px);\r\n  }\r\n}\r\n</style>","import { render } from \"./createmm.vue?vue&type=template&id=78df5db6&scoped=true\"\nimport script from \"./createmm.vue?vue&type=script&lang=js\"\nexport * from \"./createmm.vue?vue&type=script&lang=js\"\n\nimport \"./createmm.vue?vue&type=style&index=0&id=78df5db6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-78df5db6\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"AI\">\r\n    <div class=\"toolbarAI\">\r\n      <div class=\"toolbarAI_left\">\r\n        <button><a href=\"./CreateMM\"><span>&#171;</span> Tự tạo sơ đồ tư duy</a></button>\r\n        <button @click=\"toggleSuggestions\"><i class=\"fa-solid fa-lightbulb\"></i> Gợi ý</button>\r\n      </div>\r\n      <div class=\"toolbarAI_right\">\r\n        <label class=\"map-type-select\">\r\n          <select v-model=\"selectedMapType\">\r\n            <option value=\"bubble\">Bubble Map</option>\r\n            <option value=\"tree\">Tree Map</option>\r\n            <option value=\"flow\">Flow Map</option>\r\n            <option value=\"multiFlow\">Multi Flow Map</option>\r\n            <option value=\"brace\">Brace Map</option>\r\n          </select>\r\n        </label>\r\n        <button @click=\"saveTemplate\" :disabled=\"!canSave\"><i class=\"fa-solid fa-floppy-disk\"></i> Save</button>\r\n        <button @click=\"exportImage\"><i class=\"fa-solid fa-image\"></i> Xuất hình ảnh</button>\r\n        <button @click=\"exportPPT\" :disabled=\"!mindmapObject\"><i class=\"fa-solid fa-file-powerpoint\"></i> Xuất PowerPoint</button>\r\n      </div>\r\n    </div>\r\n    <div class=\"panel\">\r\n      <div class=\"left-panel\" :class=\"{ hidden: !showSuggestion }\">\r\n        <h3>Gợi ý sơ đồ tư duy</h3>\r\n        <ul class=\"suggetion-list\">\r\n          <li v-for=\"item in suggestions\" :key=\"item._id\" class=\"suggestion-item\">\r\n            <button @click=\"selectTemplate(item)\">\r\n              <img :src=\"item.imageUrl\" alt=\"template thumbnail\" class=\"thumb\">\r\n              <span class=\"title\">{{ item.title }}</span>\r\n            </button>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n      <div class=\"right-panel\" :class=\"{ full: !showSuggestions }\">\r\n        <div class=\"mindmap-display\">\r\n          <svg v-show=\"!selectedImageUrl\" ref=\"mindmapSvg\" class=\"mindmap-svg\"></svg>\r\n          <img v-show=\"selectedImageUrl\" :src=\"selectedImageUrl\" class=\"mindmap-image\" />\r\n        </div>\r\n        <div class=\"input-container\">\r\n          <div v-if=\"creatingTopic\" class=\"creating-status\">\r\n            Đang tạo sơ đồ tư duy cho <strong>{{ creatingTopic }}</strong>…\r\n          </div>\r\n          <template v-else>\r\n            <input\r\n              type=\"text\"\r\n              v-model=\"topic\"\r\n              placeholder=\"Nhập chủ đề hoặc ý tưởng...\"\r\n              @keypress.enter=\"generateMindMap\"\r\n            />\r\n            <select v-model=\"selectOption\" class=\"option-select\">\r\n              <option value=\"no-image\">Không kèm ảnh</option>\r\n              <option value=\"with-image\">Kèm ảnh</option>\r\n            </select>\r\n            <button class=\"create-btn\" @click=\"generateMindMap\">\r\n              <i class=\"fa-solid fa-brain\"></i> Tạo sơ đồ\r\n            </button>\r\n            <label class=\"file-upload\">\r\n              <span><i class=\"fa-solid fa-file-arrow-up\"></i></span>\r\n              <input type=\"file\" @change=\"onFileChange\" />\r\n            </label>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div v-if=\"showSaveModal\" class=\"modal-backdrop\">\r\n      <div class=\"modal\">\r\n        <h3>Đặt tên sơ đồ tư duy</h3>\r\n        <input v-model=\"form.mapTitle\" placeholder=\"Tên sơ đồ tư duy\" />\r\n        <div class=\"modal-actions\">\r\n          <button @click=\"confirmSave\">Lưu</button>\r\n          <button @click=\"showSaveModal = false\">Huỷ</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\n// eslint-disable-next-line no-unused-vars\r\nimport { toRaw } from 'vue';\r\nimport * as d3 from 'd3';\r\nimport { saveSvgAsPng } from 'save-svg-as-png';\r\nexport default {\r\n  name: 'CreateAIMindMap',\r\n  props: {\r\n    showSuggestions: { type: Boolean, default: true },\r\n  },\r\n  data() {\r\n    return {\r\n      topic: '',\r\n      fileContent: null,\r\n      mindmapObject: null,\r\n      suggestions: [],\r\n      showSuggestion: true,\r\n      selectOption: 'no-image',\r\n      selectedImageUrl: null,\r\n      showSaveModal: false,\r\n      form: { mapTitle: '' },\r\n      selectedMapType: 'tree',\r\n      leafImages: {},\r\n      file:null,\r\n      creatingTopic: '',\r\n      nodes: [],   // mảng các node hiện tại\r\n      links: [],\r\n    };\r\n  },\r\n  watch: {\r\n    mindmapObject(newVal) {\r\n      if (newVal) this.drawMindMap();\r\n    }\r\n  },\r\n  computed: {\r\n    canSave() {\r\n      return !!(this.selectedImageUrl || this.mindmapObject)\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchSuggestions();\r\n  },\r\n  methods: {\r\n    selectTemplate(item) {\r\n    console.log('selected item =', item);\r\n    this.mindmapObject   = item.mindmapData;\r\n    this.selectedMapType = item.mapType;\r\n    this.$nextTick(() => {\r\n      console.log('Drawing', this.selectedMapType, this.mindmapObject);\r\n      this.drawMindMap();\r\n    });\r\n  },\r\n  async fetchSuggestions() {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const res = await fetch('/api/listMindmap', {\r\n          headers: { 'Authorization': `Bearer ${token}` }\r\n        });\r\n        if (!res.ok) throw new Error(res.statusText);\r\n        const payload = await res.json();\r\n        this.suggestions = Array.isArray(payload)\r\n          ? payload\r\n          : (Array.isArray(payload.list) ? payload.list : []);\r\n      } catch (err) {\r\n        console.error('Lấy gợi ý thất bại:', err);\r\n      }\r\n    },\r\n    toggleSuggestions() {\r\n      this.selectedImageUrl = null;\r\n      this.showSuggestion = !this.showSuggestion;\r\n    },\r\n    onFileChange(event) {\r\n      this.file = event.target.files[0] || null;\r\n    },\r\n\r\n    // Gửi lên backend qua FormData\r\n    async generateMindMap() {\r\n      if (this.creatingTopic) return\r\n      const label = this.file ? this.file.name : this.topic.trim()\r\n      if (!label) return alert('Nhập chủ đề hoặc chọn file')\r\n      this.creatingTopic = label\r\n      const form = new FormData()\r\n      form.append('topic', label)\r\n      form.append('withImage', this.selectOption === 'with-image')\r\n      if (this.file) form.append('file', this.file)\r\n      try {\r\n        const res = await fetch('/api/generateMindmap', { method: 'POST', body: form })\r\n        const data = await res.json()\r\n        this.mindmapObject = data.mindmap\r\n        this.drawMindMap()\r\n        this.topic = ''\r\n        // nếu API trả sẵn ảnh\r\n        if (data.image) {\r\n          this.selectedImageUrl = data.image\r\n        }\r\n      } catch (err) {\r\n        alert('Có lỗi khi tạo sơ đồ')\r\n      } finally {\r\n        this.creatingTopic = ''\r\n      }\r\n    },\r\n\r\n// Hàm phụ để chuyển SVG → PNG và gán vào selectedImageUrl\r\n_generateImageFromSvg() {\r\n  const svgEl = this.$refs.mindmapSvg;\r\n    // clone để không làm thay đổi DOM thật\r\n    const clone = svgEl.cloneNode(true);\r\n    // đảm bảo namespace\r\n    clone.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\r\n    const w = svgEl.clientWidth;\r\n    const h = svgEl.clientHeight;\r\n    clone.setAttribute('width', w);\r\n    clone.setAttribute('height', h);\r\n    // chèn rect làm nền trắng\r\n    const ns = 'http://www.w3.org/2000/svg';\r\n    const bg = document.createElementNS(ns, 'rect');\r\n    bg.setAttribute('x', 0);\r\n    bg.setAttribute('y', 0);\r\n    bg.setAttribute('width', w);\r\n    bg.setAttribute('height', h);\r\n    bg.setAttribute('fill', '#fff');\r\n    clone.insertBefore(bg, clone.firstChild);\r\n\r\n    // serialize\r\n    const xml = new XMLSerializer().serializeToString(clone);\r\n    const svg64 = btoa(unescape(encodeURIComponent(xml)));\r\n\r\n    // tạo image & canvas\r\n    return new Promise((resolve, reject) => {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width  = w;\r\n        canvas.height = h;\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.drawImage(img, 0, 0);\r\n        resolve(canvas.toDataURL('image/png'));\r\n      };\r\n      img.onerror = reject;\r\n      img.src = 'data:image/svg+xml;base64,' + svg64;\r\n    });\r\n    },\r\n  saveTemplate() {\r\n    if (!this.canSave) return\r\n      this.showSaveModal = true\r\n      this.form.mapTitle = ''\r\n    },\r\n    async confirmSave() {\r\n      const title = this.form.mapTitle.trim();\r\n  if (!title) return alert('Nhập tên sơ đồ tư duy');\r\n\r\n  // 1) Nếu chưa có ảnh, tạo từ SVG\r\n  if (!this.selectedImageUrl) {\r\n    // Chờ Vue cập nhật DOM (SVG vừa vẽ xong)\r\n    await this.$nextTick();\r\n\r\n    try {\r\n      this.selectedImageUrl = await this._generateImageFromSvg();\r\n    } catch (e) {\r\n      console.error('Chuyển SVG → ảnh thất bại:', e);\r\n      return alert('Không thể tạo ảnh từ SVG!');\r\n    }\r\n  }\r\n\r\n  // 2) Gửi lên server\r\n  await this._postSave(title);\r\n    },\r\n    async _postSave(title) {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n\r\n    // 1. Chuẩn hoá mindmapData (tree JSON) và loại bỏ reactivity\r\n    const cleanTree = JSON.parse(JSON.stringify(toRaw(this.mindmapObject)));\r\n\r\n    // 2. Đóng gói payload theo schema\r\n    const payload = {\r\n      title,                       // tiêu đề sơ đồ\r\n      type: 'ai',                  // đánh dấu AI‐generated\r\n      mapType: this.selectedMapType, // 'bubble'|'tree'|'flow'|'multiFlow'|'brace'\r\n      mindmapData: cleanTree,      // JSON gốc do AI trả về (có thể chứa root/branches/subBranches)\r\n      imageUrl: this.selectedImageUrl // nếu bạn vẫn dùng thumbnail\r\n    };\r\n\r\n    // 3. Gọi API\r\n    const resp = await fetch('/api/listMindmap', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${token}`\r\n      },\r\n      body: JSON.stringify(payload)\r\n    });\r\n\r\n    if (!resp.ok) {\r\n      const err = await resp.json();\r\n      throw new Error(err.error || 'Lưu thất bại');\r\n    }\r\n\r\n    alert('Lưu thành công');\r\n    this.showSaveModal = false;\r\n\r\n  } catch (e) {\r\n    alert('Lỗi khi lưu: ' + e.message);\r\n  }\r\n}, \r\n\r\n    inlineAllStyles(el) {\r\n    const recurse = node => {\r\n      const cs = getComputedStyle(node);\r\n      ['fill','stroke','font-size','font-family','font-weight','opacity']\r\n        .forEach(prop => node.style.setProperty(prop, cs.getPropertyValue(prop)));\r\n      for (let c of node.children) recurse(c);\r\n    };\r\n    recurse(el);\r\n  },\r\n\r\n  exportImage() {\r\n    const svgEl = this.$refs.mindmapSvg;\r\n    if (!svgEl) return;\r\n    // 1) Gắn width/height nếu thiếu:\r\n    svgEl.setAttribute('width', svgEl.clientWidth + 1000);\r\n    svgEl.setAttribute('height', svgEl.clientHeight + 400);\r\n    // 2) Inline styles:\r\n    this.inlineAllStyles(svgEl);\r\n    // 3) Xuất bằng save-svg-as-png:\r\n    saveSvgAsPng(svgEl, (this.form.mapTitle||'mindmap')+'.png', {\r\n      backgroundColor: 'white',\r\n      scale: 2\r\n    });\r\n  },\r\n  async exportPPT() {\r\n      try {\r\n        const data = this.mindmapObject;\r\n        if (!data || typeof data.root !== 'string' || !Array.isArray(data.branches)) {\r\n          return alert('Dữ liệu sơ đồ không đúng định dạng!');\r\n        }\r\n        const pptx = new window.PptxGenJS();\r\n        \r\n        // Slide 1: root title\r\n        let slide = pptx.addSlide();\r\n        slide.addText(data.root, {\r\n          x: 0.5, y: 0.5, fontSize: 32, bold: true\r\n        });\r\n\r\n        // Slide for each branch\r\n        data.branches.forEach((branch) => {\r\n          slide = pptx.addSlide();\r\n          // Branch title\r\n          slide.addText(branch.title, {\r\n            x: 0.5, y: 0.5, fontSize: 24, bold: true, color: '0055A5'\r\n          });\r\n          let contentStartY = 1.2;\r\n          // Image if available\r\n          if (this.selectedImageUrl) {\r\n            slide.addImage({ path: this.selectedImageUrl, x: 0.5, y: 1, w: 4, h: 3 });\r\n            contentStartY = 4.2;\r\n          }\r\n          // Leaf list from subBranches\r\n          if (Array.isArray(branch.subBranches) && branch.subBranches.length) {\r\n            branch.subBranches.forEach((leaf, i) => {\r\n              const text = typeof leaf.title === 'string' ? leaf.title : JSON.stringify(leaf);\r\n              slide.addText(text, {\r\n                x: 0.7,\r\n                y: contentStartY + i * 0.5,\r\n                fontSize: 18,\r\n                bullet: true,\r\n                margin: 0.05\r\n              });\r\n            });\r\n          }\r\n        });\r\n\r\n        console.log('Total slides:', pptx.slides.length);\r\n        await pptx.writeFile({ fileName: 'MindMap_Presentation.pptx' });\r\n        alert('Đã xuất PPT thành công!');\r\n      } catch (error) {\r\n        console.error('Export PPT error:', error);\r\n        alert('Lỗi khi xuất PPT: ' + error.message);\r\n      }\r\n    },\r\n    textWidth(text) {\r\n    const ctx = document.createElement('canvas').getContext('2d');\r\n    ctx.font = '12px sans-serif';\r\n    return ctx.measureText(text).width;\r\n    },\r\n    drawMindMap(){\r\n      if(!this.mindmapObject) return;\r\n      const svg = d3.select(this.$refs.mindmapSvg);\r\n      svg.selectAll('*').remove();\r\n      svg.attr('width','100vw').attr('height','100vh');\r\n\r\n      switch(this.selectedMapType){\r\n        case 'bubble': this.drawBubbleMap(svg); break;\r\n        case 'tree': this.drawTreeMap(svg); break;\r\n        case 'flow': this.drawFlowMap(svg); break;\r\n        case 'multiFlow': this.drawMultiFlowMap(svg); break;\r\n        case 'brace': this.drawBraceMap(svg); break;\r\n      }\r\n    },\r\n    drawTreeMap(svg) {\r\n  const vm      = this;\r\n  const w       = svg.node().clientWidth;\r\n  const h       = svg.node().clientHeight;\r\n  const radius  = Math.min(w, h) / 2 - 80;\r\n  const padH    = 12;\r\n  const linkDur = 800;\r\n  const zoomMin = 0.5, zoomMax = 3;\r\n\r\n  // 1) Tạo container đặt giữa và xoay -90° để root hướng lên trên\r\n  const g = svg.append('g')\r\n    .attr('transform', `translate(${w/2},${h/2}) rotate(0)`);\r\n\r\n  // 2) Bật zoom & pan\r\n  svg.call(\r\n    d3.zoom().scaleExtent([zoomMin, zoomMax])\r\n      .on('zoom', ({transform}) => g.attr('transform', transform))\r\n  );\r\n\r\n  // 3) Build hierarchy + radial layout chỉ để lấy góc\r\n  const root = d3.hierarchy(vm.buildHierarchy(vm.mindmapObject));\r\n  d3.cluster().size([2 * Math.PI, radius])(root);\r\n\r\n  // 4) Tính yOffset: mỗi đoạn nhánh dài = width(text) + padH\r\n  root.each(d => {\r\n    if (d.depth === 0) {\r\n      d.yOffset = 0;\r\n    } else {\r\n      const wTxt = vm.textWidth(d.data.name);\r\n      d.yOffset = d.parent.yOffset + wTxt + padH;\r\n    }\r\n  });\r\n\r\n  // 5) Vẽ & animate đường link, gán id để textPath\r\n  const linkGen = d3.linkRadial().angle(d => d.x).radius(d => d.yOffset);\r\n  g.append('g').selectAll('path')\r\n    .data(root.links()).enter().append('path')\r\n      .attr('class', 'link')\r\n      .attr('id', (d,i) => `link${i}`)\r\n      .attr('d', d => {\r\n        // 1) Lấy path gốc\r\n        const base = linkGen(d);\r\n        // 2) Tính góc & bán kính cuối\r\n        const θ = d.target.x - Math.PI/2;\r\n        const r = d.target.yOffset;\r\n        // 3) Độ dài muốn mở rộng\r\n        const ext = vm.textWidth(d.target.data.name) + padH;\r\n        // 4) Tọa độ extended point\r\n        const x3 = (r + ext) * Math.cos(θ),\r\n              y3 = (r + ext) * Math.sin(θ);\r\n        // 5) Nối thẳng ra thêm\r\n        return `${base}L${x3},${y3}`;\r\n      })\r\n      .attr('fill', 'none')\r\n      .attr('stroke', 'aqua')\r\n      .attr('stroke-width', d => d.source.depth === 0 ? 8 : 2)\r\n      .attr('stroke-dasharray', function() {\r\n        const L = this.getTotalLength();\r\n        return `${L} ${L}`;\r\n      })\r\n      .attr('stroke-dashoffset', function() { return this.getTotalLength(); })\r\n      .transition()\r\n        .duration(linkDur)\r\n        .ease(d3.easeCubicOut)\r\n        .attr('stroke-dashoffset', 0)\r\n        .on('end', () => { this.creatingTopic = ''; });\r\n\r\n  // 6) Vẽ text theo đường link, phân biệt nhánh chính (depth=1) & phụ\r\n  g.append('g').selectAll('text')\r\n    .data(root.links()).enter().append('text')\r\n      .append('textPath')\r\n        .attr('xlink:href', (d,i) => `#link${i}`)\r\n        .attr('startOffset', d => d.target.depth === 1 ? '35%' : '50%')\r\n        .style('font-size', d => d.target.depth === 1 ? '14px' : '10px')\r\n        .style('fill', '#333')\r\n        .text(d => d.target.data.name);\r\n\r\n  // 7) Vẽ root node (ellipse + text) với tối đa 4 ký tự mỗi dòng\r\n  const label = root.data.root || root.data.name;\r\n  const wTxt  = vm.textWidth(label);\r\n  const rootG = g.append('g')\r\n    .attr('transform', 'translate(0,20)'); // xuống 20px\r\n  rootG.append('ellipse')\r\n    .attr('rx', wTxt / 2 + padH)\r\n    .attr('ry', padH + 7)\r\n    .attr('fill', '#fff')\r\n    .attr('stroke', '#333')\r\n    .attr('stroke-width', 2);\r\n  rootG.append('text')\r\n    .text(label)\r\n    .attr('text-anchor', 'middle')\r\n    .attr('dy', '0.35em')\r\n    .style('font-size', '14px')\r\n    .style('font-weight', 'bold');\r\n},\r\nwrapText(textSel, maxWidth, lineHeight = 1.2) {\r\n    textSel.each(function() {\r\n      const text = d3.select(this);\r\n      const words = text.text().split(/\\s+/);\r\n      text.text(null);\r\n\r\n      let line = [];\r\n      const x  = text.attr('x');\r\n      const y  = text.attr('y');\r\n      const dy = parseFloat(text.attr('dy')) || 0;\r\n\r\n      // tspan đầu\r\n      let tspan = text.append('tspan')\r\n        .attr('x', x)\r\n        .attr('y', y)\r\n        .attr('dy', `${dy}em`);\r\n\r\n      for (let i = 0; i < words.length; i++) {\r\n        line.push(words[i]);\r\n        tspan.text(line.join(' '));\r\n        if (tspan.node().getComputedTextLength() > maxWidth && line.length > 1) {\r\n          // bỏ từ cuối ra dòng kế\r\n          line.pop();\r\n          tspan.text(line.join(' '));\r\n          line = [words[i]];\r\n          tspan = text.append('tspan')\r\n            .attr('x', x)\r\n            .attr('y', y)\r\n            .attr('dy', `${lineHeight}em`)\r\n            .text(words[i]);\r\n        }\r\n      }\r\n    });\r\n  },\r\n  chunkText(text, wordsPerLine = 3) {\r\n      const words = text.split(/\\s+/);\r\n      const lines = [];\r\n      for (let i = 0; i < words.length; i += wordsPerLine) {\r\n        lines.push(words.slice(i, i + wordsPerLine).join(' '));\r\n      }\r\n      return lines;\r\n    },\r\n    drawBubbleMap(svg) {\r\n      const vm = this;\r\n      const w  = svg.node().clientWidth;\r\n      const h  = svg.node().clientHeight;\r\n      const cx = w / 2;\r\n      const cy = h / 2;\r\n\r\n      // 1) Xóa cũ và tạo group\r\n      svg.selectAll('*').remove();\r\n      const g = svg.append('g');\r\n      svg.call(\r\n        d3.zoom().scaleExtent([0.5, 3])\r\n          .on('zoom', ({ transform }) => g.attr('transform', transform))\r\n      );\r\n\r\n      // 2) Lấy dữ liệu và số nhánh chính\r\n      const data     = vm.buildHierarchy(vm.mindmapObject);\r\n      const branches = data.children || [];\r\n      const Nroot    = Math.max(1, branches.length);\r\n\r\n      // 3) Tham số chung\r\n      const padH         = 8;\r\n      const font0        = '16px sans-serif';\r\n      const font1        = '12px sans-serif';\r\n      const linkLen1     = 120;\r\n      const linkLen2Base = 60;\r\n      const extraLeaf    = 60; // +60px cho nhánh cuối\r\n\r\n      // Hàm đệ quy vẽ node với animate\r\n      function drawNode(node, x, y, depth, baseAngle) {\r\n        // a) Wrap text mỗi 3 từ\r\n        const words = node.name.split(/\\s+/);\r\n        const lines = [];\r\n        for (let i = 0; i < words.length; i += 3) {\r\n          lines.push(words.slice(i, i + 3).join(' '));\r\n        }\r\n\r\n        // b) Tính bán kính động\r\n        const font     = depth === 0 ? font0 : font1;\r\n        const maxW     = Math.max(...lines.map(l => vm.textWidth(l, font)));\r\n        const defaultR = depth === 0 ? 80 : 40;\r\n        const rDyn     = Math.max(defaultR, maxW / 2 + padH);\r\n\r\n        // c) Vẽ circle (ẩn)\r\n        const circ = g.append('circle')\r\n          .attr('cx', x)\r\n          .attr('cy', y)\r\n          .attr('r', rDyn)\r\n          .attr('fill', depth === 0 ? 'aqua' : 'white')\r\n          .attr('stroke', depth === 0 ? '#333' : '#007bff')\r\n          .attr('stroke-width', depth === 0 ? 2 : 1.5)\r\n          .attr('opacity', 0);\r\n\r\n        // d) Vẽ text (ẩn)\r\n        const txt = g.append('text')\r\n          .attr('x', x)\r\n          .attr('y', y - (lines.length - 1) * 6)\r\n          .attr('text-anchor', 'middle')\r\n          .attr('dominant-baseline', 'middle')\r\n          .style('font-size', depth === 0 ? '18px' : (depth===1 ? '14px':'10px'))\r\n          .style('fill', '#333')\r\n          .attr('opacity', 0);\r\n        lines.forEach((ln, i) => {\r\n          txt.append('tspan')\r\n            .attr('x', x)\r\n            .attr('dy', i === 0 ? '0em' : '1.2em')\r\n            .text(ln);\r\n        });\r\n\r\n        // e) Nếu lá thì show ngay\r\n        const kids = node.children || [];\r\n        if (!kids.length) {\r\n          circ.transition().delay(400).duration(300).attr('opacity', 1);\r\n          txt.transition().delay(400).duration(300).attr('opacity', 1);\r\n          return;\r\n        }\r\n\r\n        // f) Tính sector cho nhánh\r\n        if (depth === 0) {\r\n          // Nhánh chính: căn giữa sector\r\n          const radSector = 2 * Math.PI / Nroot;\r\n          for (let i = 0; i < Nroot; i++) {\r\n            const θ  = -Math.PI/2 + radSector/2 + i * radSector;\r\n            const len = linkLen1;\r\n            const x1  = x + Math.cos(θ) * rDyn;\r\n            const y1  = y + Math.sin(θ) * rDyn;\r\n            const x2  = x + Math.cos(θ) * (rDyn + len);\r\n            const y2  = y + Math.sin(θ) * (rDyn + len);\r\n\r\n            // line animate\r\n            g.append('line')\r\n              .attr('x1', x1).attr('y1', y1)\r\n              .attr('x2', x1).attr('y2', y1)\r\n              .attr('stroke', '#aaa').attr('stroke-width', 2)\r\n              .transition().duration(500)\r\n                .attr('x2', x2).attr('y2', y2)\r\n              .on('end', () => {\r\n                circ.transition().duration(300).attr('opacity', 1);\r\n                txt.transition().duration(300).attr('opacity', 1);\r\n                drawNode(kids[i], x2, y2, 1, θ);\r\n              });\r\n          }\r\n        } else {\r\n          // Cấp >=1: vẫn chia sector khớp branch gốc\r\n          const radSector = 2 * Math.PI / Nroot;\r\n          const startAng  = baseAngle - radSector/2;\r\n          const countSub  = kids.length;\r\n          for (let i = 0; i < countSub; i++) {\r\n            const θ   = startAng + radSector * (i/(countSub-1||1));\r\n            let len = linkLen2Base + (countSub - 1) * 20;\r\n            // nếu leaf cấp 2 thì kéo dài thêm\r\n            if (!kids[i].children?.length) len += extraLeaf;\r\n\r\n            const x1 = x + Math.cos(θ) * rDyn;\r\n            const y1 = y + Math.sin(θ) * rDyn;\r\n            const x2 = x + Math.cos(θ) * (rDyn + len);\r\n            const y2 = y + Math.sin(θ) * (rDyn + len);\r\n\r\n            g.append('line')\r\n              .attr('x1', x1).attr('y1', y1)\r\n              .attr('x2', x1).attr('y2', y1)\r\n              .attr('stroke', '#aaa').attr('stroke-width', 2)\r\n              .transition().duration(500)\r\n                .attr('x2', x2).attr('y2', y2)\r\n              .on('end', () => {\r\n                circ.transition().duration(300).attr('opacity', 1);\r\n                txt.transition().duration(300).attr('opacity', 1);\r\n                drawNode(kids[i], x2, y2, depth + 1, θ);\r\n              });\r\n          }\r\n        }\r\n      }\r\n\r\n      // 5) Bắt đầu vẽ từ root\r\n      drawNode(data, cx, cy, 0, 0);\r\n  \r\n    },\r\n    drawFlowMap(svg) {\r\n  const vm = this;\r\n\r\n  // 1) reset + marker arrow\r\n  svg.selectAll('*').remove();\r\n  const defs = svg.append('defs');\r\n\r\n  // --- Định nghĩa marker arrow ---\r\n  defs.append('marker')\r\n    .attr('id','arrow')\r\n    .attr('viewBox','0 -5 10 10')\r\n    .attr('refX',10).attr('refY',0)\r\n    .attr('markerWidth',6).attr('markerHeight',6)\r\n    .attr('orient','auto')\r\n    .append('path')\r\n      .attr('d','M0,-5L10,0L0,5')\r\n      .attr('fill','#888');\r\n\r\n  // --- Định nghĩa gradient cho node ---\r\n  // Linear gradient từ trắng sang xanh nhẹ (có thể thay màu tuỳ ý)\r\n  const grad = defs.append('linearGradient')\r\n    .attr('id', 'nodeGradient')\r\n    .attr('x1', '0%').attr('y1', '0%')\r\n    .attr('x2', '100%').attr('y2', '100%');\r\n\r\n  grad.append('stop')\r\n    .attr('offset', '0%')\r\n    .attr('stop-color', '#ffffff'); // Trắng ở góc trên-trái\r\n  grad.append('stop')\r\n    .attr('offset', '100%')\r\n    .attr('stop-color', '#e0f7fa'); // Xanh nhạt ở góc dưới-phải\r\n\r\n  // 2) container + zoom/pan\r\n  const offsetX = 200, offsetY = 20;\r\n  const g = svg.append('g')\r\n    .attr('transform', `translate(${offsetX},${offsetY})`);\r\n  svg.call(\r\n    d3.zoom()\r\n      .scaleExtent([0.1,4])\r\n      .on('zoom', ({transform}) => g.attr('transform', transform))\r\n  );\r\n\r\n  // 3) hierarchy + tree layout\r\n  const data = vm.buildHierarchy(vm.mindmapObject);\r\n  const root = d3.hierarchy(data);\r\n  const treeLayout = d3.tree()\r\n    .nodeSize([80, 200])\r\n    .separation((a, b) => a.parent === b.parent ? 1 : 2);\r\n  treeLayout(root);\r\n\r\n  // 4) link generator\r\n  const linkGen = d3.linkHorizontal()\r\n    .x(d => d.y)\r\n    .y(d => d.x);\r\n\r\n  // 5) draw & animate links\r\n  g.selectAll('path.link')\r\n    .data(root.links())\r\n    .enter().append('path')\r\n      .attr('class', 'link')\r\n      .attr('d', linkGen)\r\n      .attr('fill','none')\r\n      .attr('stroke','aqua')        // Chuyển thành màu aqua\r\n      .attr('stroke-width',2)\r\n      .attr('marker-end','url(#arrow)')\r\n      // Chuẩn bị animation\r\n      .attr('stroke-dasharray', function() {\r\n        const L = this.getTotalLength();\r\n        return `${L} ${L}`;\r\n      })\r\n      .attr('stroke-dashoffset', function() {\r\n        return this.getTotalLength();\r\n      })\r\n    .transition()\r\n      // Delay theo depth để vẽ từ gốc trước, ra xa sau\r\n      .delay(d => d.source.depth * 300)\r\n      .duration(600)\r\n      .ease(d3.easeLinear)\r\n      .attr('stroke-dashoffset', 0);\r\n\r\n  // 6) wrap 4 từ 1 dòng\r\n  function wrap4(text) {\r\n    const words = text.split(/\\s+/), lines = [];\r\n    for (let i = 0; i < words.length; i += 3) {\r\n      lines.push(words.slice(i, i+3).join(' '));\r\n    }\r\n    return lines;\r\n  }\r\n\r\n  // 7) draw nodes\r\n  const nodes = g.selectAll('g.node')\r\n    .data(root.descendants())\r\n    .enter().append('g')\r\n      .attr('class','node')\r\n      .attr('transform', d => {\r\n        const extraX = d.depth === 1 ? 100 : 0;\r\n        return `translate(${d.y + extraX},${d.x})`;\r\n      });\r\n\r\n  // 8) tất cả node (kể cả root và non-root) sẽ dùng gradient làm fill\r\n  nodes.each((d, i, els) => {\r\n    const nd = d3.select(els[i]);\r\n    const lines = wrap4(d.data.name);\r\n    // Font size giảm dần theo depth; root (depth=0) sẽ to nhất\r\n    const baseSize = 20; // bạn có thể tăng hoặc giảm baseSize tuỳ thích\r\n    const fontSize = Math.max(8, baseSize - d.depth * 2); \r\n    const font = `${fontSize}px sans-serif`;\r\n\r\n    if (d.depth === 0) {\r\n      // --- Root node: vẽ circle ---\r\n      // Tính toán kích thước circle dựa vào độ rộng text\r\n      const maxW = Math.min(200,\r\n        Math.max(...lines.map(l => vm.textWidth(l, font)))\r\n      );\r\n      const r = maxW/2 + 20;\r\n\r\n      nd.append('circle')\r\n        .attr('r', r)\r\n        .attr('fill', 'url(#nodeGradient)')    // fill bằng gradient\r\n        .attr('stroke','#333')\r\n        .attr('stroke-width',4);\r\n\r\n      // Thêm text ở giữa\r\n      const textEl = nd.append('text')\r\n        .attr('text-anchor','middle')\r\n        .attr('dominant-baseline','middle')\r\n        .style('font-size', font)\r\n        .style('font-weight','bold');\r\n\r\n      lines.forEach((ln, idx) => {\r\n        textEl.append('tspan')\r\n          .attr('x', 0)\r\n          .attr('dy', idx === 0 ? `-${(lines.length-1)*0.6}em` : '1.2em')\r\n          .text(ln);\r\n      });\r\n    } else {\r\n      // --- Non-root nodes: vẽ rect ---\r\n      const padH = 6, padV = 4;\r\n      const maxW = Math.max(...lines.map(l => vm.textWidth(l, font)));\r\n      const wRect = maxW + padH * 6;\r\n      const hRect = lines.length * 20 + padV * 2;\r\n\r\n      nd.append('rect')\r\n        .attr('x', d.children ? -wRect - 4 : 4)\r\n        .attr('y', -hRect/2)\r\n        .attr('width', wRect)\r\n        .attr('height', hRect)\r\n        .attr('rx', 4).attr('ry', 4)\r\n        .attr('fill', 'url(#nodeGradient)')   // fill bằng gradient\r\n        .attr('stroke','#007bff')\r\n        .attr('stroke-width',1.5);\r\n\r\n      // Thêm text bên trong rect\r\n      const textEl = nd.append('text')\r\n        .attr('text-anchor', d.children ? 'end' : 'start')\r\n        .attr('dominant-baseline','middle')\r\n        .style('font-size', font);\r\n\r\n      // Nếu có bật includeImage và có ảnh\r\n      if (this.includeImage && this.leafImages[d.data.name]) {\r\n        const xOff = d.children\r\n          ? -wRect - 10  // nếu có children: ảnh nằm bên trái\r\n          : wRect + 10;  // ngược lại: ảnh bên phải\r\n        nd.append('image')\r\n          .attr('href', this.leafImages[d.data.name])\r\n          .attr('x', xOff)\r\n          .attr('y', -hRect / 2)\r\n          .attr('width', 50)\r\n          .attr('height', 50);\r\n      }\r\n\r\n      lines.forEach((ln, idx) => {\r\n        textEl.append('tspan')\r\n          .attr('x', d.children ? -padH - 4 : padH + 4)\r\n          .attr('dy', idx === 0 ? `-${(lines.length-1)*0.6}em` : '1.2em')\r\n          .text(ln);\r\n      });\r\n    }\r\n  });\r\n\r\n  // 9) (Nếu bạn chỉ muốn thêm ảnh cho leaf nodes, đã được xử lý ở trên)\r\n  // Không cần đoạn code thêm image phía ngoài nữa vì đã gộp chung vào trên.\r\n},\r\ndrawMultiFlowMap(svg) {\r\n  const vm = this;\r\n  const w = svg.node().clientWidth;\r\n  const h = svg.node().clientHeight;\r\n\r\n  // 1) Clear & marker\r\n  svg.selectAll('*').remove();\r\n  const defs = svg.append('defs');\r\n\r\n  // --- Định nghĩa marker arrow ---\r\n  defs.append('marker')\r\n    .attr('id', 'arrow')\r\n    .attr('viewBox', '0 -5 10 10')\r\n    .attr('refX', 5)\r\n    .attr('refY', 0)\r\n    .attr('markerWidth', 6)\r\n    .attr('markerHeight', 6)\r\n    .attr('orient', 'auto')\r\n    .append('path')\r\n      .attr('d', 'M0,-5L10,0L0,5')\r\n      .attr('fill', '#888');\r\n\r\n  // --- Định nghĩa gradient cho node ---\r\n  const grad = defs.append('linearGradient')\r\n    .attr('id', 'nodeGradient')\r\n    .attr('x1', '0%').attr('y1', '0%')\r\n    .attr('x2', '100%').attr('y2', '100%');\r\n  grad.append('stop')\r\n    .attr('offset', '0%')\r\n    .attr('stop-color', '#ffffff'); // Trắng ở góc trên-trái\r\n  grad.append('stop')\r\n    .attr('offset', '100%')\r\n    .attr('stop-color', '#e0f7fa'); // Xanh nhạt ở góc dưới-phải\r\n\r\n  // 2) Container + zoom/pan\r\n  const g = svg.append('g')\r\n    .attr('transform', `translate(${w/2},${h/2})`);\r\n  svg.call(\r\n    d3.zoom().scaleExtent([0.1, 4])\r\n      .on('zoom', ({transform}) => g.attr('transform', transform))\r\n  );\r\n\r\n  // 3) Text wrap utility\r\n  function wrap4(txt) {\r\n    if (typeof txt !== 'string') txt = '';\r\n    const words = txt.split(/\\s+/), lines = [];\r\n    for (let i = 0; i < words.length; i += 3) {\r\n      lines.push(words.slice(i, i + 3).join(' '));\r\n    }\r\n    return lines;\r\n  }\r\n\r\n  // 4) Build hierarchy & split\r\n  const treeObj   = vm.buildHierarchy(vm.mindmapObject);\r\n  const allKids   = treeObj.children || [];\r\n  const half      = Math.ceil(allKids.length / 2);\r\n  const leftKids  = allKids.slice(0, half);\r\n  const rightKids = allKids.slice(half);\r\n  const leftRoot  = d3.hierarchy({ children: leftKids }, d => d.children);\r\n  const rightRoot = d3.hierarchy({ children: rightKids }, d => d.children);\r\n\r\n  // 5) Layout\r\n  const vert = 100, hor = 300;\r\n  const layout = d3.tree().nodeSize([vert, hor]).separation((a,b) => a.parent === b.parent ? 1 : 2);\r\n  layout(leftRoot);\r\n  layout(rightRoot);\r\n\r\n  // 6) Vertical center\r\n  const leftYs   = leftRoot.descendants().map(d => d.x);\r\n  const rightYs  = rightRoot.descendants().map(d => d.x);\r\n  const leftMid  = (d3.min(leftYs) + d3.max(leftYs)) / 2;\r\n  const rightMid = (d3.min(rightYs) + d3.max(rightYs)) / 2;\r\n\r\n  // 7) Root metrics & shift\r\n  const rootLines  = wrap4(treeObj.name);\r\n  const baseSize   = 20;         // Kích thước font gốc cho root (depth = 0)\r\n  const font0      = `${baseSize}px sans-serif`;\r\n  const maxRW      = Math.min(200, Math.max(...rootLines.map(l => vm.textWidth(l, font0))));\r\n  const r0         = maxRW / 2 + 20;\r\n  const rootShiftX = 30;\r\n\r\n  // 8) Marker & margin params\r\n  const padH         = 6;\r\n  const padV         = 4;\r\n  const markerAdjust = 4;\r\n  const marginLeft   = -80;\r\n  const marginRight  = 100;\r\n\r\n  // computeShift: để căn chỉnh vị trí mũi tên chạm đúng biên node\r\n  function computeShift(name, depth) {\r\n    // depth ở đây là depth tính theo cây nhỏ (subtree).\r\n    // Font size cũng tính dựa vào depth\r\n    const fontSize = Math.max(8, baseSize - depth * 2);\r\n    const font = `${fontSize}px sans-serif`;\r\n    const lines = wrap4(name);\r\n    const maxW = Math.max(...lines.map(l => vm.textWidth(l, font)));\r\n    const rectW = maxW + padH * 6;\r\n    return rectW / 2 + markerAdjust;\r\n  }\r\n\r\n  // 9) Draw links under nodes\r\n  const doLinks = (root, flip) => {\r\n    const linkGen = d3.linkHorizontal()\r\n      .x(d => flip ? -d.y : d.y)\r\n      .y(d => d.x);\r\n\r\n    g.append('g').selectAll('path.link').data(root.links()).enter().append('path')\r\n      .attr('class','link')\r\n      .attr('fill','none')\r\n      .attr('stroke','aqua')          // Chuyển sang màu aqua\r\n      .attr('stroke-width',2)\r\n      .attr('marker-end','url(#arrow)')\r\n      .attr('stroke-dasharray', function() {\r\n        const L = this.getTotalLength();\r\n        return `${L} ${L}`;\r\n      })\r\n      .attr('stroke-dashoffset', function() {\r\n        return this.getTotalLength();\r\n      })\r\n      .attr('d', d => {\r\n        // Tính toán vị trí nguồn và đích, căn giữa theo mid\r\n        const vSrc = d.source.x - (flip ? rightMid : leftMid);\r\n        const vTgt = d.target.x - (flip ? rightMid : leftMid);\r\n\r\n        // Đối với source (nút cha), nếu depth = 0 (root của subtree),\r\n        // cần cộng thêm bán kính r0 để link chạm đúng biên\r\n        const hSrc = d.source.y + (d.source.depth === 0 ? (flip ? -r0 : r0) : 0);\r\n\r\n        // Đối với target, căn chỉnh để mũi tên chạm đúng biên rect\r\n        let hTgt = d.target.y;\r\n        const shift = computeShift(d.target.data.name, d.target.depth);\r\n        if (!flip && d.target.depth === 1)       hTgt += shift;\r\n        if (flip && !d.target.children)          hTgt -= shift;\r\n\r\n        return linkGen({\r\n          source: { x: vSrc, y: hSrc },\r\n          target: { x: vTgt, y: hTgt }\r\n        });\r\n      })\r\n      .transition()\r\n        .delay(d => d.source.depth * 300)\r\n        .duration(600)\r\n        .ease(d3.easeLinear)\r\n        .attr('stroke-dashoffset', 0);\r\n  };\r\n  doLinks(leftRoot, true);\r\n  doLinks(rightRoot, false);\r\n\r\n  // 10) Draw root above links\r\n  const rootG = g.append('g').attr('transform', `translate(${rootShiftX},0)`);\r\n  rootG.append('circle')\r\n    .attr('r', r0)\r\n    .attr('fill', 'url(#nodeGradient)') // Fill bằng gradient\r\n    .attr('stroke', '#333')\r\n    .attr('stroke-width', 4);\r\n\r\n  const rt = rootG.append('text')\r\n    .attr('text-anchor', 'middle')\r\n    .attr('dominant-baseline', 'middle')\r\n    .style('font-size', font0)\r\n    .style('font-weight', 'bold');\r\n  rootLines.forEach((ln, i) => {\r\n    rt.append('tspan')\r\n      .attr('x', 0)\r\n      .attr('dy', i === 0 ? `-${(rootLines.length - 1) * 0.6}em` : '1.2em')\r\n      .text(ln);\r\n  });\r\n\r\n  // 11) Draw nodes above links\r\n  const doNodes = (root, flip) => {\r\n    g.append('g').selectAll('g.node').data(root.descendants().slice(1)).enter().append('g')\r\n      .attr('class','node')\r\n      .attr('transform', d => {\r\n        const v = d.x - (flip ? rightMid : leftMid);\r\n        let h = d.y;\r\n        if (!flip && d.depth === 1)  h += marginRight;\r\n        if (flip && !d.children)      h -= marginLeft;\r\n        const x = flip ? -h : h;\r\n        return `translate(${x},${v})`;\r\n      })\r\n      .each(function(d) {\r\n        const nd = d3.select(this);\r\n        const lines = wrap4(d.data.name);\r\n\r\n        // --- Tính font size giảm dần theo depth ---\r\n        const fontSize = Math.max(8, baseSize - d.depth * 2);\r\n        const textFont = `${fontSize}px sans-serif`;\r\n\r\n        // Tính kích thước rect dựa vào textFont\r\n        const maxW = Math.max(...lines.map(l => vm.textWidth(l, textFont)));\r\n        const wRect = maxW + padH * 6;\r\n        const hRect = lines.length * 20 + padV * 2;\r\n\r\n        // Vẽ rect với gradient\r\n        nd.append('rect')\r\n          .attr('x', d.children ? -wRect - 4 : 4)\r\n          .attr('y', -hRect / 2)\r\n          .attr('width', wRect)\r\n          .attr('height', hRect)\r\n          .attr('rx', 4).attr('ry', 4)\r\n          .attr('fill', 'url(#nodeGradient)')  // background gradient\r\n          .attr('stroke', '#007bff')\r\n          .attr('stroke-width', 1.5);\r\n\r\n        // Thêm text bên trong rect, với font size đã tính\r\n        const t = nd.append('text')\r\n          .attr('text-anchor', d.children ? 'end' : 'start')\r\n          .attr('dominant-baseline', 'middle')\r\n          .style('font-size', textFont);\r\n\r\n        lines.forEach((ln, i) => {\r\n          t.append('tspan')\r\n            .attr('x', d.children ? -padH - 4 : padH + 4)\r\n            .attr('dy', i === 0 ? `-${(lines.length - 1) * 0.6}em` : '1.2em')\r\n            .text(ln);\r\n        });\r\n      });\r\n  };\r\n  doNodes(leftRoot, true);\r\n  doNodes(rightRoot, false);\r\n},\r\n\r\ndrawBraceMap(svg) {\r\n  const w = svg.node().clientWidth;\r\n  const h = svg.node().clientHeight;\r\n\r\n  // — Clear old elements —\r\n  svg.selectAll('*').remove();\r\n\r\n  // — Build hierarchy & initial layout —\r\n  const root = d3.hierarchy(this.buildHierarchy(this.mindmapObject));\r\n  d3.tree().size([w - 100, h - 100])(root);\r\n  const level1Count = root.children ? root.children.length : 0;\r\n  root.x = 200 * level1Count;\r\n\r\n  // — Create group at center apex + zoom support —\r\n  const g = svg.append('g')\r\n    .attr('transform', `translate(${w/2},20)`);\r\n  svg.call(\r\n    d3.zoom()\r\n      .scaleExtent([0.5, 3])\r\n      .on('zoom', ({ transform }) => {\r\n        g.attr('transform', `translate(${transform.x + w/2},${transform.y + 20}) scale(${transform.k})`);\r\n      })\r\n  );\r\n\r\n  // — Fan-out leaf nodes under each level-1 node —\r\n  const leafYSpacing = 100;\r\n  const leafXSpacing = 120;\r\n  const level1MarginX = 500;\r\n  (root.children || []).forEach((parent, i) => { parent.x = i * level1MarginX; });\r\n  root.children.forEach(parent => {\r\n    const leaves = parent.children || [];\r\n    const n = leaves.length;\r\n    leaves.forEach((leaf, i) => {\r\n      leaf.x = parent.x + (i - (n - 1) / 2) * leafXSpacing;\r\n      leaf.y = parent.y + leafYSpacing;\r\n    });\r\n  });\r\n\r\n  // — Draw & animate links —\r\n  const links = g.append('g').selectAll('path.link')\r\n    .data(root.links())\r\n    .enter().append('path')\r\n      .attr('class', 'link')\r\n      .attr('d', d => d.target.depth === 2\r\n        ? `M${d.source.x},${d.source.y}L${d.source.x},${d.target.y}L${d.target.x},${d.target.y}`\r\n        : `M${d.source.x},${d.source.y}L${d.target.x},${d.target.y}`\r\n      )\r\n      .attr('fill', 'none')\r\n      .attr('stroke', '#555')\r\n      .attr('marker-end', 'url(#arrow)')\r\n      .each(function() {\r\n        const total = this.getTotalLength();\r\n        d3.select(this)\r\n          .attr('stroke-dasharray', `${total} ${total}`)\r\n          .attr('stroke-dashoffset', total);\r\n      });\r\n  links.transition()\r\n    .delay(d => d.source.depth * 300)\r\n    .duration(600)\r\n    .attr('stroke-dashoffset', 0)\r\n    .ease(d3.easeLinear);\r\n\r\n  // — Draw & animate nodes —\r\n  const wrapLines = txt => {\r\n    const words = (txt || '').split(/\\s+/);\r\n    const lines = [];\r\n    for (let i = 0; i < words.length; i += 3) {\r\n      lines.push(words.slice(i, i + 3).join(' '));\r\n    }\r\n    return lines;\r\n  };\r\n\r\n  const nodes = g.append('g').selectAll('g.node')\r\n    .data(root.descendants())\r\n    .enter().append('g')\r\n      .attr('class', 'node')\r\n      .attr('transform', d => `translate(${d.x},${d.y})`)\r\n      .attr('opacity', 0);\r\n\r\n  nodes.each(function(d) {\r\n    const nd = d3.select(this);\r\n    const lines = wrapLines(d.data.name);\r\n    // Set style by depth\r\n    let fontSize, pad, strokeWidth;\r\n    if (d.depth === 0) {\r\n      fontSize = 18; pad = 15; strokeWidth = 3;\r\n    } else if (d.depth === 1) {\r\n      fontSize = 14; pad = 10; strokeWidth = 2;\r\n    } else {\r\n      fontSize = 10; pad = 6; strokeWidth = 1;\r\n    }\r\n    const text = nd.append('text')\r\n      .attr('text-anchor', 'middle')\r\n      .attr('dominant-baseline', 'middle')\r\n      .style('font-size', `${fontSize}px`);\r\n    lines.forEach((ln, i) => {\r\n      text.append('tspan')\r\n        .attr('x', 0)\r\n        .attr('dy', i === 0 ? `-${(lines.length - 1) * 0.6}em` : '1.2em')\r\n        .text(ln);\r\n    });\r\n    const bbox = text.node().getBBox();\r\n    nd.insert('rect', 'text')\r\n      .attr('x', bbox.x - pad)\r\n      .attr('y', bbox.y - pad)\r\n      .attr('width', bbox.width + pad * 2)\r\n      .attr('height', bbox.height + pad * 2)\r\n      .attr('rx', pad/2)\r\n      .attr('ry', pad/2)\r\n      .attr('fill', 'white')\r\n      .attr('stroke', 'purple')\r\n      .attr('stroke-width', strokeWidth);\r\n  });\r\n\r\n  nodes.transition()\r\n    .delay(d => d.depth * 300 + 600)\r\n    .duration(600)\r\n    .attr('opacity', 1);\r\n\r\n},\r\n    buildHierarchy(obj) {\r\n      const root = { name: obj.root, children: [] };\r\n      (obj.branches||[]).forEach(b => {\r\n        const node = { name: b.title, children: [] };\r\n        (b.subBranches||[]).forEach(s => node.children.push({ name: s }));\r\n        root.children.push(node);\r\n      });\r\n      return root;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.panel {\r\n  display: flex;\r\n  height: 100vh;\r\n  padding: 16px;\r\n  gap: 16px;\r\n  font-family: Arial, sans-serif;\r\n  width: 100%;\r\n}\r\n\r\n.left-panel {\r\n  width: 20%;\r\n  background: radial-gradient(rgb(173, 252, 252),white);\r\n  padding: 16px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  overflow-y: auto;\r\n  transition: all 0.3s ease;\r\n}\r\n.left-panel h3{\r\n  text-align: center;\r\n}\r\n.left-panel.hidden {\r\n  width: 0;\r\n  padding: 0;\r\n  margin: 0;\r\n  overflow: hidden;\r\n}\r\n\r\n.suggestion-item {\r\n  position: relative;\r\n  margin-bottom: 12px;\r\n  list-style: none;\r\n  margin-left: 0;\r\n}\r\n\r\n.close-btn {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  border: none;\r\n  background: transparent;\r\n  font-size: 18px;\r\n  cursor: pointer;\r\n}\r\n\r\n.right-panel {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n  transition: width 0.3s ease;\r\n}\r\n\r\n.right-panel.full {\r\n  width: 100%;\r\n}\r\n\r\n.mindmap-display {\r\n  flex-grow: 1;\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  padding: 16px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  overflow: auto;\r\n}\r\n\r\n.mindmap-image {\r\n  max-width: 100%;\r\n  border-radius: 8px;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.input-container {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  background: #fff;\r\n  padding: 8px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\ninput[type=\"text\"] {\r\n  flex-grow: 1;\r\n  padding: 8px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n}\r\n\r\n.option-select {\r\n  padding: 8px;\r\n  border-radius: 4px;\r\n  border: 1px solid #ccc;\r\n  font-size: 14px;\r\n}\r\n\r\n.file-upload {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  background: #007bff;\r\n  color: white;\r\n  padding: 8px 12px;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.file-upload input {\r\n  display: none;\r\n}\r\n\r\n.create-btn {\r\n  border: none;\r\n  background: #28a745;\r\n  color: white;\r\n  padding: 8px 12px;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.toolbarAI {\r\n  background: linear-gradient(135deg, rgb(77, 70, 70), aqua);\r\n  display: flex;\r\n  padding: 10px;\r\n  width: 100%;\r\n  border-radius: 10px;\r\n}\r\n\r\n.toolbarAI_left {\r\n  width: 40%;\r\n}\r\n\r\n.toolbarAI_right {\r\n  width: 60%;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.toolbarAI_right button {\r\n  border: none;\r\n  padding: 10px 15px;\r\n  border-radius: 8px;\r\n  background-color: white;\r\n  color: #333;\r\n  font-weight: bold;\r\n  transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;\r\n  cursor: pointer;\r\n  margin-right: 10px;\r\n}\r\n\r\n.toolbarAI_right button:hover {\r\n  background-color: yellow;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 12px rgba(0,0,0,0.3);\r\n}\r\n.toolbarAI_left button {\r\n  border: none;\r\n  padding: 10px 15px;\r\n  border-radius: 8px;\r\n  background-color: white;\r\n  color: #333;\r\n  font-weight: bold;\r\n  transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;\r\n  cursor: pointer;\r\n  margin-right: 10px;\r\n}\r\n.toolbarAI_left button:hover {\r\n  background-color: yellow;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 12px rgba(0,0,0,0.3);\r\n}\r\n.toolbarAI_left a{\r\n  text-decoration: none;\r\n  color:black;\r\n}\r\n.AI{\r\n  background: radial-gradient(rgb(173, 252, 252),white);\r\n}\r\n.mindmap-svg {\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #fff;\r\n}\r\n.modal-backdrop { position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center; z-index:1000; }\r\n.modal { background:#fff; padding:20px; border-radius:8px; width:300px; }\r\n.modal h3 { margin:0 0 10px; }\r\n.modal input { width:100%; padding:8px; margin:10px 0; box-sizing:border-box; }\r\n.modal-actions { text-align:right; }\r\n.modal-actions button { margin-left:8px; padding:6px 12px; }\r\n.map-type-select{\r\n  margin-right: 50px;\r\n  width: 100px;\r\n  display: block;\r\n}\r\n.map-type-select select{\r\n  padding: 10px 15px;\r\n  border-radius: 8px;\r\n}\r\n.mindmap-svg text {\r\n  font-family: \"Roboto\", \"Arial\", sans-serif;\r\n  font-size: 14px;\r\n}\r\n.left-panel {\r\n  width: 260px;\r\n  padding: 16px;\r\n  background: #fafafa;\r\n  border-right: 1px solid #ddd;\r\n}\r\n.left-panel.hidden { display: none; }\r\n\r\n.suggestion-list {\r\n  list-style: none;\r\n  margin: 0; padding: 0;\r\n}\r\n.suggestion-item + .suggestion-item { margin-top: 12px; }\r\n\r\n.suggestion-item button {\r\n  margin-left: 0;\r\n  align-items: center;\r\n  width: 100%;\r\n  height:100%;\r\n  border: none;\r\n  background: none;\r\n  cursor: pointer;\r\n  padding: 4px;\r\n  border-radius: 4px;\r\n}\r\n.suggestion-item button img{\r\n  width:100%;\r\n  height:100%;\r\n}\r\n.suggestion-item button:hover { background: #f0f0f0; }\r\n.suggetion-list {\r\n  margin: 0;\r\n  padding-left: 0;\r\n}\r\n.thumb {\r\n  width: 40px;\r\n  height: 40px;\r\n  object-fit: cover;\r\n  margin-right: 8px;\r\n  border-radius: 4px;\r\n}\r\n.title {\r\n  flex: 1;\r\n  text-align: left;\r\n  font-size: 14px;\r\n}\r\n</style>","import { render } from \"./createmmAI.vue?vue&type=template&id=655a8440&scoped=true\"\nimport script from \"./createmmAI.vue?vue&type=script&lang=js\"\nexport * from \"./createmmAI.vue?vue&type=script&lang=js\"\n\nimport \"./createmmAI.vue?vue&type=style&index=0&id=655a8440&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-655a8440\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"login\">\r\n    <div class=\"signin_form\">\r\n      <img src=\"../assets/img/TMIND.png\" alt=\"Logo\" class=\"logo\" /><br />\r\n      <input type=\"email\" name=\"email\" id=\"email\" v-model=\"form.email\" placeholder=\"Nhập email của bạn\" /><br />\r\n      <input type=\"password\" name=\"pass\" id=\"pass\" v-model=\"form.pass\" placeholder=\"Nhập mật khẩu của bạn\" /><br />\r\n      <button type=\"button\" class=\"submit\" @click=\"signin\">Đăng nhập</button>\r\n      <p v-if=\"errorMessage\" class=\"error-msg\">{{ errorMessage }}</p>\r\n      <a href=\"#\" @click.prevent=\"openModal\">Quên mật khẩu?</a>\r\n\r\n      <!-- Modal phục hồi mật khẩu -->\r\n      <div v-if=\"isModalOpen\" class=\"modal-overlay\" style=\"display: flex !important; z-index: 9999;\">\r\n        <div class=\"modal\">\r\n          <!-- Nút đóng modal -->\r\n          <button class=\"close\" @click=\"closeModal\">×</button>\r\n          <h2>Phục hồi mật khẩu</h2>\r\n\r\n          <!-- Bước 1: Nhập email -->\r\n          <div v-if=\"step === 1\">\r\n            <p>Nhập email của bạn:</p>\r\n            <input type=\"text\" v-model=\"identifier\" placeholder=\"Email\" />\r\n            <button @click=\"sendVerificationCode\">Gửi mã xác thực</button>\r\n          </div>\r\n\r\n          <!-- Bước 2: Nhập mã xác thực -->\r\n          <div v-if=\"step === 2\">\r\n            <p>Nhập mã xác thực đã nhận:</p>\r\n            <input type=\"text\" v-model=\"code\" placeholder=\"Mã xác thực\" />\r\n            <button @click=\"verifyCode\">Xác thực mã</button>\r\n          </div>\r\n\r\n          <!-- Bước 3: Nhập mật khẩu mới -->\r\n          <div v-if=\"step === 3\">\r\n            <p>Nhập mật khẩu mới:</p>\r\n            <input type=\"password\" v-model=\"newPassword\" placeholder=\"Mật khẩu mới\" />\r\n            <input type=\"password\" v-model=\"confirmPassword\" placeholder=\"Nhập lại mật khẩu\" />\r\n            <button @click=\"resetPassword\">Đặt lại mật khẩu</button>\r\n          </div>\r\n\r\n          <p v-if=\"errorMessage\" class=\"error-msg\">{{ errorMessage }}</p>\r\n          <p v-if=\"successMessage\" class=\"success-msg\">{{ successMessage }}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <p>Chưa có tài khoản? <router-link to=\"/signup\">Đăng ký ngay</router-link></p>\r\n      <div class=\"login_other\">\r\n        <button class=\"login_gg\" @click=\"loginWithGoogle\">\r\n          Đăng nhập với Google\r\n          <i class=\"fa-brands fa-google\"></i>\r\n        </button>\r\n        <button class=\"login_fb\" @click=\"loginWithFacebook\">\r\n          Đăng nhập với Facebook\r\n          <i class=\"fa-brands fa-facebook\"></i>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { auth, googleProvider, facebookProvider, signInWithPopup } from '../firebase';\r\nimport { authState } from '../authState'; // Đảm bảo alias @ trỏ đến src\r\n\r\nexport default {\r\n  name: \"SignIn\",\r\n  data() {\r\n    return {\r\n      form: {\r\n        email: '',\r\n        pass: ''\r\n      },\r\n      errorMessage: '',\r\n      // Các biến cho modal phục hồi mật khẩu (nếu có)\r\n      isModalOpen: false,\r\n      step: 1,\r\n      identifier: '',\r\n      code: '',\r\n      newPassword: '',\r\n      confirmPassword: '',\r\n      userId: '',\r\n      successMessage: '',\r\n    }\r\n  },\r\n  methods: {\r\n    async signin() {\r\n      this.errorMessage = '';\r\n      try {\r\n        const response = await fetch('/signin', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            email: this.form.email,\r\n            pass: this.form.pass\r\n          })\r\n        });\r\n        const data = await response.json();\r\n        if (response.ok) {\r\n          // Lưu thông tin đăng nhập vào localStorage\r\n          localStorage.setItem('token', data.token);\r\n          localStorage.setItem('userName', data.user.name);\r\n          localStorage.setItem('userIcon', data.user.photoURL);\r\n          localStorage.setItem('provider', 'local');\r\n          // Cập nhật giá trị reactive\r\n          authState.token = data.token;\r\n          authState.userName = data.user.name;\r\n          authState.userIcon = data.user.photoURL;\r\n          this.$router.push('/'); // Chuyển hướng đến trang chủ\r\n        } else {\r\n          this.errorMessage = data.message;\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n        this.errorMessage = 'Đã xảy ra lỗi!';\r\n      }\r\n    },\r\n    async loginWithGoogle() {\r\n      try {\r\n        const result = await signInWithPopup(auth, googleProvider);\r\n        const user = result.user;\r\n        const idToken = await user.getIdToken();\r\n\r\n        // Lưu vào localStorage\r\n        localStorage.setItem('token', idToken);\r\n        localStorage.setItem('provider', 'google');\r\n        localStorage.setItem('userName', user.displayName);\r\n        localStorage.setItem('userEmail', user.email);\r\n        localStorage.setItem('userIcon', user.photoURL);\r\n        const res = await fetch('/saveUser', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            uid: user.uid,\r\n            name: user.displayName,\r\n            email: user.email,\r\n            photoURL: user.photoURL,\r\n            provider: 'google'\r\n          })\r\n        });\r\n        console.log(res)\r\n        // Update reactive authState\r\n        authState.token = localStorage.getItem('token');\r\n        authState.userName = localStorage.getItem('userName');\r\n        authState.userIcon = localStorage.getItem('userIcon');\r\n        this.$router.push('/');\r\n      } catch (error) {\r\n        if (error.code === 'auth/cancelled-popup-request') {\r\n          this.errorMessage = 'Đăng nhập với Google bị hủy. Vui lòng thử lại.';\r\n        } else if (error.code === 'auth/popup-closed-by-user') {\r\n          this.errorMessage = 'Bạn đã đóng cửa sổ đăng nhập. Vui lòng thử lại sau.';\r\n        } else {\r\n          this.errorMessage = error.message;\r\n        }\r\n      }\r\n    },\r\n    async loginWithFacebook() {\r\n      try {\r\n        const result = await signInWithPopup(auth, facebookProvider);\r\n        localStorage.setItem('provider', 'facebook');\r\n        const user = result.user;\r\n        const idToken = await user.getIdToken();\r\n\r\n        localStorage.setItem('token', idToken);\r\n        localStorage.setItem('provider', 'facebook');\r\n        localStorage.setItem('userName', user.displayName);\r\n        localStorage.setItem('userIcon', user.photoURL);\r\n        localStorage.setItem('userEmail', user.email);\r\n        await fetch('/api/auth/saveUser', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            uid: user.uid,\r\n            name: user.displayName,\r\n            email: user.email,\r\n            photoURL: user.photoURL,\r\n            provider: 'facebook'\r\n          })\r\n        });\r\n        // Update reactive authState\r\n        authState.token = localStorage.getItem('token');\r\n        authState.userName = localStorage.getItem('userName');\r\n        authState.userIcon = localStorage.getItem('userIcon');\r\n        this.$router.push('/');\r\n      } catch (error) {\r\n        if (error.code === 'auth/cancelled-popup-request') {\r\n          this.errorMessage = 'Đăng nhập với Facebook bị hủy. Vui lòng thử lại.';\r\n        } else if (error.code === 'auth/popup-closed-by-user') {\r\n          this.errorMessage = 'Bạn đã đóng cửa sổ đăng nhập. Vui lòng thử lại sau.';\r\n        } else {\r\n          this.errorMessage = error.message;\r\n        }\r\n      }\r\n    },\r\n    // Các hàm cho modal phục hồi mật khẩu (openModal, sendVerificationCode, verifyCode, resetPassword) giữ nguyên...\r\n    openModal() {\r\n      this.isModalOpen = true;\r\n      this.step = 1;\r\n      this.identifier = '';\r\n      this.code = '';\r\n      this.newPassword = '';\r\n      this.confirmPassword = '';\r\n      this.userId = '';\r\n      this.errorMessage = '';\r\n      this.successMessage = '';\r\n    },\r\n    closeModal() {\r\n      this.isModalOpen = false;\r\n    },\r\n    async sendVerificationCode() {\r\n      this.errorMessage = '';\r\n      try {\r\n        const payload = { email: this.identifier };\r\n        const response = await fetch('/api/auth/forgot-password', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(payload)\r\n        });\r\n        const data = await response.json();\r\n        if (response.ok) {\r\n          this.successMessage = data.message;\r\n          if (data.userId) {\r\n            this.userId = data.userId;\r\n          }\r\n          this.step = 2;\r\n        } else {\r\n          this.errorMessage = data.message;\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n        this.errorMessage = 'Đã xảy ra lỗi!';\r\n      }\r\n    },\r\n    async verifyCode() {\r\n      this.errorMessage = '';\r\n      try {\r\n        const response = await fetch('/api/auth/verify-code', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ userId: this.userId, code: this.code })\r\n        });\r\n        const data = await response.json();\r\n        if (response.ok) {\r\n          this.successMessage = data.message;\r\n          this.step = 3;\r\n        } else {\r\n          this.errorMessage = data.message;\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n        this.errorMessage = 'Đã xảy ra lỗi!';\r\n      }\r\n    },\r\n    async resetPassword() {\r\n      this.errorMessage = '';\r\n      if (this.newPassword !== this.confirmPassword) {\r\n        this.errorMessage = 'Mật khẩu xác nhận không khớp!';\r\n        return;\r\n      }\r\n      try {\r\n        const response = await fetch('/api/auth/reset-password', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            userId: this.userId,\r\n            code: this.code,\r\n            newPassword: this.newPassword\r\n          })\r\n        });\r\n        const data = await response.json();\r\n        if (response.ok) {\r\n          this.successMessage = data.message;\r\n          setTimeout(() => this.closeModal(), 2000);\r\n        } else {\r\n          this.errorMessage = data.message;\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n        this.errorMessage = 'Đã xảy ra lỗi!';\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n\r\n<style scoped>\r\n/* Sign in */\r\n\r\n/* Container chính */\r\n.login {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  min-height: 100vh;\r\n  background: #eef2f5;\r\n  padding: 20px;\r\n}\r\n\r\n/* Form đăng nhập */\r\n.signin_form {\r\n  width: 35%;\r\n  max-width: 400px;\r\n  background: #fff;\r\n  padding: 30px;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n  text-align: center;\r\n}\r\n\r\n.signin_form .logo {\r\n  width: 200px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n/* Input styling */\r\n.signin_form input {\r\n  width: 90%;\r\n  font-size: 16px;\r\n  margin-bottom: 15px;\r\n  padding: 12px 15px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 8px;\r\n  transition: border 0.3s ease, box-shadow 0.3s ease;\r\n}\r\n\r\n.signin_form input:focus {\r\n  outline: none;\r\n  border-color: #007bff;\r\n  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);\r\n}\r\n\r\n/* Nút đăng nhập */\r\n.submit {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border: none;\r\n  border-radius: 25px;\r\n  background: linear-gradient(45deg, rgb(136, 136, 245), rgb(47, 47, 248), violet);\r\n  color: #fff;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: background 0.3s ease, transform 0.2s ease;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.submit:hover {\r\n  background: linear-gradient(45deg, violet, rgb(47, 47, 248), rgb(133, 133, 252));\r\n  transform: translateY(-2px);\r\n}\r\n\r\n/* Liên kết đăng ký */\r\n.signin_form p {\r\n  font-size: 14px;\r\n  color: #555;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.signin_form p a {\r\n  color: #007bff;\r\n  text-decoration: none;\r\n  font-weight: 500;\r\n}\r\n\r\n.signin_form a {\r\n  color: #007bff;\r\n  text-decoration: none;\r\n  font-weight: 500;\r\n}\r\n\r\n.signin_form p a:hover {\r\n  text-decoration: underline;\r\n}\r\n/* Nút đăng nhập khác (Google, Facebook) */\r\n.login_other {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n}\r\n\r\n.login_other button {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: none;\r\n  border-radius: 8px;\r\n  color: #fff;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: background 0.3s ease, transform 0.2s ease;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.login_gg {\r\n  background: #db4437;\r\n}\r\n\r\n.login_fb {\r\n  background: #4267B2;\r\n}\r\n\r\n.login_other button:hover {\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.login_other i {\r\n  margin-left: 5px;\r\n}\r\n\r\n.error-msg {\r\n  color: red !important;\r\n  font-size: 14px;\r\n  margin-top: 10px;\r\n}\r\n\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n/* Modal container */\r\n.modal {\r\n  background: #fff;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  width: 300px;\r\n  position: relative;\r\n  text-align: center;\r\n}\r\n\r\n/* Nút đóng modal */\r\n.close {\r\n  position: absolute;\r\n  top: 10px;\r\n  right: 10px;\r\n  background: transparent;\r\n  border: none;\r\n  font-size: 20px;\r\n  cursor: pointer;\r\n}\r\n\r\n.modal input {\r\n  width: 100%;\r\n  padding: 8px;\r\n  margin: 10px 0;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.modal button {\r\n  padding: 8px 12px;\r\n  margin-top: 10px;\r\n  cursor: pointer;\r\n}\r\n\r\n.success-msg {\r\n  color: green;\r\n  font-size: 14px;\r\n}\r\n\r\n/* Responsive */\r\n@media screen and (max-width: 768px) {\r\n  .signin_form {\r\n    width: 90%;\r\n    margin: 0 auto;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./signin.vue?vue&type=template&id=34a71454&scoped=true\"\nimport script from \"./signin.vue?vue&type=script&lang=js\"\nexport * from \"./signin.vue?vue&type=script&lang=js\"\n\nimport \"./signin.vue?vue&type=style&index=0&id=34a71454&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-34a71454\"]])\n\nexport default __exports__","<template>\r\n    <div class=\"login\">\r\n        <div class=\"signin_form\">\r\n            <img src=\"../assets/img/TMIND.png\" alt=\"Logo\" class=\"logo\"><br>\r\n            <input type=\"text\" name=\"name\" id=\"name\" v-model=\"form.name\" placeholder=\"Nhập họ và tên\">\r\n            <input type=\"tel\" name=\"phone\" id=\"phone\" v-model=\"form.phone\" placeholder=\"Nhập số điện thoại\">\r\n            <input type=\"email\" name=\"email\" id=\"email\" v-model=\"form.email\" placeholder=\"Nhập email của bạn\"><br>\r\n            <input type=\"password\" name=\"pass\" id=\"pass\" v-model=\"form.pass\" placeholder=\"Nhập mật khẩu của bạn\"><br>\r\n            <input type=\"password\" name=\"confirmPass\" id=\"confirmPass\" v-model=\"form.confirmPass\" placeholder=\"Nhập lại mật khẩu\"><br>\r\n            <button type=\"button\" class=\"submit\" @click.prevent=\"signup\">Đăng Ký</button>\r\n            <p v-if=\"errorMessage\" class=\"error-msg\">{{ errorMessage }}</p>\r\n            <p>Đã có tài khoản? <a href=\"/signin\">Đăng nhập ngay</a></p>\r\n            <div class=\"login_other\">\r\n                <button class=\"login_gg\" @click=\"loginWithGoogle\">\r\n                    Google\r\n                    <i class=\"fa-brands fa-google\"></i>\r\n                </button>\r\n                <button class=\"login_fb\" @click=\"loginWithFacebook\">Facebook <i class=\"fa-brands fa-facebook\"></i></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { authState } from '../authState'; // Đảm bảo alias @ trỏ đến src\r\nimport { auth, googleProvider, facebookProvider, signInWithPopup } from '../firebase';\r\nexport default{\r\n    name:\"SignUp\",\r\n    data() {\r\n    return {\r\n      form: {\r\n        name: '',\r\n        phone: '',\r\n        email: '',\r\n        pass: '',\r\n        confirmPass: ''\r\n      },\r\n      errorMessage: ''\r\n    }\r\n  },\r\n  methods: {\r\n    async signup() {\r\n      try {\r\n        const response = await fetch('/api/auth/signup', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            name: this.form.name,\r\n            phone: this.form.phone,\r\n            email: this.form.email,\r\n            pass: this.form.pass,\r\n            confirmPass: this.form.confirmPass\r\n          })\r\n        });\r\n        const data = await response.json();\r\n        if(response.ok){\r\n          alert(data.message);\r\n          // Chuyển hướng nếu cần, ví dụ:\r\n          this.$router.push('/signin');\r\n        } else {\r\n          if (response.ok) {\r\n              this.errorMessage = ''; // xóa lỗi nếu đăng ký thành công\r\n              this.$router.push('/signin');\r\n          } else {\r\n              this.errorMessage = data.message; // hiển thị lỗi\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n        alert('Đã xảy ra lỗi!');\r\n      }\r\n    },\r\n    async loginWithGoogle() {\r\n      try {\r\n        const result = await signInWithPopup(auth, googleProvider);\r\n        const user = result.user;\r\n        const idToken = await user.getIdToken();\r\n\r\n        // Lưu vào localStorage\r\n        localStorage.setItem('token', idToken);\r\n        localStorage.setItem('provider', 'google');\r\n        localStorage.setItem('userName', user.displayName);\r\n        localStorage.setItem('userEmail', user.email);\r\n        localStorage.setItem('userIcon', user.photoURL);\r\n        const res = await fetch('/saveUser', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            uid: user.uid,\r\n            name: user.displayName,\r\n            email: user.email,\r\n            photoURL: user.photoURL,\r\n            provider: 'google'\r\n          })\r\n        });\r\n        console.log(res)\r\n        // Update reactive authState\r\n        authState.token = localStorage.getItem('token');\r\n        authState.userName = localStorage.getItem('userName');\r\n        authState.userIcon = localStorage.getItem('userIcon');\r\n        this.$router.push('/');\r\n      } catch (error) {\r\n        if (error.code === 'auth/cancelled-popup-request') {\r\n          this.errorMessage = 'Đăng nhập với Google bị hủy. Vui lòng thử lại.';\r\n        } else if (error.code === 'auth/popup-closed-by-user') {\r\n          this.errorMessage = 'Bạn đã đóng cửa sổ đăng nhập. Vui lòng thử lại sau.';\r\n        } else {\r\n          this.errorMessage = error.message;\r\n        }\r\n      }\r\n    },\r\n    async loginWithFacebook() {\r\n      try {\r\n        const result = await signInWithPopup(auth, facebookProvider);\r\n        localStorage.setItem('provider', 'facebook');\r\n        const user = result.user;\r\n        const idToken = await user.getIdToken();\r\n\r\n        localStorage.setItem('token', idToken);\r\n        localStorage.setItem('provider', 'facebook');\r\n        localStorage.setItem('userName', user.displayName);\r\n        localStorage.setItem('userIcon', user.photoURL);\r\n        localStorage.setItem('userEmail', user.email);\r\n        await fetch('/api/auth/saveUser', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            uid: user.uid,\r\n            name: user.displayName,\r\n            email: user.email,\r\n            photoURL: user.photoURL,\r\n            provider: 'facebook'\r\n          })\r\n        });\r\n        // Update reactive authState\r\n        authState.token = localStorage.getItem('token');\r\n        authState.userName = localStorage.getItem('userName');\r\n        authState.userIcon = localStorage.getItem('userIcon');\r\n        this.$router.push('/');\r\n      } catch (error) {\r\n        if (error.code === 'auth/cancelled-popup-request') {\r\n          this.errorMessage = 'Đăng nhập với Facebook bị hủy. Vui lòng thử lại.';\r\n        } else if (error.code === 'auth/popup-closed-by-user') {\r\n          this.errorMessage = 'Bạn đã đóng cửa sổ đăng nhập. Vui lòng thử lại sau.';\r\n        } else {\r\n          this.errorMessage = error.message;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n/* Container chính */\r\n.login {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  min-height: 100vh;\r\n  background: #eef2f5;\r\n  padding: 20px;\r\n}\r\n\r\n/* Form đăng nhập */\r\n.signin_form {\r\n  width: 35%;\r\n  max-width: 400px;\r\n  background: #fff;\r\n  padding: 30px;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n  text-align: center;\r\n}\r\n\r\n.signin_form .logo {\r\n  width: 200px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n/* Input styling */\r\n.signin_form input {\r\n  width: 90%;\r\n  font-size: 16px;\r\n  margin-bottom: 15px;\r\n  padding: 12px 15px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 8px;\r\n  transition: border 0.3s ease, box-shadow 0.3s ease;\r\n}\r\n\r\n.signin_form input:focus {\r\n  outline: none;\r\n  border-color: #007bff;\r\n  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);\r\n}\r\n\r\n/* Nút đăng nhập */\r\n.submit {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border: none;\r\n  border-radius: 25px;\r\n  background: linear-gradient(45deg, rgb(136, 136, 245), rgb(47, 47, 248), violet);\r\n  color: #fff;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: background 0.3s ease, transform 0.2s ease;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.submit:hover {\r\n  background: linear-gradient(45deg, violet, rgb(47, 47, 248), rgb(133, 133, 252));\r\n  transform: translateY(-2px);\r\n}\r\n\r\n/* Liên kết đăng ký */\r\n.signin_form p {\r\n  font-size: 14px;\r\n  color: #555;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.signin_form p a {\r\n  color: #007bff;\r\n  text-decoration: none;\r\n  font-weight: 500;\r\n}\r\n\r\n.signin_form p a:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n/* Nút đăng nhập khác (Google, Facebook) */\r\n.login_other {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n}\r\n\r\n.login_other button {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: none;\r\n  border-radius: 8px;\r\n  color: #fff;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: background 0.3s ease, transform 0.2s ease;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.login_gg {\r\n  background: #db4437;\r\n}\r\n\r\n.login_fb {\r\n  background: #4267B2;\r\n}\r\n\r\n.login_other button:hover {\r\n  transform: translateY(-2px);\r\n}\r\n.login_other i{\r\n    margin-left: 5px;\r\n}\r\n.error-msg {\r\n  color: red !important;\r\n  font-size: 14px;\r\n  margin-top: -10px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n/* Responsive */\r\n@media screen and (max-width: 768px) {\r\n  .signin_form {\r\n    width: 90%;\r\n    margin: 0 auto;\r\n  }\r\n}\r\n\r\n</style>","import { render } from \"./signup.vue?vue&type=template&id=3ffc7db1&scoped=true\"\nimport script from \"./signup.vue?vue&type=script&lang=js\"\nexport * from \"./signup.vue?vue&type=script&lang=js\"\n\nimport \"./signup.vue?vue&type=style&index=0&id=3ffc7db1&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3ffc7db1\"]])\n\nexport default __exports__","import { createRouter, createWebHistory } from 'vue-router';\r\nimport Home from './src/views/Home.vue'\r\nimport listmm from './src/views/listmm.vue';\r\nimport createmm from './src/views/createmm.vue';\r\nimport createmmAI from './src/views/createmmAI.vue';\r\nimport signin from './src/views/signin.vue';\r\nimport signup from './src/views/signup.vue';\r\n\r\nconst routes = [\r\n    { path: '/', component: Home },\r\n    { path: '/listmm', component: listmm },\r\n    { path: '/createmm', component: createmm },\r\n    { path: '/createmm/edit/:id', component: createmm, props: true },\r\n    { path: '/createmmAI', component: createmmAI },\r\n    { path: '/signin', component: signin },\r\n    { path: '/signup', component: signup }\r\n];\r\n\r\nconst router = createRouter({\r\n    history: createWebHistory(),\r\n    routes,\r\n});\r\nrouter.beforeEach((to, from, next) => {\r\n    const publicPages = ['/', '/createMM', '/signin', '/signup'];\r\n    const authRequired = !publicPages.includes(to.path);\r\n    const token = localStorage.getItem('token');\r\n    if (authRequired && !token) {\r\n        return next('/signin');\r\n    }\r\n    next();\r\n})\r\nexport default router;","import { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport { createPinia } from 'pinia'\r\nimport router from '../router.js'\r\n\r\nconst pinia = createPinia()\r\ncreateApp(App).use(router).mount('#app')\r\ncreateApp(App).use(pinia)\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunktmindmap\"] = self[\"webpackChunktmindmap\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(8245); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["id","_createElementBlock","_hoisted_1","_createVNode","_component_AppHeader","_createElementVNode","_component_router_view","_component_AppFooter","class","key","style","_Fragment","_hoisted_2","_component_router_link","to","default","_withCtx","_cache","src","_imports_0","alt","_","_hoisted_3","_hoisted_4","href","onClick","_withModifiers","args","$options","goToListMindMap","_hoisted_5","_createTextVNode","_hoisted_6","openModal","isLoggedIn","_createCommentVNode","_hoisted_7","_hoisted_8","toggleUserMenu","userIcon","_hoisted_9","_hoisted_10","_toDisplayString","userName","$data","showUserMenu","_hoisted_11","openAccountModal","logout","openMenu","closeMenu","_hoisted_12","_hoisted_13","_hoisted_14","closeModal","_hoisted_15","onSubmit","Feedback","_hoisted_16","for","$event","feedbackDescription","name","placeholder","_hoisted_17","type","includeAiSession","checked","sendFeedback","isAccountModalOpen","_hoisted_18","_hoisted_19","_hoisted_20","closeAccountModal","_hoisted_21","saveAccountInfo","_hoisted_22","account","_hoisted_23","email","disabled","_hoisted_24","phone","authState","reactive","token","localStorage","getItem","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","initializeApp","auth","getAuth","googleProvider","GoogleAuthProvider","facebookProvider","FacebookAuthProvider","computed","require","data","methods","this","$router","push","document","getElementById","display","console","log","Error","res","fetch","method","headers","status","ok","json","user","err","error","body","JSON","stringify","message","alert","signOut","removeItem","window","innerWidth","querySelector","payload","content","then","successMessage","setTimeout","catch","errorMessage","mounted","addEventListener","navList","__exports__","components","AppHeader","AppFooter","render","_createStaticVNode","_imports_1","startWordAnimation","isFirst","setInterval","word1","word2","classList","remove","offsetWidth","add","searchTerm","onInput","filterList","loading","_renderList","filteredList","item","_id","imageUrl","title","formatDate","createdAt","deleteItem","length","list","fetchList","provider","currentUser","getIdToken","text","e","term","trim","toLowerCase","filter","includes","confirm","Authorization","i","iso","d","Date","toLocaleDateString","toLocaleTimeString","ref","xmlns","zoomIn","zoomOut","undo","redo","removeNode","uploadImage","exportImage","exportPPT","isEditing","showModal","form","mapTitle","_postSaveManual","accept","onChange","handleFileSelect","draggable","onDragstart","dragStart","_normalizeClass","active","selectedNode","isBold","selectedLink","toggleBold","isItalic","toggleItalic","align","setAlign","selectedColor","applyTextColor","selectedFontSize","applyFontSize","min","max","number","selectedFont","applyFontFamily","value","nodeBorderColor","updateNode","nodeBackgroundColor","nodeBorderThickness","nodeBorderStyle","linkColor","updateLink","linkThickness","linkDash","step","linkCurvature","linkMarker","clearSelection","onDragover","onDrop","drop","onWheel","_normalizeStyle","scale","tabindex","onKeydown","_withKeys","copyNode","pasteNode","markerUnits","markerWidth","markerHeight","refX","refY","orient","fill","links","link","handleLinkClick","marker","selectLink","computeTaperedBranch","color","computeRadialLinkPath","path","stroke","thickness","getLinkPath","from","toPos","curvature","dashArray","dash","_hoisted_25","cx","x","cy","y","r","onMousedown","startDragEnd","_hoisted_26","_hoisted_28","x1","getNodeCenter","y1","x2","y2","_hoisted_27","midPoint","startAdjustCurvature","_hoisted_29","onDblclick","startEditing","startOffset","textColor","fontFamily","fontSize","_hoisted_31","_hoisted_30","editingIndex","inputX","inputY","width","height","tempText","finishEditing","onBlur","ref_for","_hoisted_33","_hoisted_32","linking","fromNode","tempPos","_hoisted_34","nodes","node","linkMode","top","left","rotation","startDragNode","handleNodeClick","startRotate","_hoisted_36","beginLink","_hoisted_37","shapeInnerStyle","contenteditable","updateNodeText","image","_hoisted_39","innerHTML","_hoisted_40","_hoisted_38","startResize","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_35","idCounter","props","String","minScale","maxScale","scaleStep","translate","history","rawData","historyIndex","currentDrag","draggingNode","offsetX","offsetY","resizingNode","resizeDir","startX","startY","startW","startH","startL","startT","customColor","customColor1","selectedAlign","defaultNodeBorderColor","defaultNodeBackgroundColor","defaultNodeBorderThickness","defaultNodeBorderStyle","dragStartSave","defaultLinkColor","defaultLinkThickness","defaultLinkDash","defaultLinkCurvature","defaultLinkMarker","draggingLinkEnd","mindmapData","selectedTemplate","selectedMapType","mindmapObject","rotatingNode","rotateStartAngle","rotateCenter","svg","d3","$refs","canvas","$route","params","resp","result","mapType","manualData","parse","map","n","forEach","replace","$nextTick","drawMindMap","initSelection","get","borderColor","set","val","backgroundColor","borderThickness","borderStyle","straightLinks","l","undefined","curvedLinks","posLinks","canSave","selectedImageUrl","clipboardNode","newNode","now","pathEl","warn","totalLen","getTotalLength","midPt","getPointAtLength","allInputs","editableInput","target","Array","isArray","focus","len","setSelectionRange","event","wrapper","currentTarget","parentNode","rect","getBoundingClientRect","mx","clientX","my","clientY","startAngle","Math","atan2","PI","nodeRotation","onRotate","stopRotate","angle","rawAngle","removeEventListener","pptx","PptxGenJS","el","txt","innerText","children","parentId","childId","attachedTo","allChild","Set","root","Object","values","find","has","flat","dfs","slide","addSlide","addText","bold","y0","c","bullet","margin","slides","writeFile","fileName","_exportSvgMarkup","svgEl","canva","clone","cloneNode","setAttribute","clientWidth","clientHeight","bg","createElementNS","insertBefore","firstChild","XMLSerializer","serializeToString","_generateImageFromSvg","maxWidth","inlineAllStyles","origWidth","origHeight","ratio","round","dataUrl","htmlToImage","quality","isUpdate","Boolean","url","svgMarkup","manualNodes","borderWidth","manualLinks","custom","computeLinkPath","selectAll","drawFreeMap","fn","bubble","drawBubbleMap","tree","drawTreeMap","flow","drawFlowMap","multiFlow","drawMultiFlowMap","brace","drawBraceMap","call","findNode","treeData","hierarchicalData","branches","br","subBranches","sb","w","h","radius","padH","size","extraLength","descendants","sort","a","b","depth","yOffset","parentOffset","parent","baseOffset","textWidth","newNodes","d3node","words","split","lines","slice","join","maxW","rMin","rDyn","theta","xCenter","cos","yCenter","sin","bc","bw","bs","tc","ff","ib","ii","iu","isNaN","linkGen","newLinks","d3link","idx","basePath","absolutePath","__","xi","parseFloat","yi","isLevel1","source","thicknessValue","wrapText","textSel","lineHeight","each","line","attr","dy","tspan","append","getComputedTextLength","pop","chunkText","wordsPerLine","vm","rootObj","linkLen1","linkLen2Base","extraLeaf","layout","baseAngle","font","strokeWidth","kids","Nroot","radSector","kid","θ","startAng","d3n","count","Number","fromId","toId","nodesById","fromEntries","s","t","dx","cpx","cpy","_findNode","buildHierarchy","raw","ctx","createElement","getContext","measureText","svgNode","nodeSize","separation","rootX","rootY","_canvasCtx","isRoot","wText","widthNode","heightNode","rawX","rawY","W","H","oX","oY","_txtCtx","baseSize","w0","r0","midIdx","ceil","leftKids","rightKids","makeSub","arr","leftRoot","rightRoot","Ys","R","midY","lMid","rMid","collect","subRoot","mid","flip","sx","sy","tx","ty","vy","hx","fs","hw","hh","svgSel","cy0","Y1","Y2","gapX1","gapX2","p","leaf","pad","strokeW","selectTemplate","tpl","templates","pushHistory","deltaY","splice","snapshot","restore","addNode","trackDragEnd","stopDragEnd","evt","getLinkEnd","endNode","start","end","hypot","ux","uy","offset","N","leftPts","rightPts","nx","ny","unshift","fromCenter","toCenter","rectSVG","dx1","dy1","angle1","r1","dx2","dy2","angle2","r2","midR","xi1","yi1","xi2","yi2","adjustingLink","adjustCurvature","endAdjustCurvature","mid0","vx","selectNode","updateNodeStyle","selectionLink","preventDefault","family","italic","nodeToRemove","toDelete","changed","click","file","files","reader","FileReader","onload","readAsDataURL","execCommand","updateText","dir","linkDir","$el","fontWeight","fontStyle","textAlign","sel","select","empty","doDragNode","stopDragNode","moved","doResize","stopResize","newW","newH","newL","newT","nodeOrId","border","padding","alignItems","justifyContent","cursor","userSelect","overflow","whiteSpace","wordWrap","borderRadius","trackLink","endLink","elementFromPoint","nodeEl","closest","dataset","center","isPos","recurse","cs","getComputedStyle","prop","setProperty","getPropertyValue","pixelRatio","download","appendChild","removeChild","toggleSuggestions","saveTemplate","hidden","showSuggestion","suggestions","full","$props","showSuggestions","creatingTopic","topic","onKeypress","generateMindMap","selectOption","onFileChange","showSaveModal","confirmSave","fileContent","leafImages","watch","newVal","fetchSuggestions","statusText","label","FormData","mindmap","mindmapSvg","ns","xml","svg64","btoa","unescape","encodeURIComponent","Promise","resolve","reject","img","Image","drawImage","toDataURL","onerror","_postSave","cleanTree","toRaw","saveSvgAsPng","branch","contentStartY","addImage","linkDur","zoomMin","zoomMax","g","scaleExtent","on","transform","wTxt","enter","base","ext","x3","y3","L","transition","duration","ease","rootG","font0","font1","drawNode","defaultR","circ","ln","delay","countSub","defs","grad","treeLayout","wrap4","extraX","els","nd","textEl","padV","wRect","hRect","includeImage","xOff","treeObj","allKids","half","vert","hor","leftYs","rightYs","leftMid","rightMid","rootLines","maxRW","rootShiftX","markerAdjust","marginLeft","marginRight","computeShift","rectW","doLinks","vSrc","vTgt","hSrc","hTgt","shift","rt","doNodes","v","textFont","level1Count","k","leafYSpacing","leafXSpacing","level1MarginX","leaves","total","wrapLines","bbox","getBBox","insert","obj","pass","signin","isModalOpen","identifier","sendVerificationCode","code","verifyCode","newPassword","confirmPassword","resetPassword","loginWithGoogle","loginWithFacebook","userId","response","setItem","photoURL","signInWithPopup","idToken","displayName","uid","confirmPass","signup","routes","component","Home","listmm","createmm","createmmAI","router","createRouter","createWebHistory","beforeEach","next","publicPages","authRequired","pinia","createPinia","createApp","App","use","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","deferred","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","j","keys","every","getter","__esModule","definition","o","defineProperty","enumerable","globalThis","Function","prototype","hasOwnProperty","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}